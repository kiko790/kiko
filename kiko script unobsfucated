if not game:IsLoaded() then game.Loaded:Wait() end

local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local HttpService = game:GetService("HttpService")

-- Exploit compatibility
local guiParent = game:GetService("CoreGui")
pcall(function()
    if gethui then
        guiParent = gethui()
    end
end)

local localPlayer = Players.LocalPlayer

-- ============================================
-- ANIMATION HELPERS
-- ============================================

local function tween(obj, ti, props)
    if not obj then return end
    local t = TweenService:Create(obj, ti, props)
    t:Play()
    return t
end

local function hoverTween(button, onProps, offProps)
    local hovering = false

    local function apply(props)
        if not button then return end
        tween(button, TweenInfo.new(0.18, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), props)
    end

    button.MouseEnter:Connect(function()
        hovering = true
        apply(onProps)
    end)

    button.MouseLeave:Connect(function()
        hovering = false
        apply(offProps)
    end)
end

local function hoverTweenInput(inputObject, onEnter, onLeave)
    inputObject.MouseEnter:Connect(onEnter)
    inputObject.MouseLeave:Connect(onLeave)
end

-- ============================================
-- ADVANCED FLY SYSTEM
-- ============================================

local Fly = {
    Enabled = false,
    Speed = 50,
    Connections = {},
    Gyro = nil,
    Velocity = nil,
    CurrentAnim = nil,
    MoveState = {forward=0, backward=0, left=0, right=0},
    CurrentCF = nil,
    CurrentVelocity = Vector3.new(0,0,0),
    BobbingFreq = 1,
    BobbingAmp = 0.5
}

local originalGravity = Workspace.Gravity

local function disableDefaultAnimate(char)
    local animate = char:FindFirstChild("Animate")
    if animate then animate.Disabled = true end
end

local function enableDefaultAnimate(char)
    local animate = char:FindFirstChild("Animate")
    if animate then animate.Disabled = false end
end

local function playFlyAnim(humanoid, animId, startTime, speed)
    if not humanoid then return end
    for _, track in ipairs(humanoid:GetPlayingAnimationTracks()) do
        track:Stop()
    end
    disableDefaultAnimate(humanoid.Parent)

    local anim = Instance.new("Animation")
    anim.AnimationId = "rbxassetid://" .. animId
    local track = humanoid:LoadAnimation(anim)
    track:Play()
    track.TimePosition = startTime
    track:AdjustSpeed(speed)
    Fly.CurrentAnim = track
end

local function stopFlyAnim(humanoid)
    if Fly.CurrentAnim then
        Fly.CurrentAnim:Stop(0.1)
        Fly.CurrentAnim = nil
    end
    enableDefaultAnimate(humanoid.Parent)
end

function Fly:Start()
    local char = localPlayer.Character
    if not char then return end
    local humanoid = char:WaitForChild("Humanoid")
    local hrp = char:WaitForChild("HumanoidRootPart")

    Workspace.Gravity = 0
    humanoid.PlatformStand = true
    playFlyAnim(humanoid, 10714347256, 4, 0)

    self.Gyro = Instance.new("BodyGyro")
    self.Gyro.Name = "FlyGyro"
    self.Gyro.Parent = hrp
    self.Gyro.P = 90000
    self.Gyro.MaxTorque = Vector3.new(9e9, 9e9, 9e9)
    self.Gyro.CFrame = hrp.CFrame

    self.Velocity = Instance.new("BodyVelocity")
    self.Velocity.Name = "FlyVelocity"
    self.Velocity.Parent = hrp
    self.Velocity.MaxForce = Vector3.new(9e9, 9e9, 9e9)
    self.Velocity.Velocity = Vector3.new(0, 0.1, 0)

    self.CurrentVelocity = Vector3.new(0,0,0)

    local updateConn = RunService.RenderStepped:Connect(function()
        local cam = Workspace.CurrentCamera
        local fwd = self.MoveState.forward - self.MoveState.backward
        local side = self.MoveState.right - self.MoveState.left

        local inputVec = (cam.CFrame.LookVector * fwd) + (cam.CFrame.RightVector * side)
        if fwd ~= 0 then inputVec = inputVec + Vector3.new(0, 0.2 * fwd, 0) end

        local bobbing = math.sin(tick() * self.BobbingFreq) * self.BobbingAmp
        local desiredVel = inputVec.Magnitude > 0 and inputVec.Unit * self.Speed or Vector3.new(0, bobbing, 0)
        self.CurrentVelocity = self.CurrentVelocity:Lerp(desiredVel, 0.1)
        self.Velocity.Velocity = self.CurrentVelocity

        local desiredCF = fwd > 0 and (cam.CFrame * CFrame.Angles(math.rad(-90), 0, 0)) or 
                         (cam.CFrame * CFrame.Angles(math.rad(-45 * fwd), 0, 0))
        if self.CurrentCF then
            self.CurrentCF = self.CurrentCF:Lerp(desiredCF, 0.1)
        else
            self.CurrentCF = desiredCF
        end
        self.Gyro.CFrame = self.CurrentCF
    end)
    table.insert(self.Connections, updateConn)
end

function Fly:Stop()
    local char = localPlayer.Character
    if char then
        local humanoid = char:FindFirstChild("Humanoid")
        if humanoid then
            Workspace.Gravity = originalGravity
            humanoid.PlatformStand = false
            stopFlyAnim(humanoid)
        end
    end

    if self.Gyro then self.Gyro:Destroy(); self.Gyro = nil end
    if self.Velocity then self.Velocity:Destroy(); self.Velocity = nil end

    for _, conn in ipairs(self.Connections) do
        if conn.Connected then conn:Disconnect() end
    end
    self.Connections = {}
    self.MoveState = {forward=0, backward=0, left=0, right=0}
    self.CurrentVelocity = Vector3.new(0,0,0)
end

function Fly:Toggle()
    self.Enabled = not self.Enabled
    if self.Enabled then
        self:Start()
    else
        self:Stop()
    end
end

-- ============================================
-- MENU SYSTEM
-- ============================================

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "ArrowToggleMenuBar"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.IgnoreGuiInset = true
ScreenGui.Parent = guiParent

local isOpen = false
local activePanels = {}

local player = Players.LocalPlayer
local defaultSpeed = 16
local defaultJump = 50
local currentSpeed = defaultSpeed
local currentJump = defaultJump
local currentFlySpeed = 50
local currentFOV = 70
local spectating = false
local spectateTarget = nil

local flyKeybind = Enum.KeyCode.X
local menuKeybind = Enum.KeyCode.Q
local isSettingKeybind = false
local keybindType = ""

-- Theme system
local currentTheme = "Dark"

-- 100 themes: Dark/Galaxy/Ocean plus 97 variants
local themes = {
    Dark = {
        MenuBar = Color3.fromRGB(24, 24, 28),
        Button = Color3.fromRGB(40, 40, 45),
        Panel = Color3.fromRGB(28, 28, 30),
        Accent = Color3.fromRGB(60, 120, 200),
        Text = Color3.fromRGB(255, 255, 255),
        SubText = Color3.fromRGB(120, 120, 120),
    },
    Galaxy = {
        MenuBar = Color3.fromRGB(25, 15, 45),
        Button = Color3.fromRGB(45, 25, 70),
        Panel = Color3.fromRGB(30, 20, 50),
        Accent = Color3.fromRGB(150, 80, 255),
        Text = Color3.fromRGB(255, 240, 255),
        SubText = Color3.fromRGB(180, 150, 220),
    },
    Ocean = {
        MenuBar = Color3.fromRGB(15, 35, 55),
        Button = Color3.fromRGB(25, 55, 85),
        Panel = Color3.fromRGB(20, 40, 60),
        Accent = Color3.fromRGB(60, 180, 240),
        Text = Color3.fromRGB(240, 250, 255),
        SubText = Color3.fromRGB(140, 190, 220),
    },

    -- Neon / Vaporwave
    NeonPink = {
        MenuBar = Color3.fromRGB(35, 10, 40),
        Button = Color3.fromRGB(60, 20, 80),
        Panel = Color3.fromRGB(45, 15, 60),
        Accent = Color3.fromRGB(255, 70, 200),
        Text = Color3.fromRGB(255, 230, 250),
        SubText = Color3.fromRGB(200, 150, 210),
    },
    NeonBlue = {
        MenuBar = Color3.fromRGB(10, 20, 45),
        Button = Color3.fromRGB(15, 30, 70),
        Panel = Color3.fromRGB(12, 25, 60),
        Accent = Color3.fromRGB(80, 200, 255),
        Text = Color3.fromRGB(230, 245, 255),
        SubText = Color3.fromRGB(150, 190, 220),
    },
    NeonGreen = {
        MenuBar = Color3.fromRGB(5, 25, 5),
        Button = Color3.fromRGB(15, 45, 15),
        Panel = Color3.fromRGB(10, 35, 10),
        Accent = Color3.fromRGB(80, 255, 150),
        Text = Color3.fromRGB(220, 255, 230),
        SubText = Color3.fromRGB(150, 210, 170),
    },
    NeonPurple = {
        MenuBar = Color3.fromRGB(25, 0, 40),
        Button = Color3.fromRGB(45, 0, 80),
        Panel = Color3.fromRGB(35, 0, 60),
        Accent = Color3.fromRGB(200, 110, 255),
        Text = Color3.fromRGB(245, 230, 255),
        SubText = Color3.fromRGB(190, 150, 220),
    },
    Vaporwave = {
        MenuBar = Color3.fromRGB(35, 15, 60),
        Button = Color3.fromRGB(55, 25, 90),
        Panel = Color3.fromRGB(45, 20, 80),
        Accent = Color3.fromRGB(255, 120, 200),
        Text = Color3.fromRGB(255, 240, 255),
        SubText = Color3.fromRGB(210, 180, 230),
    },
    VaporwaveBlue = {
        MenuBar = Color3.fromRGB(10, 25, 55),
        Button = Color3.fromRGB(20, 40, 85),
        Panel = Color3.fromRGB(15, 35, 75),
        Accent = Color3.fromRGB(120, 200, 255),
        Text = Color3.fromRGB(235, 245, 255),
        SubText = Color3.fromRGB(180, 200, 230),
    },
    VaporwaveSunset = {
        MenuBar = Color3.fromRGB(45, 10, 25),
        Button = Color3.fromRGB(70, 20, 35),
        Panel = Color3.fromRGB(60, 15, 30),
        Accent = Color3.fromRGB(255, 140, 120),
        Text = Color3.fromRGB(255, 240, 230),
        SubText = Color3.fromRGB(220, 180, 170),
    },

    -- Pastel
    PastelPink = {
        MenuBar = Color3.fromRGB(255, 210, 230),
        Button = Color3.fromRGB(255, 235, 245),
        Panel = Color3.fromRGB(250, 220, 235),
        Accent = Color3.fromRGB(255, 140, 180),
        Text = Color3.fromRGB(80, 30, 50),
        SubText = Color3.fromRGB(140, 90, 120),
    },
    PastelBlue = {
        MenuBar = Color3.fromRGB(210, 230, 255),
        Button = Color3.fromRGB(235, 245, 255),
        Panel = Color3.fromRGB(220, 235, 255),
        Accent = Color3.fromRGB(120, 160, 255),
        Text = Color3.fromRGB(25, 40, 90),
        SubText = Color3.fromRGB(90, 120, 170),
    },
    PastelGreen = {
        MenuBar = Color3.fromRGB(215, 245, 220),
        Button = Color3.fromRGB(235, 255, 240),
        Panel = Color3.fromRGB(225, 250, 230),
        Accent = Color3.fromRGB(120, 210, 150),
        Text = Color3.fromRGB(30, 70, 40),
        SubText = Color3.fromRGB(90, 130, 105),
    },
    PastelPurple = {
        MenuBar = Color3.fromRGB(230, 220, 255),
        Button = Color3.fromRGB(245, 240, 255),
        Panel = Color3.fromRGB(235, 230, 255),
        Accent = Color3.fromRGB(170, 140, 255),
        Text = Color3.fromRGB(50, 40, 90),
        SubText = Color3.fromRGB(110, 100, 160),
    },
    PastelYellow = {
        MenuBar = Color3.fromRGB(255, 245, 210),
        Button = Color3.fromRGB(255, 250, 230),
        Panel = Color3.fromRGB(255, 245, 220),
        Accent = Color3.fromRGB(250, 200, 120),
        Text = Color3.fromRGB(90, 70, 20),
        SubText = Color3.fromRGB(140, 120, 80),
    },

    -- Monochrome
    MonoLight = {
        MenuBar = Color3.fromRGB(235, 235, 240),
        Button = Color3.fromRGB(245, 245, 250),
        Panel = Color3.fromRGB(240, 240, 245),
        Accent = Color3.fromRGB(90, 130, 210),
        Text = Color3.fromRGB(20, 20, 25),
        SubText = Color3.fromRGB(120, 120, 130),
    },
    MonoDark = {
        MenuBar = Color3.fromRGB(18, 18, 20),
        Button = Color3.fromRGB(28, 28, 32),
        Panel = Color3.fromRGB(22, 22, 26),
        Accent = Color3.fromRGB(90, 140, 230),
        Text = Color3.fromRGB(240, 240, 245),
        SubText = Color3.fromRGB(130, 130, 140),
    },
    MonoWarm = {
        MenuBar = Color3.fromRGB(30, 25, 20),
        Button = Color3.fromRGB(40, 35, 30),
        Panel = Color3.fromRGB(35, 30, 25),
        Accent = Color3.fromRGB(200, 150, 100),
        Text = Color3.fromRGB(245, 235, 220),
        SubText = Color3.fromRGB(170, 150, 130),
    },
    MonoCool = {
        MenuBar = Color3.fromRGB(18, 22, 30),
        Button = Color3.fromRGB(26, 32, 42),
        Panel = Color3.fromRGB(22, 28, 36),
        Accent = Color3.fromRGB(110, 160, 230),
        Text = Color3.fromRGB(230, 240, 255),
        SubText = Color3.fromRGB(140, 160, 190),
    },

    -- Earthy / Forest
    Forest = {
        MenuBar = Color3.fromRGB(12, 30, 18),
        Button = Color3.fromRGB(20, 45, 25),
        Panel = Color3.fromRGB(16, 38, 22),
        Accent = Color3.fromRGB(80, 180, 110),
        Text = Color3.fromRGB(220, 245, 225),
        SubText = Color3.fromRGB(140, 180, 150),
    },
    ForestNight = {
        MenuBar = Color3.fromRGB(5, 15, 10),
        Button = Color3.fromRGB(15, 30, 20),
        Panel = Color3.fromRGB(10, 22, 16),
        Accent = Color3.fromRGB(90, 200, 140),
        Text = Color3.fromRGB(215, 245, 225),
        SubText = Color3.fromRGB(140, 190, 160),
    },
    Desert = {
        MenuBar = Color3.fromRGB(90, 70, 40),
        Button = Color3.fromRGB(110, 85, 50),
        Panel = Color3.fromRGB(100, 78, 45),
        Accent = Color3.fromRGB(220, 180, 110),
        Text = Color3.fromRGB(255, 240, 210),
        SubText = Color3.fromRGB(200, 170, 140),
    },
    Autumn = {
        MenuBar = Color3.fromRGB(60, 25, 15),
        Button = Color3.fromRGB(85, 40, 25),
        Panel = Color3.fromRGB(75, 35, 20),
        Accent = Color3.fromRGB(220, 130, 70),
        Text = Color3.fromRGB(255, 230, 215),
        SubText = Color3.fromRGB(200, 160, 140),
    },
    Mountain = {
        MenuBar = Color3.fromRGB(30, 35, 45),
        Button = Color3.fromRGB(45, 50, 60),
        Panel = Color3.fromRGB(38, 42, 52),
        Accent = Color3.fromRGB(140, 190, 230),
        Text = Color3.fromRGB(235, 240, 250),
        SubText = Color3.fromRGB(170, 180, 200),
    },

    -- Space / Sci-Fi
    SpaceDark = {
        MenuBar = Color3.fromRGB(5, 5, 15),
        Button = Color3.fromRGB(18, 18, 40),
        Panel = Color3.fromRGB(12, 12, 30),
        Accent = Color3.fromRGB(110, 150, 255),
        Text = Color3.fromRGB(230, 235, 255),
        SubText = Color3.fromRGB(160, 170, 210),
    },
    SpaceBlue = {
        MenuBar = Color3.fromRGB(8, 16, 35),
        Button = Color3.fromRGB(20, 32, 60),
        Panel = Color3.fromRGB(15, 28, 50),
        Accent = Color3.fromRGB(90, 185, 255),
        Text = Color3.fromRGB(225, 240, 255),
        SubText = Color3.fromRGB(150, 180, 210),
    },
    SpacePurple = {
        MenuBar = Color3.fromRGB(18, 8, 30),
        Button = Color3.fromRGB(30, 15, 60),
        Panel = Color3.fromRGB(25, 10, 50),
        Accent = Color3.fromRGB(190, 120, 255),
        Text = Color3.fromRGB(245, 230, 255),
        SubText = Color3.fromRGB(190, 160, 220),
    },
    Hologram = {
        MenuBar = Color3.fromRGB(10, 20, 25),
        Button = Color3.fromRGB(20, 35, 40),
        Panel = Color3.fromRGB(15, 30, 35),
        Accent = Color3.fromRGB(120, 240, 255),
        Text = Color3.fromRGB(220, 245, 250),
        SubText = Color3.fromRGB(150, 200, 210),
    },
    Cyber = {
        MenuBar = Color3.fromRGB(5, 15, 20),
        Button = Color3.fromRGB(15, 30, 40),
        Panel = Color3.fromRGB(10, 22, 32),
        Accent = Color3.fromRGB(0, 210, 160),
        Text = Color3.fromRGB(220, 250, 240),
        SubText = Color3.fromRGB(120, 190, 170),
    },

    -- Warm / Cozy
    Coffee = {
        MenuBar = Color3.fromRGB(40, 25, 20),
        Button = Color3.fromRGB(55, 35, 28),
        Panel = Color3.fromRGB(48, 30, 24),
        Accent = Color3.fromRGB(180, 120, 80),
        Text = Color3.fromRGB(245, 230, 215),
        SubText = Color3.fromRGB(190, 160, 140),
    },
    Chocolate = {
        MenuBar = Color3.fromRGB(35, 18, 12),
        Button = Color3.fromRGB(55, 30, 22),
        Panel = Color3.fromRGB(45, 24, 18),
        Accent = Color3.fromRGB(195, 140, 90),
        Text = Color3.fromRGB(245, 230, 210),
        SubText = Color3.fromRGB(190, 165, 140),
    },
    Fireplace = {
        MenuBar = Color3.fromRGB(55, 20, 15),
        Button = Color3.fromRGB(70, 30, 20),
        Panel = Color3.fromRGB(60, 25, 18),
        Accent = Color3.fromRGB(220, 120, 70),
        Text = Color3.fromRGB(255, 235, 220),
        SubText = Color3.fromRGB(210, 170, 150),
    },
    Copper = {
        MenuBar = Color3.fromRGB(55, 30, 20),
        Button = Color3.fromRGB(70, 40, 25),
        Panel = Color3.fromRGB(62, 35, 23),
        Accent = Color3.fromRGB(210, 130, 80),
        Text = Color3.fromRGB(245, 230, 215),
        SubText = Color3.fromRGB(190, 160, 140),
    },
    Sunset = {
        MenuBar = Color3.fromRGB(60, 20, 35),
        Button = Color3.fromRGB(80, 30, 45),
        Panel = Color3.fromRGB(70, 25, 40),
        Accent = Color3.fromRGB(255, 130, 110),
        Text = Color3.fromRGB(255, 235, 230),
        SubText = Color3.fromRGB(215, 170, 165),
    },

    -- Ice / Winter
    Ice = {
        MenuBar = Color3.fromRGB(210, 235, 255),
        Button = Color3.fromRGB(235, 245, 255),
        Panel = Color3.fromRGB(220, 240, 255),
        Accent = Color3.fromRGB(140, 190, 255),
        Text = Color3.fromRGB(30, 60, 100),
        SubText = Color3.fromRGB(110, 140, 190),
    },
    Glacier = {
        MenuBar = Color3.fromRGB(180, 220, 245),
        Button = Color3.fromRGB(205, 235, 255),
        Panel = Color3.fromRGB(190, 225, 250),
        Accent = Color3.fromRGB(120, 190, 240),
        Text = Color3.fromRGB(25, 50, 90),
        SubText = Color3.fromRGB(90, 130, 170),
    },
    SnowNight = {
        MenuBar = Color3.fromRGB(15, 20, 35),
        Button = Color3.fromRGB(25, 30, 45),
        Panel = Color3.fromRGB(20, 25, 40),
        Accent = Color3.fromRGB(180, 220, 255),
        Text = Color3.fromRGB(230, 240, 255),
        SubText = Color3.fromRGB(150, 170, 210),
    },
    Frost = {
        MenuBar = Color3.fromRGB(200, 230, 245),
        Button = Color3.fromRGB(225, 245, 255),
        Panel = Color3.fromRGB(215, 240, 250),
        Accent = Color3.fromRGB(140, 210, 255),
        Text = Color3.fromRGB(40, 70, 110),
        SubText = Color3.fromRGB(110, 150, 190),
    },
    Polar = {
        MenuBar = Color3.fromRGB(230, 245, 255),
        Button = Color3.fromRGB(245, 250, 255),
        Panel = Color3.fromRGB(235, 245, 255),
        Accent = Color3.fromRGB(100, 180, 245),
        Text = Color3.fromRGB(30, 60, 100),
        SubText = Color3.fromRGB(120, 150, 190),
    },

    -- Bright / Candy
    Candy = {
        MenuBar = Color3.fromRGB(255, 210, 230),
        Button = Color3.fromRGB(255, 235, 245),
        Panel = Color3.fromRGB(250, 220, 235),
        Accent = Color3.fromRGB(255, 120, 160),
        Text = Color3.fromRGB(70, 25, 45),
        SubText = Color3.fromRGB(150, 90, 120),
    },
    Bubblegum = {
        MenuBar = Color3.fromRGB(250, 200, 230),
        Button = Color3.fromRGB(255, 225, 245),
        Panel = Color3.fromRGB(245, 210, 235),
        Accent = Color3.fromRGB(255, 130, 190),
        Text = Color3.fromRGB(80, 25, 60),
        SubText = Color3.fromRGB(150, 90, 130),
    },
    Lemon = {
        MenuBar = Color3.fromRGB(255, 245, 180),
        Button = Color3.fromRGB(255, 250, 210),
        Panel = Color3.fromRGB(255, 245, 195),
        Accent = Color3.fromRGB(255, 220, 120),
        Text = Color3.fromRGB(90, 70, 20),
        SubText = Color3.fromRGB(150, 120, 70),
    },
    Mint = {
        MenuBar = Color3.fromRGB(210, 245, 230),
        Button = Color3.fromRGB(230, 255, 245),
        Panel = Color3.fromRGB(220, 250, 235),
        Accent = Color3.fromRGB(120, 220, 170),
        Text = Color3.fromRGB(30, 80, 60),
        SubText = Color3.fromRGB(100, 150, 130),
    },
    SkyCandy = {
        MenuBar = Color3.fromRGB(210, 230, 255),
        Button = Color3.fromRGB(235, 245, 255),
        Panel = Color3.fromRGB(225, 240, 255),
        Accent = Color3.fromRGB(160, 200, 255),
        Text = Color3.fromRGB(40, 60, 110),
        SubText = Color3.fromRGB(120, 150, 190),
    },

    -- High contrast / UI-ish
    HighContrast = {
        MenuBar = Color3.fromRGB(0, 0, 0),
        Button = Color3.fromRGB(20, 20, 20),
        Panel = Color3.fromRGB(10, 10, 10),
        Accent = Color3.fromRGB(255, 255, 0),
        Text = Color3.fromRGB(255, 255, 255),
        SubText = Color3.fromRGB(170, 170, 170),
    },
    HighContrastBlue = {
        MenuBar = Color3.fromRGB(5, 10, 25),
        Button = Color3.fromRGB(10, 15, 35),
        Panel = Color3.fromRGB(8, 12, 30),
        Accent = Color3.fromRGB(0, 180, 255),
        Text = Color3.fromRGB(240, 245, 255),
        SubText = Color3.fromRGB(160, 180, 210),
    },
    HighContrastGreen = {
        MenuBar = Color3.fromRGB(5, 20, 5),
        Button = Color3.fromRGB(12, 30, 12),
        Panel = Color3.fromRGB(8, 26, 10),
        Accent = Color3.fromRGB(110, 255, 110),
        Text = Color3.fromRGB(235, 255, 235),
        SubText = Color3.fromRGB(160, 200, 160),
    },
    TerminalGreen = {
        MenuBar = Color3.fromRGB(0, 0, 0),
        Button = Color3.fromRGB(10, 10, 10),
        Panel = Color3.fromRGB(5, 5, 5),
        Accent = Color3.fromRGB(0, 255, 120),
        Text = Color3.fromRGB(200, 255, 220),
        SubText = Color3.fromRGB(120, 190, 150),
    },
    TerminalAmber = {
        MenuBar = Color3.fromRGB(0, 0, 0),
        Button = Color3.fromRGB(10, 10, 5),
        Panel = Color3.fromRGB(5, 5, 0),
        Accent = Color3.fromRGB(255, 180, 70),
        Text = Color3.fromRGB(255, 230, 190),
        SubText = Color3.fromRGB(190, 150, 110),
    },

    -- Soft dark variants
    SoftDark1 = {
        MenuBar = Color3.fromRGB(25, 26, 34),
        Button = Color3.fromRGB(36, 38, 48),
        Panel = Color3.fromRGB(30, 31, 40),
        Accent = Color3.fromRGB(100, 150, 220),
        Text = Color3.fromRGB(235, 236, 245),
        SubText = Color3.fromRGB(150, 152, 170),
    },
    SoftDark2 = {
        MenuBar = Color3.fromRGB(26, 24, 32),
        Button = Color3.fromRGB(38, 34, 48),
        Panel = Color3.fromRGB(32, 29, 42),
        Accent = Color3.fromRGB(180, 120, 220),
        Text = Color3.fromRGB(240, 235, 250),
        SubText = Color3.fromRGB(170, 160, 190),
    },
    SoftDark3 = {
        MenuBar = Color3.fromRGB(24, 26, 28),
        Button = Color3.fromRGB(34, 36, 40),
        Panel = Color3.fromRGB(30, 32, 36),
        Accent = Color3.fromRGB(110, 180, 220),
        Text = Color3.fromRGB(235, 240, 245),
        SubText = Color3.fromRGB(150, 160, 175),
    },
    SoftDark4 = {
        MenuBar = Color3.fromRGB(22, 28, 30),
        Button = Color3.fromRGB(32, 40, 44),
        Panel = Color3.fromRGB(28, 36, 40),
        Accent = Color3.fromRGB(110, 200, 200),
        Text = Color3.fromRGB(230, 245, 245),
        SubText = Color3.fromRGB(150, 175, 180),
    },
    SoftDark5 = {
        MenuBar = Color3.fromRGB(24, 24, 32),
        Button = Color3.fromRGB(34, 34, 46),
        Panel = Color3.fromRGB(30, 30, 40),
        Accent = Color3.fromRGB(150, 180, 250),
        Text = Color3.fromRGB(235, 235, 250),
        SubText = Color3.fromRGB(165, 165, 190),
    },

    -- Soft light variants
    SoftLight1 = {
        MenuBar = Color3.fromRGB(240, 242, 246),
        Button = Color3.fromRGB(250, 252, 255),
        Panel = Color3.fromRGB(245, 247, 252),
        Accent = Color3.fromRGB(110, 150, 230),
        Text = Color3.fromRGB(25, 28, 40),
        SubText = Color3.fromRGB(130, 138, 160),
    },
    SoftLight2 = {
        MenuBar = Color3.fromRGB(244, 240, 248),
        Button = Color3.fromRGB(252, 248, 255),
        Panel = Color3.fromRGB(248, 244, 252),
        Accent = Color3.fromRGB(180, 130, 235),
        Text = Color3.fromRGB(30, 26, 48),
        SubText = Color3.fromRGB(140, 130, 170),
    },
    SoftLight3 = {
        MenuBar = Color3.fromRGB(242, 244, 248),
        Button = Color3.fromRGB(252, 253, 255),
        Panel = Color3.fromRGB(246, 248, 252),
        Accent = Color3.fromRGB(130, 180, 230),
        Text = Color3.fromRGB(28, 32, 42),
        SubText = Color3.fromRGB(135, 145, 165),
    },
    SoftLight4 = {
        MenuBar = Color3.fromRGB(245, 246, 240),
        Button = Color3.fromRGB(252, 253, 245),
        Panel = Color3.fromRGB(248, 249, 242),
        Accent = Color3.fromRGB(210, 180, 120),
        Text = Color3.fromRGB(40, 35, 25),
        SubText = Color3.fromRGB(150, 140, 115),
    },
    SoftLight5 = {
        MenuBar = Color3.fromRGB(240, 245, 244),
        Button = Color3.fromRGB(248, 252, 252),
        Panel = Color3.fromRGB(244, 248, 246),
        Accent = Color3.fromRGB(130, 205, 190),
        Text = Color3.fromRGB(26, 40, 36),
        SubText = Color3.fromRGB(120, 150, 140),
    },

    -- Minimal color variants (many to reach 100)
    Blue01 = {
        MenuBar = Color3.fromRGB(18, 26, 35),
        Button = Color3.fromRGB(28, 40, 55),
        Panel = Color3.fromRGB(22, 32, 45),
        Accent = Color3.fromRGB(90, 160, 230),
        Text = Color3.fromRGB(230, 240, 250),
        SubText = Color3.fromRGB(150, 170, 195),
    },
    Blue02 = {
        MenuBar = Color3.fromRGB(16, 30, 42),
        Button = Color3.fromRGB(26, 45, 60),
        Panel = Color3.fromRGB(20, 38, 52),
        Accent = Color3.fromRGB(100, 170, 240),
        Text = Color3.fromRGB(230, 242, 255),
        SubText = Color3.fromRGB(150, 175, 205),
    },
    Blue03 = {
        MenuBar = Color3.fromRGB(20, 32, 50),
        Button = Color3.fromRGB(30, 45, 65),
        Panel = Color3.fromRGB(24, 40, 58),
        Accent = Color3.fromRGB(110, 180, 250),
        Text = Color3.fromRGB(232, 242, 255),
        SubText = Color3.fromRGB(155, 178, 210),
    },
    Blue04 = {
        MenuBar = Color3.fromRGB(18, 28, 44),
        Button = Color3.fromRGB(28, 42, 60),
        Panel = Color3.fromRGB(22, 36, 52),
        Accent = Color3.fromRGB(120, 190, 255),
        Text = Color3.fromRGB(232, 244, 255),
        SubText = Color3.fromRGB(155, 180, 212),
    },
    Blue05 = {
        MenuBar = Color3.fromRGB(15, 30, 48),
        Button = Color3.fromRGB(26, 44, 66),
        Panel = Color3.fromRGB(20, 36, 54),
        Accent = Color3.fromRGB(130, 200, 255),
        Text = Color3.fromRGB(235, 245, 255),
        SubText = Color3.fromRGB(160, 185, 215),
    },

    Purple01 = {
        MenuBar = Color3.fromRGB(26, 20, 40),
        Button = Color3.fromRGB(38, 30, 60),
        Panel = Color3.fromRGB(32, 26, 52),
        Accent = Color3.fromRGB(180, 130, 255),
        Text = Color3.fromRGB(240, 230, 255),
        SubText = Color3.fromRGB(185, 165, 220),
    },
    Purple02 = {
        MenuBar = Color3.fromRGB(28, 18, 44),
        Button = Color3.fromRGB(42, 26, 70),
        Panel = Color3.fromRGB(34, 22, 58),
        Accent = Color3.fromRGB(190, 120, 255),
        Text = Color3.fromRGB(245, 230, 255),
        SubText = Color3.fromRGB(190, 160, 225),
    },
    Purple03 = {
        MenuBar = Color3.fromRGB(24, 18, 42),
        Button = Color3.fromRGB(36, 26, 64),
        Panel = Color3.fromRGB(30, 22, 56),
        Accent = Color3.fromRGB(175, 130, 245),
        Text = Color3.fromRGB(240, 230, 255),
        SubText = Color3.fromRGB(185, 165, 218),
    },
    Purple04 = {
        MenuBar = Color3.fromRGB(22, 16, 40),
        Button = Color3.fromRGB(34, 24, 62),
        Panel = Color3.fromRGB(28, 20, 54),
        Accent = Color3.fromRGB(170, 125, 240),
        Text = Color3.fromRGB(238, 228, 255),
        SubText = Color3.fromRGB(182, 162, 216),
    },
    Purple05 = {
        MenuBar = Color3.fromRGB(30, 16, 44),
        Button = Color3.fromRGB(44, 24, 68),
        Panel = Color3.fromRGB(36, 20, 58),
        Accent = Color3.fromRGB(200, 130, 250),
        Text = Color3.fromRGB(245, 230, 255),
        SubText = Color3.fromRGB(190, 160, 222),
    },

    Green01 = {
        MenuBar = Color3.fromRGB(16, 30, 22),
        Button = Color3.fromRGB(24, 45, 30),
        Panel = Color3.fromRGB(20, 38, 26),
        Accent = Color3.fromRGB(110, 210, 150),
        Text = Color3.fromRGB(220, 245, 230),
        SubText = Color3.fromRGB(150, 190, 165),
    },
    Green02 = {
        MenuBar = Color3.fromRGB(18, 32, 20),
        Button = Color3.fromRGB(26, 48, 28),
        Panel = Color3.fromRGB(22, 40, 24),
        Accent = Color3.fromRGB(120, 220, 160),
        Text = Color3.fromRGB(225, 248, 235),
        SubText = Color3.fromRGB(155, 195, 170),
    },
    Green03 = {
        MenuBar = Color3.fromRGB(18, 32, 25),
        Button = Color3.fromRGB(26, 48, 36),
        Panel = Color3.fromRGB(22, 40, 30),
        Accent = Color3.fromRGB(110, 215, 170),
        Text = Color3.fromRGB(220, 248, 238),
        SubText = Color3.fromRGB(145, 195, 178),
    },
    Green04 = {
        MenuBar = Color3.fromRGB(16, 34, 26),
        Button = Color3.fromRGB(26, 52, 38),
        Panel = Color3.fromRGB(20, 42, 32),
        Accent = Color3.fromRGB(115, 225, 175),
        Text = Color3.fromRGB(225, 250, 240),
        SubText = Color3.fromRGB(150, 198, 180),
    },
    Green05 = {
        MenuBar = Color3.fromRGB(14, 32, 24),
        Button = Color3.fromRGB(24, 50, 36),
        Panel = Color3.fromRGB(18, 40, 30),
        Accent = Color3.fromRGB(105, 215, 165),
        Text = Color3.fromRGB(218, 246, 237),
        SubText = Color3.fromRGB(142, 194, 176),
    },

    Red01 = {
        MenuBar = Color3.fromRGB(38, 18, 20),
        Button = Color3.fromRGB(52, 26, 30),
        Panel = Color3.fromRGB(44, 22, 26),
        Accent = Color3.fromRGB(220, 90, 100),
        Text = Color3.fromRGB(250, 230, 235),
        SubText = Color3.fromRGB(190, 150, 155),
    },
    Red02 = {
        MenuBar = Color3.fromRGB(42, 16, 20),
        Button = Color3.fromRGB(58, 22, 28),
        Panel = Color3.fromRGB(50, 20, 26),
        Accent = Color3.fromRGB(230, 100, 110),
        Text = Color3.fromRGB(252, 230, 236),
        SubText = Color3.fromRGB(195, 150, 158),
    },
    Red03 = {
        MenuBar = Color3.fromRGB(36, 16, 22),
        Button = Color3.fromRGB(50, 22, 32),
        Panel = Color3.fromRGB(42, 20, 28),
        Accent = Color3.fromRGB(215, 95, 120),
        Text = Color3.fromRGB(248, 230, 240),
        SubText = Color3.fromRGB(188, 150, 165),
    },
    Red04 = {
        MenuBar = Color3.fromRGB(40, 18, 24),
        Button = Color3.fromRGB(54, 24, 34),
        Panel = Color3.fromRGB(46, 20, 30),
        Accent = Color3.fromRGB(225, 105, 125),
        Text = Color3.fromRGB(250, 232, 240),
        SubText = Color3.fromRGB(192, 154, 168),
    },
    Red05 = {
        MenuBar = Color3.fromRGB(34, 16, 24),
        Button = Color3.fromRGB(48, 22, 34),
        Panel = Color3.fromRGB(40, 20, 30),
        Accent = Color3.fromRGB(210, 100, 130),
        Text = Color3.fromRGB(246, 230, 240),
        SubText = Color3.fromRGB(186, 152, 170),
    },

    -- Neutral greys
    Grey01 = {
        MenuBar = Color3.fromRGB(28, 28, 32),
        Button = Color3.fromRGB(40, 40, 46),
        Panel = Color3.fromRGB(34, 34, 40),
        Accent = Color3.fromRGB(110, 150, 220),
        Text = Color3.fromRGB(235, 235, 245),
        SubText = Color3.fromRGB(160, 160, 175),
    },
    Grey02 = {
        MenuBar = Color3.fromRGB(26, 26, 30),
        Button = Color3.fromRGB(38, 38, 44),
        Panel = Color3.fromRGB(32, 32, 38),
        Accent = Color3.fromRGB(130, 180, 230),
        Text = Color3.fromRGB(235, 236, 246),
        SubText = Color3.fromRGB(160, 162, 178),
    },
    Grey03 = {
        MenuBar = Color3.fromRGB(30, 30, 34),
        Button = Color3.fromRGB(44, 44, 50),
        Panel = Color3.fromRGB(36, 36, 42),
        Accent = Color3.fromRGB(100, 140, 220),
        Text = Color3.fromRGB(233, 234, 244),
        SubText = Color3.fromRGB(158, 160, 176),
    },
    Grey04 = {
        MenuBar = Color3.fromRGB(32, 32, 36),
        Button = Color3.fromRGB(46, 46, 52),
        Panel = Color3.fromRGB(38, 38, 44),
        Accent = Color3.fromRGB(150, 190, 240),
        Text = Color3.fromRGB(238, 239, 248),
        SubText = Color3.fromRGB(165, 167, 183),
    },
    Grey05 = {
        MenuBar = Color3.fromRGB(24, 24, 28),
        Button = Color3.fromRGB(36, 36, 42),
        Panel = Color3.fromRGB(30, 30, 36),
        Accent = Color3.fromRGB(120, 160, 230),
        Text = Color3.fromRGB(232, 234, 244),
        SubText = Color3.fromRGB(156, 160, 176),
    },
}

local function getKeyName(keyCode)
    local keyString = tostring(keyCode)
    return keyString:match("Enum%.KeyCode%.(.+)") or keyString
end

-- Toggle Arrow
local ToggleArrow = Instance.new("TextButton")
ToggleArrow.Name = "ToggleArrow"
ToggleArrow.Size = UDim2.new(0, 32, 0, 24)
ToggleArrow.Position = UDim2.new(0.5, -16, 0, 10)
ToggleArrow.AnchorPoint = Vector2.new(0.5, 0)
ToggleArrow.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
ToggleArrow.BackgroundTransparency = 0.2
ToggleArrow.BorderSizePixel = 0
ToggleArrow.Text = "â–¼"
ToggleArrow.TextColor3 = Color3.fromRGB(230, 230, 240)
ToggleArrow.TextSize = 16
ToggleArrow.Font = Enum.Font.GothamBold
ToggleArrow.ZIndex = 1000
ToggleArrow.Parent = ScreenGui

local ArrowCorner = Instance.new("UICorner")
ArrowCorner.CornerRadius = UDim.new(0, 8)
ArrowCorner.Parent = ToggleArrow

-- Hover animation for ToggleArrow
hoverTween(ToggleArrow,
    {BackgroundTransparency = 0, BackgroundColor3 = Color3.fromRGB(70, 70, 80)},
    {BackgroundTransparency = 0.2, BackgroundColor3 = Color3.fromRGB(50, 50, 55)}
)

-- Menu Bar
local MenuBar = Instance.new("Frame")
MenuBar.Name = "MenuBar"
MenuBar.Size = UDim2.new(0, 440, 0, 68)
MenuBar.Position = UDim2.new(0.5, -10, 0, -100)
MenuBar.AnchorPoint = Vector2.new(0.5, 0.5)
MenuBar.BackgroundColor3 = Color3.fromRGB(24, 24, 28)
MenuBar.BackgroundTransparency = 1
MenuBar.Visible = false
MenuBar.BorderSizePixel = 0
MenuBar.ZIndex = 999
MenuBar.Parent = ScreenGui

local BarCorner = Instance.new("UICorner")
BarCorner.CornerRadius = UDim.new(0, 20)
BarCorner.Parent = MenuBar

-- Time Label
local TimeLabel = Instance.new("TextLabel")
TimeLabel.Size = UDim2.new(0, 70, 1, 0)
TimeLabel.Position = UDim2.new(0, 20, 0, 0)
TimeLabel.BackgroundTransparency = 1
TimeLabel.Text = os.date("")
TimeLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TimeLabel.Font = Enum.Font.GothamBold
TimeLabel.TextSize = 18
TimeLabel.TextXAlignment = Enum.TextXAlignment.Left
TimeLabel.Parent = MenuBar

-- Icons Container
local IconsFrame = Instance.new("Frame")
IconsFrame.Size = UDim2.new(0, 520, 1, 0)
IconsFrame.Position = UDim2.new(0.5, -260, 0, 0)
IconsFrame.BackgroundTransparency = 1
IconsFrame.Parent = MenuBar

local ListLayout = Instance.new("UIListLayout")
ListLayout.FillDirection = Enum.FillDirection.Horizontal
ListLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
ListLayout.VerticalAlignment = Enum.VerticalAlignment.Center
ListLayout.Padding = UDim.new(0, 12)
ListLayout.Parent = IconsFrame

-- Icon Data
local iconData = {
    { Name = "Character",  AssetId = "118203553865519" },
    { Name = "Commands",   AssetId = "84250036897477" },
    { Name = "Players",    AssetId = "100506444732420" },
    { Name = "Rejoin",     AssetId = "71380816743530" },
    { Name = "Serverhop",  AssetId = "130700970371417" },
    { Name = "Settings",   AssetId = "72791892951279" },
}

-- Commands Data Storage
local CommandData = {}
local DATA_KEY = "ArrowMenu_Commands_v1"

local function loadCommands()
    if isfile and readfile then
        if isfile(DATA_KEY) then
            local success, data = pcall(function()
                return HttpService:JSONDecode(readfile(DATA_KEY))
            end)
            if success and type(data) == "table" then
                CommandData = data
            end
        end
    end
end

local function saveCommands()
    if writefile then
        pcall(function()
            writefile(DATA_KEY, HttpService:JSONEncode(CommandData))
        end)
    end
end

loadCommands()

-- ============================================
-- THEME APPLY
-- ============================================

local function applyTheme(themeName)
    local theme = themes[themeName]
    if not theme then
        warn("Theme not found:", themeName)
        return
    end
    
    currentTheme = themeName
    
    if ToggleArrow then
        ToggleArrow.BackgroundColor3 = theme.Button
        ToggleArrow.TextColor3 = theme.Text
    end
    
    if MenuBar then
        MenuBar.BackgroundColor3 = theme.MenuBar
    end
    
    if TimeLabel then
        TimeLabel.TextColor3 = theme.Text
    end
    
    for _, child in pairs(IconsFrame:GetChildren()) do
        if child:IsA("Frame") and not child:IsA("UIListLayout") then
            child.BackgroundColor3 = theme.Button
            local icon = child:FindFirstChild("ImageLabel")
            if icon then
                icon.ImageColor3 = theme.Text
            end
        end
    end
    
    for _, child in pairs(ScreenGui:GetChildren()) do
        if child:IsA("Frame") and child.Name:match("Panel") then
            child.BackgroundColor3 = theme.Panel
            
            for _, desc in pairs(child:GetDescendants()) do
                if desc:IsA("Frame") and desc.BackgroundTransparency < 1 then
                    if desc.Name:match("Frame") or desc.Name:match("Container") or desc.Name == "SliderBack" or desc.Name == "PlayerFrame" then
                        desc.BackgroundColor3 = theme.Button
                    end
                elseif desc:IsA("TextBox") then
                    desc.BackgroundColor3 = theme.Button
                    desc.TextColor3 = theme.Text
                    desc.PlaceholderColor3 = theme.SubText
                elseif desc:IsA("TextButton") then
                    if desc.Name == "KeybindButton" or desc.Name == "MenuKeybindButton" or desc.Name == "TpButton" then
                        desc.BackgroundColor3 = theme.Accent
                        desc.TextColor3 = theme.Text
                    elseif desc.Name == "ThemeButton" then
                        desc.BackgroundColor3 = Color3.fromRGB(
                            math.clamp(theme.Accent.R * 255 + 80, 0, 255),
                            math.clamp(theme.Accent.G * 255 - 40, 0, 255),
                            math.clamp(theme.Accent.B * 255 + 40, 0, 255)
                        )
                        desc.TextColor3 = theme.Text
                    elseif desc.Name == "SpectateButton" then
                        local isSpectating = desc.Text == "Spectating"
                        if isSpectating then
                            desc.BackgroundColor3 = Color3.fromRGB(200, 100, 100)
                        else
                            desc.BackgroundColor3 = Color3.fromRGB(
                                math.clamp(theme.Accent.R * 255 + 40, 0, 255),
                                math.clamp(theme.Accent.G * 255 - 60, 0, 255),
                                math.clamp(theme.Accent.B * 255 + 55, 0, 255)
                            )
                        end
                        desc.TextColor3 = theme.Text
                    elseif desc.Name == "SliderButton" then
                        desc.BackgroundColor3 = theme.Text
                    elseif desc.Name == "ExecButton" or desc.Name == "AddButton" or desc.Name == "SaveBtn" then
                        desc.BackgroundColor3 = theme.Accent
                        desc.TextColor3 = theme.Text
                    end
                elseif desc:IsA("TextLabel") then
                    if desc.Name == "ValueLabel" then
                        desc.TextColor3 = theme.Accent
                    elseif desc.Name:match("Desc") or desc.Name:match("Hint") then
                        desc.TextColor3 = theme.SubText
                    elseif desc.Name == "Label" or desc.Name:match("Label") then
                        if not desc.Name:match("Value") then
                            desc.TextColor3 = theme.Text
                        end
                    end
                elseif desc:IsA("ScrollingFrame") then
                    desc.ScrollBarImageColor3 = theme.SubText
                elseif desc.Name == "SliderFill" then
                    desc.BackgroundColor3 = theme.Accent
                end
            end
        end
    end
end

-- ============================================
-- SLIDER CREATOR (with hover on handle)
-- ============================================

local function createSlider(parent, labelText, minVal, maxVal, defaultVal, callback)
    local Container = Instance.new("Frame")
    Container.Size = UDim2.new(1, 0, 0, 45)
    Container.BackgroundTransparency = 1
    Container.Parent = parent
    
    local Label = Instance.new("TextLabel")
    Label.Size = UDim2.new(0, 100, 0, 18)
    Label.Position = UDim2.new(0, 0, 0, 0)
    Label.BackgroundTransparency = 1
    Label.Text = labelText
    Label.TextColor3 = Color3.fromRGB(200, 200, 200)
    Label.Font = Enum.Font.GothamMedium
    Label.TextSize = 13
    Label.TextXAlignment = Enum.TextXAlignment.Left
    Label.Parent = Container
    
    local ValueLabel = Instance.new("TextLabel")
    ValueLabel.Name = "ValueLabel"
    ValueLabel.Size = UDim2.new(0, 50, 0, 18)
    ValueLabel.Position = UDim2.new(1, -50, 0, 0)
    ValueLabel.BackgroundTransparency = 1
    ValueLabel.Text = tostring(defaultVal)
    ValueLabel.TextColor3 = Color3.fromRGB(120, 180, 255)
    ValueLabel.Font = Enum.Font.GothamBold
    ValueLabel.TextSize = 13
    ValueLabel.TextXAlignment = Enum.TextXAlignment.Right
    ValueLabel.Parent = Container
    
    local SliderBack = Instance.new("Frame")
    SliderBack.Name = "SliderBack"
    SliderBack.Size = UDim2.new(1, 0, 0, 5)
    SliderBack.Position = UDim2.new(0, 0, 0, 24)
    SliderBack.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
    SliderBack.BorderSizePixel = 0
    SliderBack.Parent = Container
    
    local SliderBackCorner = Instance.new("UICorner")
    SliderBackCorner.CornerRadius = UDim.new(0, 2.5)
    SliderBackCorner.Parent = SliderBack
    
    local SliderFill = Instance.new("Frame")
    SliderFill.Name = "SliderFill"
    SliderFill.Size = UDim2.new((defaultVal - minVal) / (maxVal - minVal), 0, 1, 0)
    SliderFill.BackgroundColor3 = Color3.fromRGB(120, 180, 255)
    SliderFill.BorderSizePixel = 0
    SliderFill.Parent = SliderBack
    
    local SliderFillCorner = Instance.new("UICorner")
    SliderFillCorner.CornerRadius = UDim.new(0, 2.5)
    SliderFillCorner.Parent = SliderFill
    
    local SliderButton = Instance.new("TextButton")
    SliderButton.Name = "SliderButton"
    SliderButton.Size = UDim2.new(0, 14, 0, 14)
    SliderButton.Position = UDim2.new((defaultVal - minVal) / (maxVal - minVal), -7, 0.5, -7)
    SliderButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    SliderButton.BorderSizePixel = 0
    SliderButton.Text = ""
    SliderButton.Parent = SliderBack
    
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(1, 0)
    ButtonCorner.Parent = SliderButton
    
    -- Hover on slider handle
    hoverTween(SliderButton,
        {Size = UDim2.new(0, 18, 0, 18), BackgroundColor3 = Color3.fromRGB(240, 240, 255)},
        {Size = UDim2.new(0, 14, 0, 14), BackgroundColor3 = Color3.fromRGB(255, 255, 255)}
    )
    
    local dragging = false
    
    local function updateSlider(input)
        local pos = (input.Position.X - SliderBack.AbsolutePosition.X) / SliderBack.AbsoluteSize.X
        pos = math.clamp(pos, 0, 1)
        
        local value = math.floor(minVal + (maxVal - minVal) * pos)
        ValueLabel.Text = tostring(value)
        
        SliderFill.Size = UDim2.new(pos, 0, 1, 0)
        SliderButton.Position = UDim2.new(pos, -7, 0.5, -7)
        
        callback(value)
    end
    
    SliderButton.MouseButton1Down:Connect(function()
        dragging = true
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            updateSlider(input)
        end
    end)
    
    SliderBack.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            updateSlider(input)
        end
    end)
    
    return Container
end

-- ============================================
-- PANEL CREATOR (with tweens & hovers inside)
-- ============================================

local function createPanel(buttonName, assetId)
    local Panel = Instance.new("Frame")
    Panel.Name = buttonName .. "Panel"
    Panel.Size = UDim2.new(0, 440, 0, 300)
    Panel.Position = UDim2.new(0.5, -10, 0, -100)
    Panel.AnchorPoint = Vector2.new(0.5, 0.5)
    Panel.BackgroundColor3 = Color3.fromRGB(28, 28, 30)
    Panel.BackgroundTransparency = 1
    Panel.Visible = false
    Panel.BorderSizePixel = 0
    Panel.ZIndex = 998
    Panel.Parent = ScreenGui

    local PanelCorner = Instance.new("UICorner")
    PanelCorner.CornerRadius = UDim.new(0, 16)
    PanelCorner.Parent = Panel

    local Header = Instance.new("Frame")
    Header.Size = UDim2.new(1, 0, 0, 60)
    Header.BackgroundTransparency = 1
    Header.Parent = Panel

    local HeaderIconFrame = Instance.new("Frame")
    HeaderIconFrame.Size = UDim2.new(0, 36, 0, 36)
    HeaderIconFrame.Position = UDim2.new(0, 24, 0, 12)
    HeaderIconFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 65)
    HeaderIconFrame.Parent = Header

    local HeaderIconCorner = Instance.new("UICorner")
    HeaderIconCorner.CornerRadius = UDim.new(0, 8)
    HeaderIconCorner.Parent = HeaderIconFrame

    local IconImage = Instance.new("ImageLabel")
    IconImage.Size = UDim2.new(0, 20, 0, 20)
    IconImage.Position = UDim2.new(0.5, -10, 0.5, -10)
    IconImage.BackgroundTransparency = 1
    IconImage.Image = "rbxassetid://" .. assetId
    IconImage.ImageColor3 = Color3.fromRGB(255, 255, 255)
    IconImage.Parent = HeaderIconFrame

    local Title = Instance.new("TextLabel")
    Title.Size = UDim2.new(1, -80, 1, 0)
    Title.Position = UDim2.new(0, 70, 0, 0)
    Title.BackgroundTransparency = 1
    Title.Text = buttonName
    Title.TextColor3 = Color3.fromRGB(255, 255, 255)
    Title.Font = Enum.Font.GothamBold
    Title.TextSize = 22
    Title.TextXAlignment = Enum.TextXAlignment.Left
    Title.Parent = Header

    local Content = Instance.new("Frame")
    Content.Size = UDim2.new(1, -48, 1, -80)
    Content.Position = UDim2.new(0, 24, 0, 70)
    Content.BackgroundTransparency = 1
    Content.Parent = Panel

    -- Character Panel
    if buttonName == "Character" then
        local SliderContainer = Instance.new("Frame")
        SliderContainer.Size = UDim2.new(1, 0, 1, 0)
        SliderContainer.BackgroundTransparency = 1
        SliderContainer.Parent = Content
        
        local SliderLayout = Instance.new("UIListLayout")
        SliderLayout.FillDirection = Enum.FillDirection.Vertical
        SliderLayout.Padding = UDim.new(0, 8)
        SliderLayout.Parent = SliderContainer
        
        createSlider(SliderContainer, "Walk Speed", 16, 200, currentSpeed, function(value)
            currentSpeed = value
            if player.Character and player.Character:FindFirstChild("Humanoid") then
                player.Character.Humanoid.WalkSpeed = value
            end
        end)
        
        createSlider(SliderContainer, "Jump Power", 0, 350, currentJump, function(value)
            currentJump = value
            local character = player.Character
            local humanoid = character and character:FindFirstChildOfClass("Humanoid")
            if character and humanoid then
                if humanoid.UseJumpPower then
                    humanoid.JumpPower = value
                else
                    humanoid.JumpHeight = value
                end
            end
        end)
        
        createSlider(SliderContainer, "Fly Speed", 10, 200, currentFlySpeed, function(value)
            currentFlySpeed = value
            Fly.Speed = value
        end)
        
        local FlyHint = Instance.new("TextLabel")
        FlyHint.Name = "FlyHint"
        FlyHint.Size = UDim2.new(1, 0, 0, 16)
        FlyHint.BackgroundTransparency = 1
        FlyHint.Text = "Set Fly Keybind In Settings"
        FlyHint.TextColor3 = Color3.fromRGB(120, 120, 120)
        FlyHint.Font = Enum.Font.Gotham
        FlyHint.TextSize = 11
        FlyHint.TextXAlignment = Enum.TextXAlignment.Left
        FlyHint.Parent = SliderContainer
        
        createSlider(SliderContainer, "Field of View", 70, 120, currentFOV, function(value)
            currentFOV = value
            local camera = workspace.CurrentCamera
            if camera then
                camera.FieldOfView = value
            end
        end)
        
    -- Commands Panel
    elseif buttonName == "Commands" then
        local TabFrame = Instance.new("Frame")
        TabFrame.Size = UDim2.new(1, 0, 0, 36)
        TabFrame.Position = UDim2.new(0, 0, 0, 0)
        TabFrame.BackgroundTransparency = 1
        TabFrame.Parent = Content

        local MainTab = Instance.new("TextButton")
        MainTab.Name = "MainTab"
        MainTab.Size = UDim2.new(0.5, -4, 1, 0)
        MainTab.Position = UDim2.new(0, 0, 0, 0)
        MainTab.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
        MainTab.Text = "Main"
        MainTab.TextColor3 = Color3.fromRGB(255, 255, 255)
        MainTab.Font = Enum.Font.GothamBold
        MainTab.TextSize = 14
        MainTab.Parent = TabFrame

        local MainTabCorner = Instance.new("UICorner")
        MainTabCorner.CornerRadius = UDim.new(0, 8)
        MainTabCorner.Parent = MainTab

        local CustomTab = Instance.new("TextButton")
        CustomTab.Name = "CustomTab"
        CustomTab.Size = UDim2.new(0.5, -4, 1, 0)
        CustomTab.Position = UDim2.new(0.5, 4, 0, 0)
        CustomTab.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        CustomTab.Text = "Custom"
        CustomTab.TextColor3 = Color3.fromRGB(180, 180, 180)
        CustomTab.Font = Enum.Font.GothamBold
        CustomTab.TextSize = 14
        CustomTab.Parent = TabFrame

        local CustomTabCorner = Instance.new("UICorner")
        CustomTabCorner.CornerRadius = UDim.new(0, 8)
        CustomTabCorner.Parent = CustomTab

        local SearchBar = Instance.new("TextBox")
        SearchBar.Size = UDim2.new(1, -50, 0, 32)
        SearchBar.Position = UDim2.new(0, 0, 0, 40)
        SearchBar.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        SearchBar.BorderSizePixel = 0
        SearchBar.Text = ""
        SearchBar.PlaceholderText = "Search commands..."
        SearchBar.TextColor3 = Color3.fromRGB(255, 255, 255)
        SearchBar.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
        SearchBar.Font = Enum.Font.Gotham
        SearchBar.TextSize = 13
        SearchBar.TextXAlignment = Enum.TextXAlignment.Left
        SearchBar.ClearTextOnFocus = false
        SearchBar.Parent = Content

        local SearchPadding = Instance.new("UIPadding")
        SearchPadding.PaddingLeft = UDim.new(0, 10)
        SearchPadding.Parent = SearchBar

        local SearchCorner = Instance.new("UICorner")
        SearchCorner.CornerRadius = UDim.new(0, 8)
        SearchCorner.Parent = SearchBar

        local AddButton = Instance.new("TextButton")
        AddButton.Name = "AddButton"
        AddButton.Size = UDim2.new(0, 40, 0, 32)
        AddButton.Position = UDim2.new(1, -40, 0, 40)
        AddButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
        AddButton.BorderSizePixel = 0
        AddButton.Text = "+"
        AddButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        AddButton.Font = Enum.Font.GothamBold
        AddButton.TextSize = 20
        AddButton.Parent = Content

        local AddCorner = Instance.new("UICorner")
        AddCorner.CornerRadius = UDim.new(0, 8)
        AddCorner.Parent = AddButton

        local MainScroll = Instance.new("ScrollingFrame")
        MainScroll.Name = "MainScroll"
        MainScroll.Size = UDim2.new(1, 0, 1, -82)
        MainScroll.Position = UDim2.new(0, 0, 0, 82)
        MainScroll.BackgroundTransparency = 1
        MainScroll.BorderSizePixel = 0
        MainScroll.ScrollBarThickness = 4
        MainScroll.ScrollBarImageColor3 = Color3.fromRGB(120, 120, 120)
        MainScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
        MainScroll.Visible = true
        MainScroll.Parent = Content

        local CustomScroll = Instance.new("ScrollingFrame")
        CustomScroll.Name = "CustomScroll"
        CustomScroll.Size = UDim2.new(1, 0, 1, -82)
        CustomScroll.Position = UDim2.new(0, 0, 0, 82)
        CustomScroll.BackgroundTransparency = 1
        CustomScroll.BorderSizePixel = 0
        CustomScroll.ScrollBarThickness = 4
        CustomScroll.ScrollBarImageColor3 = Color3.fromRGB(120, 120, 120)
        CustomScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
        CustomScroll.Visible = false
        CustomScroll.Parent = Content

        local function setupLayout(scroll)
            local layout = Instance.new("UIListLayout")
            layout.FillDirection = Enum.FillDirection.Vertical
            layout.Padding = UDim.new(0, 8)
            layout.Parent = scroll
            layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
                scroll.CanvasSize = UDim2.new(0, 0, 0, layout.AbsoluteContentSize.Y + 16)
            end)
        end

        setupLayout(MainScroll)
        setupLayout(CustomScroll)

        local currentTab = "Main"

        local function switchTab(tab)
            currentTab = tab
            if tab == "Main" then
                MainTab.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
                MainTab.TextColor3 = Color3.fromRGB(255, 255, 255)
                CustomTab.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
                CustomTab.TextColor3 = Color3.fromRGB(180, 180, 180)
                MainScroll.Visible = true
                CustomScroll.Visible = false
            else
                MainTab.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
                MainTab.TextColor3 = Color3.fromRGB(180, 180, 180)
                CustomTab.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
                CustomTab.TextColor3 = Color3.fromRGB(255, 255, 255)
                MainScroll.Visible = false
                CustomScroll.Visible = true
            end
        end

        MainTab.MouseButton1Click:Connect(function() switchTab("Main") end)
        CustomTab.MouseButton1Click:Connect(function() switchTab("Custom") end)

        local function createCommandButton(name, code, scrollFrame, isCustom)
            local CmdFrame = Instance.new("Frame")
            CmdFrame.Name = name
            CmdFrame.Size = UDim2.new(1, -8, 0, 50)
            CmdFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
            CmdFrame.BorderSizePixel = 0
            CmdFrame.Parent = scrollFrame
            
            local CmdCorner = Instance.new("UICorner")
            CmdCorner.CornerRadius = UDim.new(0, 10)
            CmdCorner.Parent = CmdFrame
            
            local NameLabel = Instance.new("TextLabel")
            NameLabel.Name = "CommandName"
            NameLabel.Size = UDim2.new(1, -240, 1, 0)
            NameLabel.Position = UDim2.new(0, 12, 0, 0)
            NameLabel.BackgroundTransparency = 1
            NameLabel.Text = name
            NameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            NameLabel.Font = Enum.Font.GothamMedium
            NameLabel.TextSize = 14
            NameLabel.TextXAlignment = Enum.TextXAlignment.Left
            NameLabel.TextTruncate = Enum.TextTruncate.AtEnd
            NameLabel.Parent = CmdFrame
            
            local ExecButton = Instance.new("TextButton")
            ExecButton.Name = "ExecButton"
            ExecButton.Size = UDim2.new(0, 70, 0, 32)
            ExecButton.Position = UDim2.new(1, -220, 0.5, -16)
            ExecButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
            ExecButton.Text = "Execute"
            ExecButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            ExecButton.Font = Enum.Font.GothamBold
            ExecButton.TextSize = 12
            ExecButton.Parent = CmdFrame
            
            local ExecCorner = Instance.new("UICorner")
            ExecCorner.CornerRadius = UDim.new(0, 6)
            ExecCorner.Parent = ExecButton
            
            ExecButton.MouseButton1Click:Connect(function()
                local func, err = loadstring(code)
                if func then pcall(func) else warn("Command error:", err) end
            end)
            
            if isCustom then
                local RenameButton = Instance.new("TextButton")
                RenameButton.Size = UDim2.new(0, 60, 0, 32)
                RenameButton.Position = UDim2.new(1, -142, 0.5, -16)
                RenameButton.BackgroundColor3 = Color3.fromRGB(100, 140, 200)
                RenameButton.Text = "Rename"
                RenameButton.TextColor3 = Color3.fromRGB(255, 255, 255)
                RenameButton.Font = Enum.Font.GothamBold
                RenameButton.TextSize = 11
                RenameButton.Parent = CmdFrame
                
                local RenameCorner = Instance.new("UICorner")
                RenameCorner.CornerRadius = UDim.new(0, 6)
                RenameCorner.Parent = RenameButton
                
                RenameButton.MouseButton1Click:Connect(function()
                    local RenamePopup = Instance.new("Frame")
                    RenamePopup.Name = "RenamePopup"
                    RenamePopup.Size = UDim2.new(0, 720, 0, 300)
                    RenamePopup.Position = UDim2.new(0.5, -360, 0.5, -150)
                    RenamePopup.AnchorPoint = Vector2.new(0.5, 0.5)
                    RenamePopup.BackgroundColor3 = Color3.fromRGB(28, 28, 30)
                    RenamePopup.BackgroundTransparency = 1
                    RenamePopup.Visible = true
                    RenamePopup.BorderSizePixel = 0
                    RenamePopup.ZIndex = 1002
                    RenamePopup.Parent = ScreenGui
                    
                    local RenamePopupCorner = Instance.new("UICorner")
                    RenamePopupCorner.CornerRadius = UDim.new(0, 16)
                    RenamePopupCorner.Parent = RenamePopup
                    
                    local RenameHeader = Instance.new("Frame")
                    RenameHeader.Size = UDim2.new(1, 0, 0, 60)
                    RenameHeader.BackgroundTransparency = 1
                    RenameHeader.Parent = RenamePopup
                    
                    local RenameIconFrame = Instance.new("Frame")
                    RenameIconFrame.Size = UDim2.new(0, 36, 0, 36)
                    RenameIconFrame.Position = UDim2.new(0, 24, 0, 12)
                    RenameIconFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 65)
                    RenameIconFrame.Parent = RenameHeader
                    
                    local RenameIconCorner = Instance.new("UICorner")
                    RenameIconCorner.CornerRadius = UDim.new(0, 8)
                    RenameIconCorner.Parent = RenameIconFrame
                    
                    local RenameIcon = Instance.new("ImageLabel")
                    RenameIcon.Size = UDim2.new(0, 20, 0, 20)
                    RenameIcon.Position = UDim2.new(0.5, -10, 0.5, -10)
                    RenameIcon.BackgroundTransparency = 1
                    RenameIcon.Image = "rbxassetid://84250036897477"
                    RenameIcon.ImageColor3 = Color3.fromRGB(255, 255, 255)
                    RenameIcon.Parent = RenameIconFrame
                    
                    local RenameTitle = Instance.new("TextLabel")
                    RenameTitle.Size = UDim2.new(1, -80, 1, 0)
                    RenameTitle.Position = UDim2.new(0, 70, 0, 0)
                    RenameTitle.BackgroundTransparency = 1
                    RenameTitle.Text = "Rename Command"
                    RenameTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
                    RenameTitle.Font = Enum.Font.GothamBold
                    RenameTitle.TextSize = 22
                    RenameTitle.TextXAlignment = Enum.TextXAlignment.Left
                    RenameTitle.Parent = RenameHeader
                    
                    local RenameContent = Instance.new("Frame")
                    RenameContent.Size = UDim2.new(1, -48, 1, -80)
                    RenameContent.Position = UDim2.new(0, 24, 0, 70)
                    RenameContent.BackgroundTransparency = 1
                    RenameContent.Parent = RenamePopup
                    
                    local RenameInput = Instance.new("TextBox")
                    RenameInput.Size = UDim2.new(1, 0, 0, 40)
                    RenameInput.Position = UDim2.new(0, 0, 0, 20)
                    RenameInput.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
                    RenameInput.TextColor3 = Color3.fromRGB(255, 255, 255)
                    RenameInput.PlaceholderText = "Enter new name..."
                    RenameInput.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
                    RenameInput.Font = Enum.Font.Gotham
                    RenameInput.TextSize = 16
                    RenameInput.ClearTextOnFocus = false
                    RenameInput.Parent = RenameContent
                    
                    local RenameInputCorner = Instance.new("UICorner")
                    RenameInputCorner.CornerRadius = UDim.new(0, 8)
                    RenameInputCorner.Parent = RenameInput
                    
                    local RenameInputPadding = Instance.new("UIPadding")
                    RenameInputPadding.PaddingLeft = UDim.new(0, 12)
                    RenameInputPadding.PaddingRight = UDim.new(0, 12)
                    RenameInputPadding.Parent = RenameInput
                    
                    local BtnFrame = Instance.new("Frame")
                    BtnFrame.Size = UDim2.new(1, 0, 0, 40)
                    BtnFrame.Position = UDim2.new(0, 0, 1, -50)
                    BtnFrame.BackgroundTransparency = 1
                    BtnFrame.Parent = RenameContent
                    
                    local ConfirmButton = Instance.new("TextButton")
                    ConfirmButton.Size = UDim2.new(0, 140, 1, 0)
                    ConfirmButton.Position = UDim2.new(0.5, 10, 0, 0)
                    ConfirmButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
                    ConfirmButton.Text = "Confirm"
                    ConfirmButton.TextColor3 = Color3.fromRGB(255, 255, 255)
                    ConfirmButton.Font = Enum.Font.GothamBold
                    ConfirmButton.TextSize = 16
                    ConfirmButton.Parent = BtnFrame
                    
                    local ConfirmCorner = Instance.new("UICorner")
                    ConfirmCorner.CornerRadius = UDim.new(0, 8)
                    ConfirmCorner.Parent = ConfirmButton
                    
                    local CancelButton = Instance.new("TextButton")
                    CancelButton.Size = UDim2.new(0, 140, 1, 0)
                    CancelButton.Position = UDim2.new(0.5, -150, 0, 0)
                    CancelButton.BackgroundColor3 = Color3.fromRGB(80, 80, 85)
                    CancelButton.Text = "Cancel"
                    CancelButton.TextColor3 = Color3.fromRGB(255, 255, 255)
                    CancelButton.Font = Enum.Font.GothamBold
                    CancelButton.TextSize = 16
                    CancelButton.Parent = BtnFrame
                    
                    local CancelCorner = Instance.new("UICorner")
                    CancelCorner.CornerRadius = UDim.new(0, 8)
                    CancelCorner.Parent = CancelButton
                    
                    ConfirmButton.MouseButton1Click:Connect(function()
                        local newName = RenameInput.Text:match("^%s*(.-)%s*$") or ""
                        if newName ~= "" and newName ~= name and not CommandData[newName] then
                            CommandData[newName] = CommandData[name]
                            CommandData[name] = nil
                            saveCommands()
                            NameLabel.Text = newName
                            CmdFrame.Name = newName
                            refreshMainList(SearchBar.Text)
                            refreshCustomList(SearchBar.Text)
                            RenamePopup:Destroy()
                        end
                    end)
                    
                    CancelButton.MouseButton1Click:Connect(function()
                        RenamePopup:Destroy()
                    end)
                    
                    RenameInput.Text = name
                    RenameInput:CaptureFocus()
                    RenameInput.SelectionStart = 1
                    RenameInput.CursorPosition = #name + 1
                    
                    TweenService:Create(RenamePopup, TweenInfo.new(0.3), {BackgroundTransparency = 0}):Play()
                end)
                
                local DeleteButton = Instance.new("TextButton")
                DeleteButton.Size = UDim2.new(0, 32, 0, 32)
                DeleteButton.Position = UDim2.new(1, -70, 0.5, -16)
                DeleteButton.BackgroundColor3 = Color3.fromRGB(200, 70, 70)
                DeleteButton.Text = "X"
                DeleteButton.TextColor3 = Color3.fromRGB(255, 255, 255)
                DeleteButton.Font = Enum.Font.GothamBold
                DeleteButton.TextSize = 16
                DeleteButton.Parent = CmdFrame
                
                local DeleteCorner = Instance.new("UICorner")
                DeleteCorner.CornerRadius = UDim.new(0, 6)
                DeleteCorner.Parent = DeleteButton
                
                DeleteButton.MouseButton1Click:Connect(function()
                    CommandData[name] = nil
                    saveCommands()
                    CmdFrame:Destroy()
                    refreshCustomList(SearchBar.Text)
                end)
            end
        end
        
        local function refreshMainList(filter)
            filter = string.lower(filter or "")
            for _, child in pairs(MainScroll:GetChildren()) do
                if child:IsA("Frame") then child:Destroy() end
            end
            
            local builtInCommands = {
	["Infinite Yield"] = [[loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'))()]],
    ["invsible"] = [[]],
	["Emote Wheel"] = [[if _G.EmotesGUIRunning then
    getgenv().Notify({
        Title = 'KIKO | Emote',
        Content = 'âš ï¸ It works It actually works',
        Duration = 5
    })
    return
end
_G.EmotesGUIRunning = true

loadstring(game:HttpGet("https://raw.githubusercontent.com/7yd7/Menu-7yd7/refs/heads/Script/GUIS/Off-site/Notify.lua"))()
pcall(function()
    loadstring(game:HttpGet("https://raw.githubusercontent.com/7yd7/Hub/Branch/GUIS/count-emote"))()
end)

getgenv().Notify({
    Title = '7yd7 | Emote',
    Content = 'âš ï¸ Script loading...',
    Duration = 5
})

local Players = game:GetService("Players")
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local UserInputService = game:GetService("UserInputService")
local CoreGui = game:GetService("CoreGui")

local emoteClickConnections = {}
local isMonitoringClicks = false
local currentTimer = nil

local currentMode = "emote"
local animationsData = {}
local originalAnimationsData = {}
local filteredAnimations = {}
local favoriteAnimations = {}
local favoriteAnimationsFileName = "FavoriteAnimations.json"
local emoteSearchTerm = ""
local animationSearchTerm = ""

getgenv().lastPlayedAnimation = getgenv().lastPlayedAnimation or nil
getgenv().autoReloadEnabled = getgenv().autoReloadEnabled or false

local lastRadialActionTime = 0

RunService.Heartbeat:Connect(function()
    local success, menu = pcall(function() return CoreGui.RobloxGui.EmotesMenu.Children end)
    if not (success and menu) then return end
    
    local errorMsg = menu:FindFirstChild("ErrorMessage")
    if errorMsg and errorMsg.Visible then
        if player.Character and player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.RigType == Enum.HumanoidRigType.R6 then
            errorMsg.ErrorText.Text = "Only r15 does not work r6"
        elseif tick() - lastRadialActionTime < 2 then
            errorMsg.Visible = false
        end
    end
end)


function ErrorMessage(text, duration)

    if currentTimer then
        task.cancel(currentTimer)
        currentTimer = nil
    end
    
    local errorMessage = CoreGui.RobloxGui.EmotesMenu.Children.ErrorMessage
    local errorText = errorMessage.ErrorText
    
    errorText.Text = text
    
    errorMessage.Visible = true
    
    currentTimer = task.delay(duration, function()
        errorMessage.Visible = false
        currentTimer = nil
    end)
end

local function stopEmotes()
    for _, track in ipairs(humanoid:GetPlayingAnimationTracks()) do
        track:Stop()
    end
end

local emotesData = {}
local currentPage = 1
local itemsPerPage = 8
local totalPages = 1
local filteredEmotes = {}
local isLoading = false
local originalEmotesData = {}
local totalEmotesLoaded = 0
local scannedEmotes = {}
local favoriteEmotes = {}
local favoriteEnabled = false
local favoriteFileName = "FavoriteEmotes.json"
local emotesWalkEnabled = false
local currentEmoteTrack = nil
local currentCharacter = nil
local isGUICreated = false
local speedEmoteEnabled = false
local speedEmoteConfigFile = "SpeedEmoteConfig.json"

local Under, UIListLayout, _1left, _9right, _4pages, _3TextLabel, _2Routenumber, Top, EmoteWalkButton, UICorner1,
    UIListLayout_2, UICorner, Search, Favorite, UICorner2, UICorner_2, SpeedEmote, UICorner_4, SpeedBox, UICorner_5, Changepage,
    Reload, UICorner_6

local defaultButtonImage = "rbxassetid://71408678974152"
local enabledButtonImage = "rbxassetid://106798555684020"

local favoriteIconId = "rbxassetid://97307461910825" 
local notFavoriteIconId = "rbxassetid://124025954365505"

local function getCharacterAndHumanoid()
    local character = player.Character
    if not character then
        return nil, nil
    end
    local humanoid = character:FindFirstChild("Humanoid")
    if not humanoid then
        return nil, nil
    end
    return character, humanoid
end

local function checkEmotesMenuExists()
    local coreGui = game:GetService("CoreGui")
    local robloxGui = coreGui:FindFirstChild("RobloxGui")
    if not robloxGui then
        return false
    end

    local emotesMenu = robloxGui:FindFirstChild("EmotesMenu")
    if not emotesMenu then
        return false
    end

    local children = emotesMenu:FindFirstChild("Children")
    if not children then
        return false
    end

    local main = children:FindFirstChild("Main")
    if not main then
        return false
    end

    local emotesWheel = main:FindFirstChild("EmotesWheel")
    if not emotesWheel then
        return false
    end

    return true, emotesWheel
end

local function getBackgroundOverlay()
    local success, result = pcall(function()
        return game:GetService("CoreGui").RobloxGui.EmotesMenu.Children.Main.EmotesWheel.Back.Background
                   .BackgroundCircleOverlay
    end)
    if success then
        return result
    end
    return nil
end

local function updateGUIColors()
    local backgroundOverlay = getBackgroundOverlay()
    if not backgroundOverlay then
        return
    end

    local bgColor = backgroundOverlay.BackgroundColor3
    local bgTransparency = backgroundOverlay.BackgroundTransparency

    if _1left then
        _1left.ImageColor3 = bgColor
        _1left.ImageTransparency = bgTransparency
    end

    if _9right then
        _9right.ImageColor3 = bgColor
        _9right.ImageTransparency = bgTransparency
    end

    if _4pages then
        _4pages.TextColor3 = bgColor
        _4pages.TextTransparency = bgTransparency
    end

    if _3TextLabel then
        _3TextLabel.TextColor3 = bgColor
        _3TextLabel.TextTransparency = bgTransparency
    end

    if _2Routenumber then
        _2Routenumber.TextColor3 = bgColor
        _2Routenumber.TextTransparency = bgTransparency
    end

    if Top then
        Top.BackgroundColor3 = bgColor
        Top.BackgroundTransparency = bgTransparency
    end

    if EmoteWalkButton then
        EmoteWalkButton.BackgroundColor3 = bgColor
        EmoteWalkButton.BackgroundTransparency = bgTransparency
    end

    if SpeedEmote then
        SpeedEmote.BackgroundColor3 = bgColor
        SpeedEmote.BackgroundTransparency = bgTransparency
    end

     if Changepage then
        Changepage.BackgroundColor3 = bgColor
        Changepage.BackgroundTransparency = bgTransparency
    end

    if SpeedBox then
        SpeedBox.BackgroundColor3 = bgColor
        SpeedBox.BackgroundTransparency = bgTransparency
    end

    if Favorite then
        Favorite.BackgroundColor3 = bgColor
        Favorite.BackgroundTransparency = bgTransparency
    end

if Reload then
    Reload.BackgroundColor3 = bgColor
    Reload.BackgroundTransparency = bgTransparency
    Reload.Visible = (currentMode == "animation")
end
end

local function urlToId(animationId)
    animationId = string.gsub(animationId, "http://www%.roblox%.com/asset/%?id=", "")
    animationId = string.gsub(animationId, "rbxassetid://", "")
    return animationId
end

local function saveFavorites()
    if writefile then
        local jsonData = HttpService:JSONEncode(favoriteEmotes)
        writefile(favoriteFileName, jsonData)
    end
end

local function saveFavoritesAnimations()
    if writefile then
        local jsonData = HttpService:JSONEncode(favoriteAnimations)
        writefile(favoriteAnimationsFileName, jsonData)
    end
end

local function loadFavorites()
    if readfile and isfile and isfile(favoriteFileName) then
        local success, result = pcall(function()
            local fileContent = readfile(favoriteFileName)
            return HttpService:JSONDecode(fileContent)
        end)
        if success and result then
            favoriteEmotes = result
        end
    end
end

local function loadFavoritesAnimations()
    if readfile and isfile and isfile(favoriteAnimationsFileName) then
        local success, result = pcall(function()
            local fileContent = readfile(favoriteAnimationsFileName)
            return HttpService:JSONDecode(fileContent)
        end)
        if success and result then
            favoriteAnimations = result
        end
    end
end

local function loadSpeedEmoteConfig()
    if readfile and isfile and isfile(speedEmoteConfigFile) then
        local success, result = pcall(function()
            local fileContent = readfile(speedEmoteConfigFile)
            return HttpService:JSONDecode(fileContent)
        end)
        if success and result then
            speedEmoteEnabled = result.Enabled or false
            if SpeedBox then
                SpeedBox.Text = tostring(result.SpeedValue or 1)
                SpeedBox.Visible = speedEmoteEnabled
            end
        end
    end
end

local function extractAssetId(imageUrl)
    local assetId = string.match(imageUrl, "Asset&id=(%d+)")
    return assetId
end

local function getEmoteName(assetId)
    local success, productInfo = pcall(function()
        return game:GetService("MarketplaceService"):GetProductInfo(tonumber(assetId))
    end)
    
    if success and productInfo then
        return productInfo.Name
    else
        return "Emote_" .. tostring(assetId)
    end
end

local function isInFavorites(assetId)
    local favoriteList
    if currentMode == "animation" then
        favoriteList = favoriteAnimations
    else
        favoriteList = favoriteEmotes
    end

    for _, favorite in pairs(favoriteList) do
        if tostring(favorite.id) == tostring(assetId) then
            return true
        end
    end
    return false
end

local function updateAnimationImages(currentPageAnimations)
    local success, frontFrame = pcall(function()
        return game:GetService("CoreGui").RobloxGui.EmotesMenu.Children.Main.EmotesWheel.Front.EmotesButtons
    end)
    
    if not success or not frontFrame then
        return
    end
    
    local buttonIndex = 1
    for _, child in pairs(frontFrame:GetChildren()) do
        if child:IsA("ImageLabel") then
            if buttonIndex <= #currentPageAnimations then
                local animationData = currentPageAnimations[buttonIndex]
                child.Image = "rbxthumb://type=BundleThumbnail&id=" .. animationData.id .. "&w=420&h=420"
                
                local idValue = child:FindFirstChild("AnimationID") or Instance.new("IntValue")
                idValue.Name = "AnimationID"
                idValue.Value = animationData.id
                idValue.Parent = child

                buttonIndex = buttonIndex + 1
            else
                child.Image = ""
                local idValue = child:FindFirstChild("AnimationID")
                if idValue then 
                    idValue:Destroy() 
                end
            end
        end
    end
end


local function updateFavoriteIcon(imageLabel, assetId, isFavorite)
    local favoriteIcon = imageLabel:FindFirstChild("FavoriteIcon")
    
    if not favoriteIcon then
        favoriteIcon = Instance.new("ImageLabel")
        favoriteIcon.Name = "FavoriteIcon"
        favoriteIcon.Size = UDim2.new(0.3, 0, 0.3, 0) 
        favoriteIcon.Position = UDim2.new(0.7, 0, 0, 0)
        favoriteIcon.AnchorPoint = Vector2.new(0, 0)
        favoriteIcon.BackgroundTransparency = 1
        favoriteIcon.ZIndex = imageLabel.ZIndex + 5
        favoriteIcon.ScaleType = Enum.ScaleType.Fit
        favoriteIcon.Parent = imageLabel
    end
    
    if isFavorite then
        favoriteIcon.Image = favoriteIconId
    else
        favoriteIcon.Image = notFavoriteIconId 
    end
end

local function updateAllFavoriteIcons()
    local success, frontFrame = pcall(function()
        return game:GetService("CoreGui").RobloxGui.EmotesMenu.Children.Main.EmotesWheel.Front.EmotesButtons
    end)
    
    if success and frontFrame then
        for _, child in pairs(frontFrame:GetChildren()) do
            if child:IsA("ImageLabel") and child.Image ~= "" then
                local assetId
                if currentMode == "animation" then
                    local idValue = child:FindFirstChild("AnimationID")
                    if idValue then
                        assetId = idValue.Value
                    end
                else
                    assetId = extractAssetId(child.Image)
                end
                
                if assetId then
                    local isFavorite = isInFavorites(assetId)
                    updateFavoriteIcon(child, assetId, isFavorite)
                end
            end
        end
    end
end

local function updateAnimations()
    local character, humanoid = getCharacterAndHumanoid()
    if not character or not humanoid then
        return
    end

    local humanoidDescription = humanoid.HumanoidDescription
    if not humanoidDescription then
        return
    end

    local currentPageAnimations = {}
    local animationTable = {}
    local equippedAnimations = {}

    local favoritesToUse = _G.filteredFavoritesAnimationsForDisplay or favoriteAnimations
    local hasFavorites = #favoritesToUse > 0
    local favoritePagesCount = hasFavorites and math.ceil(#favoritesToUse / itemsPerPage) or 0
    local isInFavoritesPages = currentPage <= favoritePagesCount

    if isInFavoritesPages and hasFavorites then
        local startIndex = (currentPage - 1) * itemsPerPage + 1
        local endIndex = math.min(startIndex + itemsPerPage - 1, #favoritesToUse)

        for i = startIndex, endIndex do
            if favoritesToUse[i] then
                table.insert(currentPageAnimations, {
                    id = tonumber(favoritesToUse[i].id),
                    name = favoritesToUse[i].name
                })
            end
        end
    else
        local normalAnimations = {}
        for _, animation in pairs(filteredAnimations) do
            if not isInFavorites(animation.id) then
                table.insert(normalAnimations, animation)
            end
        end

        local adjustedPage = currentPage - favoritePagesCount
        local startIndex = (adjustedPage - 1) * itemsPerPage + 1
        local endIndex = math.min(startIndex + itemsPerPage - 1, #normalAnimations)

        for i = startIndex, endIndex do
            if normalAnimations[i] then
                table.insert(currentPageAnimations, normalAnimations[i])
            end
        end
    end

    for _, animation in pairs(currentPageAnimations) do
        local animationName = animation.name
        local animationId = animation.id
        animationTable[animationName] = {animationId}
        table.insert(equippedAnimations, animationName)
    end

    humanoidDescription:SetEmotes(animationTable)
    humanoidDescription:SetEquippedEmotes(equippedAnimations)
    
    task.wait(0.1)
    updateAnimationImages(currentPageAnimations)

    task.delay(0.2, function()
        if favoriteEnabled then
            updateAllFavoriteIcons()
        end
    end)
end

local function updateEmotes()
    local character, humanoid = getCharacterAndHumanoid()
    if not character or not humanoid then
        return
    end

    if currentMode == "animation" then
        updateAnimations()
        return
    end

    local humanoidDescription = humanoid.HumanoidDescription
    if not humanoidDescription then
        return
    end

    local currentPageEmotes = {}
    local emoteTable = {}
    local equippedEmotes = {}

    local favoritesToUse = _G.filteredFavoritesForDisplay or favoriteEmotes
    local hasFavorites = #favoritesToUse > 0
    local favoritePagesCount = hasFavorites and math.ceil(#favoritesToUse / itemsPerPage) or 0
    local isInFavoritesPages = currentPage <= favoritePagesCount

    if isInFavoritesPages and hasFavorites then
        local startIndex = (currentPage - 1) * itemsPerPage + 1
        local endIndex = math.min(startIndex + itemsPerPage - 1, #favoritesToUse)

        for i = startIndex, endIndex do
            if favoritesToUse[i] then
                table.insert(currentPageEmotes, {
                    id = tonumber(favoritesToUse[i].id),
                    name = favoritesToUse[i].name
                })
            end
        end
    else
        local normalEmotes = {}
        for _, emote in pairs(filteredEmotes) do
            if not isInFavorites(emote.id) then
                table.insert(normalEmotes, emote)
            end
        end

        local adjustedPage = currentPage - favoritePagesCount
        local startIndex = (adjustedPage - 1) * itemsPerPage + 1
        local endIndex = math.min(startIndex + itemsPerPage - 1, #normalEmotes)

        for i = startIndex, endIndex do
            if normalEmotes[i] then
                table.insert(currentPageEmotes, normalEmotes[i])
            end
        end
    end

    for _, emote in pairs(currentPageEmotes) do
        local emoteName = emote.name
        local emoteId = emote.id
        emoteTable[emoteName] = {emoteId}
        table.insert(equippedEmotes, emoteName)
    end

    humanoidDescription:SetEmotes(emoteTable)
    humanoidDescription:SetEquippedEmotes(equippedEmotes)
    
    task.delay(0.2, function()
        if favoriteEnabled then
            updateAllFavoriteIcons()
        end
    end)
end

local function calculateTotalPages()
      if currentMode == "animation" then
        local favoritesToUse = _G.filteredFavoritesAnimationsForDisplay or favoriteAnimations
        local hasFavorites = #favoritesToUse > 0
        local normalAnimationsCount = 0

        for _, animation in pairs(filteredAnimations) do
            if not isInFavorites(animation.id) then
                normalAnimationsCount = normalAnimationsCount + 1
            end
        end

        local pages = 0
        if hasFavorites then
            pages = pages + math.ceil(#favoritesToUse / itemsPerPage)
        end
        if normalAnimationsCount > 0 then
            pages = pages + math.ceil(normalAnimationsCount / itemsPerPage)
        end
        return math.max(pages, 1)
    end
    
    local favoritesToUse = _G.filteredFavoritesForDisplay or favoriteEmotes
    local hasFavorites = #favoritesToUse > 0
    local normalEmotesCount = 0

    for _, emote in pairs(filteredEmotes) do
        if not isInFavorites(emote.id) then
            normalEmotesCount = normalEmotesCount + 1
        end
    end

    local pages = 0

    if hasFavorites then
        pages = pages + math.ceil(#favoritesToUse / itemsPerPage)
    end

    if normalEmotesCount > 0 then
        pages = pages + math.ceil(normalEmotesCount / itemsPerPage)
    end

    return math.max(pages, 1)
end

local function isGivenAnimation(animationHolder, animationId)
    for _, animation in animationHolder:GetChildren() do
        if animation:IsA("Animation") and urlToId(animation.AnimationId) == animationId then
            return true
        end
    end
    return false
end

local function isDancing(character, animationTrack)
    local animationId = urlToId(animationTrack.Animation.AnimationId)
    for _, animationHolder in character.Animate:GetChildren() do
        if animationHolder:IsA("StringValue") then
            local sharesAnimationId = isGivenAnimation(animationHolder, animationId)
            if sharesAnimationId then
                return false
            end
        end
    end
    return true
end

local function createGUIElements()
    local exists, emotesWheel = checkEmotesMenuExists()
    if not exists then
        return false
    end

    if emotesWheel:FindFirstChild("Under") then
        emotesWheel.Under:Destroy()
    end
    if emotesWheel:FindFirstChild("Top") then
        emotesWheel.Top:Destroy()
    end
    if emotesWheel:FindFirstChild("EmoteWalkButton") then
        emotesWheel.EmoteWalkButton:Destroy()
    end
    if emotesWheel:FindFirstChild("Favorite") then
        emotesWheel.Favorite:Destroy()
    end
    if emotesWheel:FindFirstChild("SpeedEmote") then
        emotesWheel.SpeedEmote:Destroy()
    end
    if emotesWheel:FindFirstChild("Changepage") then
        emotesWheel.Changepage:Destroy()
    end
    if emotesWheel:FindFirstChild("SpeedBox") then
        emotesWheel.SpeedBox:Destroy()
    end
    if emotesWheel:FindFirstChild("Reload") then
        emotesWheel.Reload:Destroy()
    end

    Under = Instance.new("Frame")
    UIListLayout = Instance.new("UIListLayout")
    _1left = Instance.new("ImageButton")
    _9right = Instance.new("ImageButton")
    _4pages = Instance.new("TextLabel")
    _3TextLabel = Instance.new("TextLabel")
    _2Routenumber = Instance.new("TextBox")
    EmoteWalkButton = Instance.new("ImageButton")
    UICorner1 = Instance.new("UICorner")
    Top = Instance.new("Frame")
    UIListLayout_2 = Instance.new("UIListLayout")
    UICorner = Instance.new("UICorner")
    Search = Instance.new("TextBox")
    Favorite = Instance.new("ImageButton")
    UICorner2 = Instance.new("UICorner")
    SpeedBox = Instance.new("TextBox")
    UICorner_4 = Instance.new("UICorner")
    SpeedEmote = Instance.new("ImageButton")
    UICorner_2 = Instance.new("UICorner")
    Changepage = Instance.new("ImageButton")
     UICorner_5 = Instance.new("UICorner")
     Reload = Instance.new("ImageButton")
     UICorner_6 = Instance.new("UICorner")

    Under.Name = "Under"
    Under.Parent = emotesWheel
    Under.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Under.BackgroundTransparency = 1.000
    Under.BorderColor3 = Color3.fromRGB(0, 0, 0)
    Under.BorderSizePixel = 0
    Under.Position = UDim2.new(0.129999995, 0, 1, 0)
    Under.Size = UDim2.new(0.737500012, 0, 0.132499993, 0)

    UIListLayout.Parent = Under
    UIListLayout.FillDirection = Enum.FillDirection.Horizontal
    UIListLayout.VerticalAlignment = Enum.VerticalAlignment.Center

    _1left.Name = "1left"
    _1left.Parent = Under
    _1left.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    _1left.BackgroundTransparency = 1.000
    _1left.BorderColor3 = Color3.fromRGB(0, 0, 0)
    _1left.BorderSizePixel = 0
    _1left.Position = UDim2.new(0.0289389063, 0, -0.0849056691, 0)
    _1left.Rotation = 7456.000
    _1left.Size = UDim2.new(0.169491529, 0, 0.94339627, 0)
    _1left.Image = "rbxassetid://93111945058621"
    _1left.ImageColor3 = Color3.fromRGB(0, 0, 0)
    _1left.ImageTransparency = 0.400

    _9right.Name = "9right"
    _9right.Parent = Under
    _9right.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    _9right.BackgroundTransparency = 1.000
    _9right.BorderColor3 = Color3.fromRGB(0, 0, 0)
    _9right.BorderSizePixel = 0
    _9right.Position = UDim2.new(0.0289389063, 0, -0.0849056691, 0)
    _9right.Rotation = 7456.000
    _9right.Size = UDim2.new(0.169491529, 0, 0.94339627, 0)
    _9right.Image = "rbxassetid://107938916240738"
    _9right.ImageColor3 = Color3.fromRGB(0, 0, 0)
    _9right.ImageTransparency = 0.400

    _4pages.Name = "4pages"
    _4pages.Parent = Under
    _4pages.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    _4pages.BackgroundTransparency = 1.000
    _4pages.BorderColor3 = Color3.fromRGB(0, 0, 0)
    _4pages.BorderSizePixel = 0
    _4pages.Position = UDim2.new(0.630225062, 0, 0.188679263, 0)
    _4pages.Size = UDim2.new(0.159322038, 0, 0.811320841, 0)
    _4pages.Font = Enum.Font.SourceSansBold
    _4pages.Text = "1"
    _4pages.TextColor3 = Color3.fromRGB(0, 0, 0)
    _4pages.TextScaled = true
    _4pages.TextSize = 14.000
    _4pages.TextTransparency = 0.400
    _4pages.TextWrapped = true

    _3TextLabel.Name = "3TextLabel"
    _3TextLabel.Parent = Under
    _3TextLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    _3TextLabel.BackgroundTransparency = 1.000
    _3TextLabel.BorderColor3 = Color3.fromRGB(0, 0, 0)
    _3TextLabel.BorderSizePixel = 0
    _3TextLabel.Position = UDim2.new(0.363344043, 0, 0.0283018891, 0)
    _3TextLabel.Size = UDim2.new(0.338983059, 0, 0.94339627, 0)
    _3TextLabel.Font = Enum.Font.SourceSansBold
    _3TextLabel.Text = " ------ "
    _3TextLabel.TextColor3 = Color3.fromRGB(0, 0, 0)
    _3TextLabel.TextScaled = true
    _3TextLabel.TextSize = 14.000
    _3TextLabel.TextTransparency = 0.400
    _3TextLabel.TextWrapped = true

    _2Routenumber.Name = "2Route-number"
    _2Routenumber.Parent = Under
    _2Routenumber.Active = true
    _2Routenumber.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    _2Routenumber.BackgroundTransparency = 1.000
    _2Routenumber.BorderColor3 = Color3.fromRGB(0, 0, 0)
    _2Routenumber.BorderSizePixel = 0
    _2Routenumber.Position = UDim2.new(0.138263673, 0, 0.0283018891, 0)
    _2Routenumber.Selectable = true
    _2Routenumber.Size = UDim2.new(0.159322038, 0, 0.811320841, 0)
    _2Routenumber.Font = Enum.Font.SourceSansBold
    _2Routenumber.PlaceholderColor3 = Color3.fromRGB(0, 0, 0)
    _2Routenumber.Text = "1"
    _2Routenumber.TextColor3 = Color3.fromRGB(0, 0, 0)
    _2Routenumber.TextScaled = true
    _2Routenumber.TextSize = 14.000
    _2Routenumber.TextStrokeColor3 = Color3.fromRGB(255, 255, 255)
    _2Routenumber.TextTransparency = 0.400
    _2Routenumber.TextWrapped = true

    Top.Name = "Top"
    Top.Parent = emotesWheel
    Top.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Top.BackgroundTransparency = 0.400
    Top.BorderColor3 = Color3.fromRGB(0, 0, 0)
    Top.BorderSizePixel = 0
    Top.Position = UDim2.new(0.127499998, 0, -0.109999999, 0)
    Top.Size = UDim2.new(0.737500012, 0, 0.0949999914, 0)

    UIListLayout_2.Parent = Top
    UIListLayout_2.FillDirection = Enum.FillDirection.Horizontal
    UIListLayout_2.HorizontalAlignment = Enum.HorizontalAlignment.Center
    UIListLayout_2.SortOrder = Enum.SortOrder.LayoutOrder
    UIListLayout_2.VerticalAlignment = Enum.VerticalAlignment.Center

    UICorner.CornerRadius = UDim.new(0, 20)
    UICorner.Parent = Top

    Search.Name = "Search"
    Search.Parent = Top
    Search.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    Search.BackgroundTransparency = 1.000
    Search.BorderColor3 = Color3.fromRGB(0, 0, 0)
    Search.Position = UDim2.new(0.0677966103, 0, 0)
    Search.Size = UDim2.new(0.864406765, 0, 0.81578958, 0)
    Search.Font = Enum.Font.SourceSansBold
    Search.PlaceholderText = "Search/ID"
    Search.Text = ""
    Search.TextColor3 = Color3.fromRGB(255, 255, 255)
    Search.TextScaled = true
    Search.TextSize = 14.000
    Search.TextWrapped = true

    EmoteWalkButton.Name = "EmoteWalkButton"
    EmoteWalkButton.Parent = emotesWheel
    EmoteWalkButton.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    EmoteWalkButton.BackgroundTransparency = 0.400
    EmoteWalkButton.BorderColor3 = Color3.fromRGB(0, 0, 0)
    EmoteWalkButton.BorderSizePixel = 0
    EmoteWalkButton.Position = UDim2.new(0.889999986, 0, -0.107500002, 0)
    EmoteWalkButton.Size = UDim2.new(0.0874999985, 0, 0.0874999985, 0)
    EmoteWalkButton.Image = defaultButtonImage

    UICorner1.CornerRadius = UDim.new(0, 10)
    UICorner1.Parent = EmoteWalkButton

    Favorite.Name = "Favorite"
    Favorite.Parent = emotesWheel
    Favorite.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Favorite.BackgroundTransparency = 0.400
    Favorite.BorderColor3 = Color3.fromRGB(0, 0, 0)
    Favorite.BorderSizePixel = 0
    Favorite.Position = UDim2.new(0.0189999994, 0, -0.108000003, 0)
    Favorite.Size = UDim2.new(0.0874999985, 0, 0.0874999985, 0)
    Favorite.Image = "rbxassetid://124025954365505"

    UICorner2.CornerRadius = UDim.new(0, 10)
    UICorner2.Parent = Favorite

    SpeedBox.Name = "SpeedBox"
    SpeedBox.Parent = emotesWheel
    SpeedBox.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    SpeedBox.BackgroundTransparency = 0.400
    SpeedBox.BorderColor3 = Color3.fromRGB(0, 0, 0)
    SpeedBox.BorderSizePixel = 0
    SpeedBox.Position = UDim2.new(0.0189999398, 0, -0.000499992399, 0)
    SpeedBox.Size = UDim2.new(0.0874999985, 0, 0.0874999985, 0)
    SpeedBox.Visible = false
    SpeedBox.Font = Enum.Font.SourceSansBold
    SpeedBox.PlaceholderColor3 = Color3.fromRGB(178, 178, 178)
    SpeedBox.Text = "1"
    SpeedBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    SpeedBox.TextScaled = true
    SpeedBox.TextWrapped = true
    SpeedBox:GetPropertyChangedSignal("Text"):Connect(function()
       SpeedBox.Text = SpeedBox.Text:gsub("[^%d.]", "")
    end)
    SpeedBox.ZIndex = 2

    UICorner_4.CornerRadius = UDim.new(0, 10)
    UICorner_4.Parent = SpeedBox

    SpeedEmote.Name = "SpeedEmote"
    SpeedEmote.Parent = emotesWheel
    SpeedEmote.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    SpeedEmote.BackgroundTransparency = 0.400
    SpeedEmote.BorderColor3 = Color3.fromRGB(0, 0, 0)
    SpeedEmote.BorderSizePixel = 0
    SpeedEmote.Position = UDim2.new(0.888999999, 0, -0, 0)
    SpeedEmote.Size = UDim2.new(0.0874999985, 0, 0.0874999985, 0)
    SpeedEmote.Image = "rbxassetid://116056570415896"
    SpeedEmote.ZIndex = 2

    UICorner_2.CornerRadius = UDim.new(0, 10)
    UICorner_2.Parent = SpeedEmote

Changepage.Name = "Changepage"
Changepage.Parent = emotesWheel
Changepage.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Changepage.BackgroundTransparency = 0.400
Changepage.BorderColor3 = Color3.fromRGB(0, 0, 0)
Changepage.BorderSizePixel = 0
Changepage.Position = UDim2.new(0.019, 0,1.021, 0)
Changepage.Size = UDim2.new(0.087, 0,0.087, 0)
Changepage.ZIndex = 3
Changepage.Image = "rbxassetid://13285615740"

UICorner_5.CornerRadius = UDim.new(0, 10)
UICorner_5.Parent = Changepage

Reload.Name = "Reload"
Reload.Parent = emotesWheel
Reload.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
Reload.BackgroundTransparency = 0.400
Reload.BorderColor3 = Color3.fromRGB(0, 0, 0)
Reload.BorderSizePixel = 0
Reload.Position = UDim2.new(0.888999999, 0, 1.02100003, 0)
Reload.Size = UDim2.new(0.0869999975, 0, 0.0869999975, 0)
Reload.ZIndex = 3
Reload.Image = "rbxassetid://127493377027615"

UICorner_6.CornerRadius = UDim.new(0, 10)
UICorner_6.Parent = Reload

    loadSpeedEmoteConfig()

    connectEvents()
    isGUICreated = true
    updateGUIColors()
    return true
end

local function updatePageDisplay()
    if _4pages and _2Routenumber then
        _4pages.Text = tostring(totalPages)
        _2Routenumber.Text = tostring(currentPage)
    end
end


local function toggleFavorite(emoteId, emoteName)
    local found = false

    local index = 0

    for i, fav in pairs(favoriteEmotes) do
        if fav.id == emoteId then
            found = true
            index = i
            break
        end
    end

    if found then
        table.remove(favoriteEmotes, index)
        getgenv().Notify({
            Title = '7yd7 | Favorite System',
            Content = 'ðŸ—‘ï¸ Removed "' .. emoteName .. '" from favorites',
            Duration = 3
        })
    else
        table.insert(favoriteEmotes, {
            id = emoteId,
            name = emoteName .. " - â­"
        })
        getgenv().Notify({
            Title = '7yd7 | Favorite System',
            Content = 'âœ… Added "' .. emoteName .. '" to favorites',
            Duration = 3
        })
    end

    saveFavorites()
    totalPages = calculateTotalPages()
    updatePageDisplay()
    updateEmotes()
    updateAllFavoriteIcons()

    task.spawn(function()
        local success, main = pcall(function() 
            return CoreGui.RobloxGui.EmotesMenu.Children.Main 
        end)
        if success and main then
            local timeout = 0
            while main.Visible and timeout < 0.3 do
                timeout = timeout + task.wait()
            end
            game:GetService("GuiService"):SetEmotesMenuOpen(true)
        end
    end)
end


local function toggleFavoriteAnimation(animationData)
    local found = false


    local index = 0

    for i, fav in pairs(favoriteAnimations) do
        if fav.id == animationData.id then
            found = true
            index = i
            break
        end
    end

    if found then
        table.remove(favoriteAnimations, index)
        getgenv().Notify({
            Title = '7yd7 | Favorite System',
            Content = 'ðŸ—‘ï¸ Removed "' .. animationData.name .. '" from favorites',
            Duration = 3
        })
    else
        table.insert(favoriteAnimations, {
            id = animationData.id,
            name = animationData.name .. " - â­",
            bundledItems = animationData.bundledItems
        })
        getgenv().Notify({
            Title = '7yd7 | Favorite System',
            Content = 'âœ… Added "' .. animationData.name .. '" to favorites',
            Duration = 3
        })
    end

    saveFavoritesAnimations()
    totalPages = calculateTotalPages()
    updatePageDisplay()
    updateAnimations()
    updateAllFavoriteIcons()

    task.spawn(function()
        local success, main = pcall(function() 
            return CoreGui.RobloxGui.EmotesMenu.Children.Main 
        end)
        if success and main then
            local timeout = 0
            while main.Visible and timeout < 0.3 do
                timeout = timeout + task.wait()
            end
            task.wait(0.015) 
            game:GetService("GuiService"):SetEmotesMenuOpen(true)
        end
    end)
end


local function setupEmoteClickDetection()
    if isMonitoringClicks then
        return
    end
   
    local function monitorEmotes()
        while favoriteEnabled do
            local success, frontFrame = pcall(function()
                return game:GetService("CoreGui").RobloxGui.EmotesMenu.Children.Main.EmotesWheel.Front.EmotesButtons
            end)
           
            if success and frontFrame then
                for _, connection in pairs(emoteClickConnections) do
                    if connection then
                        connection:Disconnect()
                    end
                end
                emoteClickConnections = {}
               
                for _, child in pairs(frontFrame:GetChildren()) do
                    if child:IsA("ImageLabel") and child.Image ~= "" then
                        local imageUrl = child.Image
                        local assetId = extractAssetId(imageUrl)
                        if assetId then
                            local isFavorite = isInFavorites(assetId)
                            updateFavoriteIcon(child, assetId, isFavorite)
                        end
                    end
                end

            end
           
            task.wait(0.1)
        end
       
        for _, connection in pairs(emoteClickConnections) do
            if connection then
                connection:Disconnect()
            end
        end
        emoteClickConnections = {}
        isMonitoringClicks = false
    end
   
    if favoriteEnabled then
        isMonitoringClicks = true
        task.spawn(monitorEmotes)
    end
end

local function applyAnimation(animationData)
    local player = game.Players.LocalPlayer
    local character = player.Character or player.CharacterAdded:Wait()
    local humanoid = character:FindFirstChild("Humanoid")
    local animate = character:FindFirstChild("Animate")
    
    if not animate or not humanoid then
        getgenv().Notify({
            Title = '7yd7 | Animation Error',
            Content = 'âŒ Animate or Humanoid not found',
            Duration = 3
        })
        return
    end
    
    local bundleId = animationData.id
    local bundledItems = animationData.bundledItems

    getgenv().lastPlayedAnimation = animationData
    
    if not bundledItems then
        getgenv().Notify({
            Title = '7yd7 | Animation Error', 
            Content = 'âŒ No bundled items found',
            Duration = 3
        })
        return
    end
    
    for _, track in pairs(humanoid:GetPlayingAnimationTracks()) do
        track:Stop()
    end
    
    for key, assetIds in pairs(bundledItems) do
        for _, assetId in pairs(assetIds) do
            spawn(function()
                local success, objects = pcall(function()
                    return game:GetObjects("rbxassetid://" .. assetId)
                end)
                
                if success and objects then
                    local function searchForAnimations(parent, parentPath)
                        for _, child in pairs(parent:GetChildren()) do
                            if child:IsA("Animation") then
                                local animationPath = parentPath .. "." .. child.Name
                                local pathParts = animationPath:split(".")
                                
                                if #pathParts >= 2 then
                                    local animateCategory = pathParts[#pathParts - 1]
                                    local animationName = pathParts[#pathParts]
                                    
                                    if animate:FindFirstChild(animateCategory) then
                                        local categoryFolder = animate[animateCategory]
                                        if categoryFolder:FindFirstChild(animationName) then
                                            categoryFolder[animationName].AnimationId = child.AnimationId
                                            
                                            task.wait(0.1)
                                            local animation = Instance.new("Animation")
                                            animation.AnimationId = child.AnimationId
                                            
                                            local animTrack = humanoid.Animator:LoadAnimation(animation)
                                            animTrack.Priority = Enum.AnimationPriority.Action
                                            animTrack:Play()
                                            
                                            task.wait(0.1)
                                            animTrack:Stop()
                                        end
                                    end
                                end
                            elseif #child:GetChildren() > 0 then
                                searchForAnimations(child, parentPath .. "." .. child.Name)
                            end
                        end
                    end
                    
                    for _, obj in pairs(objects) do
                        searchForAnimations(obj, obj.Name)
                        obj.Parent = workspace
                        task.delay(1, function()
                            if obj then obj:Destroy() end
                        end)
                    end
                end
            end)
        end
    end
end

local lastActionTick = 0
local function handleSectorAction(index)
    if tick() - lastActionTick < 0.25 then return end
    lastActionTick = tick()
    
    task.wait(0.05)

    local favoritesToUse = (currentMode == "animation") and (_G.filteredFavoritesAnimationsForDisplay or favoriteAnimations) or (_G.filteredFavoritesForDisplay or favoriteEmotes)
    local hasFavorites = #favoritesToUse > 0
    local favoritePagesCount = hasFavorites and math.ceil(#favoritesToUse / itemsPerPage) or 0
    local isInFavoritesPages = currentPage <= favoritePagesCount

    local function getEmoteAtIndex(idx)
        if isInFavoritesPages and hasFavorites then
            local startIndex = (currentPage - 1) * itemsPerPage + 1
            return favoritesToUse[startIndex + idx - 1]
        else
            local filteredList = (currentMode == "animation") and filteredAnimations or filteredEmotes
            local normalList = {}
            for _, item in pairs(filteredList) do
                if not isInFavorites(item.id) then
                    table.insert(normalList, item)
                end
            end
            local adjustedPage = currentPage - favoritePagesCount
            local startIndex = (adjustedPage - 1) * itemsPerPage + 1
            return normalList[startIndex + idx - 1]
        end
    end

    local itemData = getEmoteAtIndex(index)
    if not itemData then return end

    lastRadialActionTime = tick()


    if favoriteEnabled then
        if currentMode == "animation" then
            toggleFavoriteAnimation(itemData)
        else
            toggleFavorite(itemData.id, itemData.name)
        end
        
        task.spawn(function()

            local success, main = pcall(function() 
                return CoreGui.RobloxGui.EmotesMenu.Children.Main 
            end)
            if success and main then
                local timeout = 0
                while main.Visible and timeout < 0.3 do
                    timeout = timeout + task.wait()
                end
                task.wait(0.015) 
                game:GetService("GuiService"):SetEmotesMenuOpen(true)
            end
        end)

    else
        if currentMode == "animation" then
            applyAnimation(itemData)
        else
            local _, hum = getCharacterAndHumanoid()
            if hum then
                playEmote(hum, itemData.id)
            end
        end
    end

end


local function monitorAnimations()
    while currentMode == "animation" do
        local success, frontFrame = pcall(function()
            return game:GetService("CoreGui").RobloxGui.EmotesMenu.Children.Main.EmotesWheel.Front.EmotesButtons
        end)
        
        if success and frontFrame then
            for _, connection in pairs(emoteClickConnections) do
                if connection then
                    connection:Disconnect()
                end
            end
            emoteClickConnections = {}
            
            local favoritesToUse = _G.filteredFavoritesAnimationsForDisplay or favoriteAnimations
            local hasFavorites = #favoritesToUse > 0
            local favoritePagesCount = hasFavorites and math.ceil(#favoritesToUse / itemsPerPage) or 0
            local isInFavoritesPages = currentPage <= favoritePagesCount
            
            local currentPageAnimations = {}
            
            if isInFavoritesPages and hasFavorites then
                local startIndex = (currentPage - 1) * itemsPerPage + 1
                local endIndex = math.min(startIndex + itemsPerPage - 1, #favoritesToUse)
                
                for i = startIndex, endIndex do
                    if favoritesToUse[i] then
                        table.insert(currentPageAnimations, favoritesToUse[i])
                    end
                end
            else
                local normalAnimations = {}
                for _, animation in pairs(filteredAnimations) do
                    if not isInFavorites(animation.id) then
                        table.insert(normalAnimations, animation)
                    end
                end
                
                local adjustedPage = currentPage - favoritePagesCount
                local startIndex = (adjustedPage - 1) * itemsPerPage + 1
                local endIndex = math.min(startIndex + itemsPerPage - 1, #normalAnimations)
                
                for i = startIndex, endIndex do
                    if normalAnimations[i] then
                        table.insert(currentPageAnimations, normalAnimations[i])
                    end
                end
            end
            
            local buttonIndex = 1
            for _, child in pairs(frontFrame:GetChildren()) do
                if child:IsA("ImageLabel") then
                    if buttonIndex <= #currentPageAnimations then
                        local animationData = currentPageAnimations[buttonIndex]
                        
                        if favoriteEnabled then
                            local isFavorite = isInFavorites(animationData.id)
                            updateFavoriteIcon(child, animationData.id, isFavorite)
                        else
                            local favoriteIcon = child:FindFirstChild("FavoriteIcon")
                            if favoriteIcon then
                                favoriteIcon:Destroy()
                            end
                        end
                        buttonIndex = buttonIndex + 1
                    else
                        local favoriteIcon = child:FindFirstChild("FavoriteIcon")
                        if favoriteIcon then
                            favoriteIcon:Destroy()
                        end
                    end
                end
            end

        end
        
        task.wait(0.1)
    end
end

local function stopEmoteClickDetection()
    isMonitoringClicks = false
    
    for _, connection in pairs(emoteClickConnections) do
        if connection then
            connection:Disconnect()
        end
    end
    emoteClickConnections = {}
    
    local success, frontFrame = pcall(function()
        return game:GetService("CoreGui").RobloxGui.EmotesMenu.Children.Main.EmotesWheel.Front.EmotesButtons
    end)
    
    if success and frontFrame then
        for _, child in pairs(frontFrame:GetChildren()) do
            if child:IsA("ImageLabel") then
                local clickDetector = child:FindFirstChild("ClickDetector")
                if clickDetector then
                    clickDetector:Destroy()
                end
                
                local favoriteIcon = child:FindFirstChild("FavoriteIcon")
                if favoriteIcon then
                    favoriteIcon:Destroy()
                end
            end
        end
    end
end


local function fetchAllEmotes()
    if isLoading then
        return
    end
    isLoading = true
    emotesData = {}
    totalEmotesLoaded = 0

    local success, result = pcall(function()
        local jsonContent = game:HttpGet("https://raw.githubusercontent.com/7yd7/sniper-Emote/refs/heads/test/EmoteSniper.json")
        
        if jsonContent and jsonContent ~= "" then
            local data = HttpService:JSONDecode(jsonContent)
            return data.data or {}
        else
            return nil
        end
    end)

    if success and result then
        for _, item in pairs(result) do
            local emoteData = {
                id = tonumber(item.id),
                name = item.name or ("Emote_" .. (item.id or "Unknown"))
            }
            if emoteData.id and emoteData.id > 0 then
                table.insert(emotesData, emoteData)
                totalEmotesLoaded = totalEmotesLoaded + 1
            end
        end
    else
        emotesData = {
            {id = 3360686498, name = "Stadium"},
            {id = 3360692915, name = "Tilt"},
            {id = 3576968026, name = "Shrug"},
            {id = 3360689775, name = "Salute"}
        }
        totalEmotesLoaded = #emotesData
    end

    originalEmotesData = emotesData
    filteredEmotes = emotesData

    totalPages = calculateTotalPages()
    currentPage = 1
    updatePageDisplay()
    updateEmotes()
    
    getgenv().Notify({
        Title = '7yd7 | Emote',
        Content = "ðŸŽ‰ Loaded Successfully! Total Emotes: " .. totalEmotesLoaded,
        Duration = 5
    })
    
    isLoading = false
end

local function fetchAllAnimations()
    if isLoading then
        return
    end
    isLoading = true
    animationsData = {}
    
    local success, result = pcall(function()
        local jsonContent = game:HttpGet("https://raw.githubusercontent.com/7yd7/sniper-Emote/refs/heads/test/AnimationSniper.json")
        
        if jsonContent and jsonContent ~= "" then
            local data = HttpService:JSONDecode(jsonContent)
            return data.data or {}
        else
            return nil
        end
    end)

    if success and result then
        for _, item in pairs(result) do
            local animationData = {
                id = tonumber(item.id),
                name = item.name or ("Animation_" .. (item.id or "Unknown")),
                bundledItems = item.bundledItems
            }
            if animationData.id and animationData.id > 0 then
                table.insert(animationsData, animationData)
            end
        end
    end

    originalAnimationsData = animationsData
    filteredAnimations = animationsData
    isLoading = false
end

local function searchEmotes(searchTerm)
    if isLoading then
        getgenv().Notify({
            Title = '7yd7 | Emote',
            Content = 'âš ï¸ Loading please wait...',
            Duration = 5
        })
        return
    end

    searchTerm = searchTerm:lower()

    if searchTerm == "" then
        filteredEmotes = originalEmotesData
        if _G.originalFavoritesBackup then
            _G.originalFavoritesBackup = nil
        end
        _G.filteredFavoritesForDisplay = nil
    else
        local isIdSearch = searchTerm:match("^%d%d%d%d%d+$")
        
        local newFilteredList = {}
        
        if isIdSearch then
            for _, emote in pairs(originalEmotesData) do
                if tostring(emote.id) == searchTerm then
                    table.insert(newFilteredList, emote)
                end
            end
            
            if #newFilteredList == 0 then
                local emoteId = tonumber(searchTerm)
                if emoteId then
                    local emoteName = getEmoteName(emoteId)
                    local newEmote = {
                        id = emoteId,
                        name = emoteName
                    }
                    
                    table.insert(originalEmotesData, newEmote)
                    table.insert(newFilteredList, newEmote)
                end
            end
        else
            for _, emote in pairs(originalEmotesData) do
                if emote.name:lower():find(searchTerm) then
                    table.insert(newFilteredList, emote)
                end
            end
        end
        
        filteredEmotes = newFilteredList

        if not isIdSearch then
            if not _G.originalFavoritesBackup then
                _G.originalFavoritesBackup = {}
                for i, favorite in pairs(favoriteEmotes) do
                    _G.originalFavoritesBackup[i] = {
                        id = favorite.id,
                        name = favorite.name
                    }
                end
            end

            _G.filteredFavoritesForDisplay = {}
            for _, favorite in pairs(favoriteEmotes) do
                if favorite.name:lower():find(searchTerm) then
                    table.insert(_G.filteredFavoritesForDisplay, favorite)
                end
            end
        end
    end

    totalPages = calculateTotalPages()
    currentPage = 1
    updatePageDisplay()
    updateEmotes()
end

local function searchAnimations(searchTerm)
    if isLoading then
        getgenv().Notify({
            Title = '7yd7 | Animation',
            Content = 'âš ï¸ Loading please wait...',
            Duration = 5
        })
        return
    end

    searchTerm = searchTerm:lower()

    if searchTerm == "" then
        filteredAnimations = originalAnimationsData
        if _G.originalAnimationFavoritesBackup then
            _G.originalAnimationFavoritesBackup = nil
        end
        _G.filteredFavoritesAnimationsForDisplay = nil
    else
        local isIdSearch = searchTerm:match("^%d+$")
        
        local newFilteredList = {}
        
        if isIdSearch then
            for _, animation in pairs(originalAnimationsData) do
                if tostring(animation.id) == searchTerm then
                    table.insert(newFilteredList, animation)
                end
            end
        else
            for _, animation in pairs(originalAnimationsData) do
                if animation.name:lower():find(searchTerm) then
                    table.insert(newFilteredList, animation)
                end
            end
        end
        
        filteredAnimations = newFilteredList

        if not isIdSearch then
            if not _G.originalAnimationFavoritesBackup then
                _G.originalAnimationFavoritesBackup = {}
                for i, favorite in pairs(favoriteAnimations) do
                    _G.originalAnimationFavoritesBackup[i] = {
                        id = favorite.id,
                        name = favorite.name,
                        bundledItems = favorite.bundledItems
                    }
                end
            end

            _G.filteredFavoritesAnimationsForDisplay = {}
            for _, favorite in pairs(favoriteAnimations) do
                if favorite.name:lower():find(searchTerm) then
                    table.insert(_G.filteredFavoritesAnimationsForDisplay, favorite)
                end
            end
        end
    end

    totalPages = calculateTotalPages()
    currentPage = 1
    updatePageDisplay()
    updateAnimations()
end

local function goToPage(pageNumber)
    if pageNumber < 1 then
        currentPage = 1
    elseif pageNumber > totalPages then
        currentPage = totalPages
    else
        currentPage = pageNumber
    end
    updatePageDisplay()
    updateEmotes()
end

local function previousPage()
    if currentPage <= 1 then
        currentPage = totalPages
    else
        currentPage = currentPage - 1
    end
    updatePageDisplay()
    updateEmotes()
end

local function nextPage()
    if currentPage >= totalPages then
        currentPage = 1
    else
        currentPage = currentPage + 1
    end
    updatePageDisplay()
    updateEmotes()
end

local function stopCurrentEmote()
    if currentEmoteTrack then
        currentEmoteTrack:Stop()
        currentEmoteTrack = nil
    end
end

local function playEmote(humanoid, emoteId)
    stopCurrentEmote()
    stopEmotes()

    local animation = Instance.new("Animation")
    animation.AnimationId = "rbxassetid://" .. emoteId

    local success, animTrack = pcall(function()
        return humanoid.Animator:LoadAnimation(animation)
    end)

    if success and animTrack then
        currentEmoteTrack = animTrack
        currentEmoteTrack.Priority = Enum.AnimationPriority.Action
        currentEmoteTrack.Looped = true
        task.wait(0.1)
        if speedEmoteEnabled or emotesWalkEnabled then
            currentEmoteTrack:Play()

            if speedEmoteEnabled then
                local speedValue = tonumber(SpeedBox.Text) or 1
                currentEmoteTrack:AdjustSpeed(speedValue)
            end
        end
    end
end

local function onCharacterAdded(character)
    currentCharacter = character
    stopCurrentEmote()

    local humanoid = character:WaitForChild("Humanoid")
    local animator = humanoid:WaitForChild("Animator")

 if getgenv().autoReloadEnabled and getgenv().lastPlayedAnimation then
    task.wait(.3)
    applyAnimation(getgenv().lastPlayedAnimation)
    getgenv().Notify({
        Title = '7yd7 | Auto Reload Animation',
        Content = 'ðŸ”„ The last animation was automatically \n reapplied',
        Duration = 3
    })
end

    animator.AnimationPlayed:Connect(function(animationTrack)
        if isDancing(character, animationTrack) then
            local playedEmoteId = urlToId(animationTrack.Animation.AnimationId)

            if emotesWalkEnabled then
                if currentEmoteTrack then
                    local currentEmoteId = urlToId(currentEmoteTrack.Animation.AnimationId)
                    if currentEmoteId == playedEmoteId then
                        return
                    else
                        stopCurrentEmote()
                    end
                end

                playEmote(humanoid, playedEmoteId)

                if currentEmoteTrack then
                    currentEmoteTrack.Ended:Connect(function()
                        if currentEmoteTrack == animationTrack then
                            currentEmoteTrack = nil
                        end
                    end)
                end
            end

            if speedEmoteEnabled and not emotesWalkEnabled then
                if currentEmoteTrack then
                    local currentEmoteId = urlToId(currentEmoteTrack.Animation.AnimationId)
                    if currentEmoteId == playedEmoteId then
                        return
                    else
                        stopCurrentEmote()
                    end
                end

                playEmote(humanoid, playedEmoteId)

                if currentEmoteTrack then
                    currentEmoteTrack.Ended:Connect(function()
                        if currentEmoteTrack == animationTrack then
                            currentEmoteTrack = nil
                        end
                    end)
                end
            end
        end
    end)

    humanoid.Died:Connect(function()
    emotesWalkEnabled = false
    speedEmoteEnabled = false
    favoriteEnabled = false
    currentEmoteTrack = nil

    stopEmotes()
        stopCurrentEmote()
    end)
end

local function toggleEmoteWalk()
    emotesWalkEnabled = not emotesWalkEnabled

    if emotesWalkEnabled then
        getgenv().Notify({
            Title = '7yd7 | Emote Freeze',
            Content = "ðŸ”’ Emote freeze ON",
            Duration = 5
        })

        EmoteWalkButton.Image = enabledButtonImage
        task.wait(0.1)
        stopCurrentEmote()
        if currentEmoteTrack and currentEmoteTrack.IsPlaying then
            currentEmoteTrack:AdjustSpeed(1)
        end
    else
        getgenv().Notify({
            Title = '7yd7 | Emote Freeze',
            Content = 'ðŸ”“ Emote freeze OFF',
            Duration = 5
        })
        EmoteWalkButton.Image = defaultButtonImage
        task.wait(0.1)
        stopCurrentEmote()

        if currentEmoteTrack and currentEmoteTrack.IsPlaying and speedEmoteEnabled then
            local speedValue = tonumber(SpeedBox.Text) or 1
            currentEmoteTrack:AdjustSpeed(speedValue)
        elseif currentEmoteTrack and currentEmoteTrack.IsPlaying then
            currentEmoteTrack:AdjustSpeed(1)
        end
    end
end
print(Players.LocalPlayer.Name)
local function toggleSpeedEmote()
    speedEmoteEnabled = not speedEmoteEnabled

    SpeedBox.Visible = speedEmoteEnabled

    if speedEmoteEnabled then
        getgenv().Notify({
            Title = '7yd7 | Speed Emote',
            Content = "âš¡ Speed Emote ON",
            Duration = 5
        })
        task.wait(0.1)
        stopCurrentEmote()
    else
        getgenv().Notify({
            Title = '7yd7 | Speed Emote',
            Content = 'âš¡ Speed Emote OFF',
            Duration = 5
        })
        task.wait(0.1)
        stopCurrentEmote()
    end

    if writefile then
        writefile(speedEmoteConfigFile, HttpService:JSONEncode({
            Enabled = speedEmoteEnabled,
            SpeedValue = tonumber(SpeedBox.Text) or 1
        }))
    end
end

local function toggleFavoriteMode()
    favoriteEnabled = not favoriteEnabled

    if favoriteEnabled then
        Favorite.Image = "rbxassetid://97307461910825"
        getgenv().Notify({
            Title = '7yd7 | Favorite System',
            Content = "ðŸ”’ Favorite ON",
            Duration = 5
        })

        if currentMode == "emote" then
            setupEmoteClickDetection()
        else 
            updateAllFavoriteIcons()
        end
    else
        Favorite.Image = "rbxassetid://124025954365505"
        getgenv().Notify({
            Title = '7yd7 | Favorite System',
            Content = 'ðŸ”“ Favorite OFF',
            Duration = 3
        })
        
        if currentMode == "emote" then
            stopEmoteClickDetection()
        else
            updateAllFavoriteIcons()
        end
    end
end

local clickCooldown = {}
local CLICK_COOLDOWN_TIME = 0.1

local function safeButtonClick(buttonName, callback)
    local currentTime = tick()
    if not clickCooldown[buttonName] or (currentTime - clickCooldown[buttonName]) > CLICK_COOLDOWN_TIME then
        clickCooldown[buttonName] = currentTime
        callback()
    end
end

local function setupAnimationClickDetection()
    if isMonitoringClicks then
        return
    end
    
    if currentMode == "animation" then
        isMonitoringClicks = true
        task.spawn(monitorAnimations)
    end
end

local function toggleAutoReload()
    getgenv().autoReloadEnabled = not getgenv().autoReloadEnabled
    
    if getgenv().autoReloadEnabled then
        getgenv().Notify({
            Title = '7yd7 | Auto Reload Animation',
            Content = "ðŸ”„ Auto Reload ON",
            Duration = 5
        })
    else
        getgenv().Notify({
            Title = '7yd7 | Auto Reload Animation',
            Content = 'ðŸ”„ Auto Reload OFF',
            Duration = 3
        })
    end
end

function connectEvents()
    if _1left then
        _1left.MouseButton1Click:Connect(previousPage)
    end

    if _9right then
        _9right.MouseButton1Click:Connect(nextPage)
    end

      if _2Routenumber then
        _2Routenumber.FocusLost:Connect(function(enterPressed)
            local pageNum = tonumber(_2Routenumber.Text)
            if pageNum then
                goToPage(pageNum)
            else
                _2Routenumber.Text = tostring(currentPage)
            end
        end)
    end

    if Search then
        Search.Changed:Connect(function(property)
            if property == "Text" then
                if currentMode == "emote" then
                    emoteSearchTerm = Search.Text
                    searchEmotes(emoteSearchTerm)
                else
                    animationSearchTerm = Search.Text
                    searchAnimations(animationSearchTerm)
                end
            end
        end)
    end

    local SECTOR_COUNT = 8
    local SECTOR_ANGLE = 360 / SECTOR_COUNT
    local DEADZONE_RADIUS = 25

    UserInputService.InputBegan:Connect(function(input, gameProcessed)
        if input.UserInputType ~= Enum.UserInputType.MouseButton1 then return end
        
        if not (favoriteEnabled or currentMode == "animation") then return end

        local exists, emotesWheel = checkEmotesMenuExists()
        if not (exists and emotesWheel.Visible) then return end
        
        local mouseLocation = UserInputService:GetMouseLocation()
        local topBarInset = game:GetService("GuiService"):GetGuiInset()
        local actualMousePos = mouseLocation - topBarInset

        local absPos = emotesWheel.AbsolutePosition
        local absSize = emotesWheel.AbsoluteSize

        local inXBounds = (actualMousePos.X >= absPos.X) and (actualMousePos.X <= absPos.X + absSize.X)
        local inYBounds = (actualMousePos.Y >= absPos.Y) and (actualMousePos.Y <= absPos.Y + absSize.Y)
        if not (inXBounds and inYBounds) then return end

        local center = absPos + (absSize / 2)
        local dx = actualMousePos.X - center.X
        local dy = actualMousePos.Y - center.Y

        local distance = math.sqrt(dx*dx + dy*dy)
        if distance < DEADZONE_RADIUS then return end

        local angle = math.deg(math.atan2(dy, dx))
        local correctedAngle = (angle + 90 + (SECTOR_ANGLE / 2)) % 360
        local index = math.floor(correctedAngle / SECTOR_ANGLE) + 1
        
        handleSectorAction(index)
    end)



    if EmoteWalkButton then
        EmoteWalkButton.MouseButton1Click:Connect(function()
            safeButtonClick("EmoteWalk", toggleEmoteWalk)
        end)
    end

    if Favorite then
        Favorite.MouseButton1Click:Connect(function()
            safeButtonClick("Favorite", toggleFavoriteMode)
        end)
    end

    if SpeedEmote then
        SpeedEmote.MouseButton1Click:Connect(function()
            safeButtonClick("SpeedEmote", toggleSpeedEmote)
        end)
    end

    if Reload then
    Reload.MouseButton1Click:Connect(function()
        safeButtonClick("AutoReload", toggleAutoReload)
    end)
end

if Changepage then
    Changepage.MouseButton1Click:Connect(function()
        stopEmoteClickDetection()
        
        if currentMode == "emote" then
            currentMode = "animation"
            
            spawn(function()
                fetchAllAnimations()
                Search.Text = animationSearchTerm
                currentPage = 1
                totalPages = calculateTotalPages()
                updatePageDisplay()
                updateEmotes()
                isMonitoringClicks = true
                task.spawn(monitorAnimations)
            end)
            
            getgenv().Notify({
                Title = '7yd7 | Animation',
                Content = 'ðŸ“„ Changed to Emote > Animation Mode',
                Duration = 3
            })

        else
            currentMode = "emote"
            Search.Text = emoteSearchTerm
            currentPage = 1
            totalPages = calculateTotalPages()
            updatePageDisplay() 
            updateEmotes()
            
            if favoriteEnabled then
                setupEmoteClickDetection()
            end
            
            getgenv().Notify({
                Title = '7yd7 | Emote', 
                Content = 'ðŸ“„ Changed to Animation > Emote Mode',
                Duration = 3
            })
        end
    end)
end

    if SpeedBox then
        SpeedBox.FocusLost:Connect(function()
            if writefile then
                writefile(speedEmoteConfigFile, HttpService:JSONEncode({
                    Enabled = speedEmoteEnabled,
                    SpeedValue = tonumber(SpeedBox.Text) or 1
                }))
            end
        end)
    end
end

local function checkAndRecreateGUI()
    local exists, emotesWheel = checkEmotesMenuExists()
    if not exists then
        isGUICreated = false
        return
    end

    if not emotesWheel:FindFirstChild("Under") or not emotesWheel:FindFirstChild("Top") or
        not emotesWheel:FindFirstChild("EmoteWalkButton") or not emotesWheel:FindFirstChild("Favorite") or
        not emotesWheel:FindFirstChild("SpeedEmote") or not emotesWheel:FindFirstChild("SpeedBox") or
        not emotesWheel:FindFirstChild("Changepage") or not emotesWheel:FindFirstChild("Reload") then
        isGUICreated = false
        if createGUIElements() then
            updatePageDisplay()
            updateEmotes()
            loadSpeedEmoteConfig()
        end
    end
end

if player.Character then
    onCharacterAdded(player.Character)
end

player.CharacterAdded:Connect(function(character)
    onCharacterAdded(character)
    task.wait(0.3) 
    spawn(function()
        while not checkEmotesMenuExists() do
            task.wait(0.1) 
        end
        task.wait(0.3) 
        stopEmotes()
        if createGUIElements() then
            if #emotesData > 0 then
                updatePageDisplay()
                updateEmotes()
                loadSpeedEmoteConfig()
            end
        end
    end)
end)

player.CharacterAdded:Connect(function(newChar)
    character = newChar
    humanoid = newChar:WaitForChild("Humanoid")
    emotesWalkEnabled = false
    speedEmoteEnabled = false
    favoriteEnabled = false
    currentEmoteTrack = nil
    stopEmotes()
end)


local heartbeatConnection = RunService.Heartbeat:Connect(function()
    if not isGUICreated then
        checkAndRecreateGUI()
    else
        updateGUIColors()
    end
end)


local function safeFind(path, name)
    if not path then return nil end
    local ok, result = pcall(function()
        return path:FindFirstChild(name)
    end)
    if ok then
        return result
    end
    return nil
end

RunService.Stepped:Connect(function()
    if humanoid and currentEmoteTrack and currentEmoteTrack.IsPlaying then
        if humanoid.MoveDirection.Magnitude > 0 then
            if speedEmoteEnabled and not emotesWalkEnabled then
                currentEmoteTrack:Stop()
                currentEmoteTrack = nil
            end
        end
    end
end)

spawn(function()
    while not checkEmotesMenuExists() do
        wait(0.1)
    end
    if createGUIElements() then
        loadFavorites()
        loadFavoritesAnimations()
        fetchAllEmotes()
        loadSpeedEmoteConfig()
    end
end)
 local StarterGui = game:GetService("StarterGui")

 StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.Chat, true)
task.spawn(function()
    local StarterGui = game:GetService("StarterGui")
    local CoreGui = game:GetService("CoreGui")

    while true do
        local robloxGui = CoreGui:FindFirstChild("RobloxGui")
        local emotesMenu = robloxGui and robloxGui:FindFirstChild("EmotesMenu")

        if not emotesMenu then
            StarterGui:SetCoreGuiEnabled(Enum.CoreGuiType.EmotesMenu, true)

        else
            local exists = emotesMenu:FindFirstChild("Children") and emotesMenu.Children:FindFirstChild("Main") and
                               emotesMenu.Children.Main:FindFirstChild("EmotesWheel")

            if exists then
                local emotesWheel = emotesMenu.Children.Main.EmotesWheel
                if not emotesWheel:FindFirstChild("Under") or not emotesWheel:FindFirstChild("Top") then
                    if createGUIElements then
                        createGUIElements()
                        loadSpeedEmoteConfig()
                    end

                    if updateGUIColors then
                        updateGUIColors()
                        updatePageDisplay()
                        loadFavorites()
                    end
                end
            end
        end

        task.wait(.3)
    end
end)

if UserInputService.TouchEnabled and not UserInputService.KeyboardEnabled then
    loadstring(game:HttpGet("https://raw.githubusercontent.com/7yd7/Hub/refs/heads/Branch/GUIS/OpenEmote.lua"))()
    getgenv().Notify({
        Title = 'KIKO | Emote Mobile',
        Content = 'ðŸ“± Added emote open button for ease of use',
        Duration = 10
    })
end

if UserInputService.KeyboardEnabled then
    getgenv().Notify({
        Title = 'KIKO | Emote PC',
        Content = 'ðŸ’» Open menu press button "."',
        Duration = 10
    })
end]],
	["Trip"] = [[-- KzK SLIP Script - COMPACT VERSION
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local player = Players.LocalPlayer

-- Settings
local power = 50
local speed = 1
local keybind = Enum.KeyCode.Q

-- CUSTOM LOGO ASSET ID - CHANGE THIS!
local CUSTOM_LOGO_ID = "rbxassetid://121639913593521"  -- Replace with your own!

-- Create or get RemoteEvent for server communication (optional for replication)
local tripEvent = ReplicatedStorage:FindFirstChild("TripEvent")
if not tripEvent then
    tripEvent = Instance.new("RemoteEvent")
    tripEvent.Name = "TripEvent"
    tripEvent.Parent = ReplicatedStorage
end

-- ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TripGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- === COMPACT MAIN FRAME ===
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 180, 0, 190)  -- Smaller size
frame.Position = UDim2.new(1, -190, 0, 10)
frame.BackgroundColor3 = Color3.fromRGB(10, 10, 20)
frame.BackgroundTransparency = 0.3
frame.BorderSizePixel = 0
frame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 10)
corner.Parent = frame

-- === SMALL CUSTOM LOGO (Top Left Inside UI) ===
local logo = Instance.new("ImageLabel")
logo.Name = "CustomLogo"
logo.Size = UDim2.new(0, 35, 0, 35)
logo.Position = UDim2.new(0, 8, 0, 6)
logo.BackgroundTransparency = 1
logo.BorderSizePixel = 0  -- No border
logo.Image = CUSTOM_LOGO_ID
logo.ZIndex = 5
logo.Parent = frame

-- Stars Background
local starsBackground = Instance.new("Frame")
starsBackground.Size = UDim2.new(1, 0, 1, 0)
starsBackground.BackgroundColor3 = Color3.fromRGB(0, 0, 15)
starsBackground.BackgroundTransparency = 1

starsBackground.ZIndex = 0
starsBackground.Parent = frame

local stars = {}
for i = 1, 20 do
    local star = Instance.new("Frame")
    star.Size = UDim2.new(0, 2, 0, 2)
    star.BackgroundColor3 = Color3.fromRGB(100, 180, 255)
    star.BorderSizePixel = 0
    star.Position = UDim2.new(math.random(), 0, math.random(), 0)
    star.Parent = starsBackground
    star:SetAttribute("Speed", math.random(50, 150) / 100)
    table.insert(stars, star)
end

RunService.RenderStepped:Connect(function(delta)
    for _, star in ipairs(stars) do
        local speed = star:GetAttribute("Speed")
        local newX = star.Position.X.Scale - (0.4 * speed * delta)
        if newX < 0 then
            newX = 1 + newX
            star.Position = UDim2.new(newX, 0, math.random(), 0)
        else
            star.Position = UDim2.new(newX, 0, star.Position.Y.Scale, 0)
        end
    end
end)

-- Title (next to logo)
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -60, 0, 25)
title.Position = UDim2.new(0, 50, 0, 8)
title.BackgroundTransparency = 1
title.Text = "TRIP"
title.TextColor3 = Color3.fromRGB(100, 180, 255)
title.TextSize = 14
title.Font = Enum.Font.GothamBold
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = frame

-- Close Button
local closeButton = Instance.new("TextButton")
closeButton.Size = UDim2.new(0, 22, 0, 22)
closeButton.Position = UDim2.new(1, -28, 0, 6)
closeButton.BackgroundTransparency = 1
closeButton.Text = "X"
closeButton.TextColor3 = Color3.fromRGB(255, 100, 100)
closeButton.TextSize = 16
closeButton.Font = Enum.Font.GothamBold
closeButton.Parent = frame
closeButton.MouseButton1Click:Connect(function() screenGui:Destroy() end)

-- Speed Slider (Compact)
local speedLabel = Instance.new("TextLabel")
speedLabel.Size = UDim2.new(1, -20, 0, 16)
speedLabel.Position = UDim2.new(0, 10, 0, 38)
speedLabel.BackgroundTransparency = 1
speedLabel.Text = "Speed: " .. string.format("%.1f", speed)
speedLabel.TextColor3 = Color3.fromRGB(200, 220, 255)
speedLabel.TextSize = 11
speedLabel.Font = Enum.Font.Gotham
speedLabel.TextXAlignment = Enum.TextXAlignment.Left
speedLabel.Parent = frame

local speedTrack = Instance.new("Frame")
speedTrack.Size = UDim2.new(1, -30, 0, 7)
speedTrack.Position = UDim2.new(0, 15, 0, 56)
speedTrack.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
speedTrack.Active = true  -- Prevent click-through
speedTrack.Parent = frame

local tc = Instance.new("UICorner")
tc.CornerRadius = UDim.new(1, 0)
tc.Parent = speedTrack

local speedFill = Instance.new("Frame")
speedFill.Size = UDim2.new(0.2, 0, 1, 0)
speedFill.BackgroundColor3 = Color3.fromRGB(60, 120, 255)
speedFill.Parent = speedTrack

local fc = Instance.new("UICorner")
fc.CornerRadius = UDim.new(1, 0)
fc.Parent = speedFill

local speedKnob = Instance.new("TextButton")  -- Changed to TextButton
speedKnob.Size = UDim2.new(0, 14, 0, 14)
speedKnob.Position = UDim2.new(0.2, -7, 0, -3.5)
speedKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
speedKnob.Text = ""
speedKnob.Active = true  -- Prevent click-through
speedKnob.Parent = speedTrack

local kc = Instance.new("UICorner")
kc.CornerRadius = UDim.new(1, 0)
kc.Parent = speedKnob

-- Power Slider (Compact)
local powerLabel = Instance.new("TextLabel")
powerLabel.Size = UDim2.new(1, -20, 0, 16)
powerLabel.Position = UDim2.new(0, 10, 0, 72)
powerLabel.BackgroundTransparency = 1
powerLabel.Text = "Power: " .. power
powerLabel.TextColor3 = Color3.fromRGB(200, 220, 255)
powerLabel.TextSize = 11
powerLabel.Font = Enum.Font.Gotham
powerLabel.TextXAlignment = Enum.TextXAlignment.Left
powerLabel.Parent = frame

local powerTrack = Instance.new("Frame")
powerTrack.Size = UDim2.new(1, -30, 0, 7)
powerTrack.Position = UDim2.new(0, 15, 0, 90)
powerTrack.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
powerTrack.Active = true  -- Prevent click-through
powerTrack.Parent = frame

local pc = Instance.new("UICorner")
pc.CornerRadius = UDim.new(1, 0)
pc.Parent = powerTrack

local powerFill = Instance.new("Frame")
powerFill.Size = UDim2.new(0.5, 0, 1, 0)
powerFill.BackgroundColor3 = Color3.fromRGB(60, 120, 255)
powerFill.Parent = powerTrack

local pfc = Instance.new("UICorner")
pfc.CornerRadius = UDim.new(1, 0)
pfc.Parent = powerFill

local powerKnob = Instance.new("TextButton")  -- Changed to TextButton
powerKnob.Size = UDim2.new(0, 14, 0, 14)
powerKnob.Position = UDim2.new(0.5, -7, 0, -3.5)
powerKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
powerKnob.Text = ""
powerKnob.Active = true  -- Prevent click-through
powerKnob.Parent = powerTrack

local pkc = Instance.new("UICorner")
pkc.CornerRadius = UDim.new(1, 0)
pkc.Parent = powerKnob

-- TRIP Button (Smaller)
local tripButton = Instance.new("TextButton")
tripButton.Size = UDim2.new(1, -30, 0, 26)
tripButton.Position = UDim2.new(0, 15, 1, -70)
tripButton.BackgroundColor3 = Color3.fromRGB(60, 120, 255)
tripButton.Text = "TRIP!"
tripButton.TextColor3 = Color3.fromRGB(255, 255, 255)
tripButton.TextSize = 13
tripButton.Font = Enum.Font.GothamBold
tripButton.Parent = frame

local tripC = Instance.new("UICorner")
tripC.CornerRadius = UDim.new(0, 6)
tripC.Parent = tripButton

-- Keybind (Compact)
local keybindLabel = Instance.new("TextLabel")
keybindLabel.Size = UDim2.new(1, -20, 0, 16)
keybindLabel.Position = UDim2.new(0, 10, 0, 105)
keybindLabel.BackgroundTransparency = 1
keybindLabel.Text = "Keybind: " .. keybind.Name
keybindLabel.TextColor3 = Color3.fromRGB(200, 220, 255)
keybindLabel.TextSize = 11
keybindLabel.Font = Enum.Font.Gotham
keybindLabel.TextXAlignment = Enum.TextXAlignment.Left
keybindLabel.Parent = frame

local keybindButton = Instance.new("TextButton")
keybindButton.Size = UDim2.new(1, -30, 0, 22)
keybindButton.Position = UDim2.new(0, 15, 0, 125)
keybindButton.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
keybindButton.Text = "Change key"
keybindButton.TextColor3 = Color3.fromRGB(180, 220, 255)
keybindButton.TextSize = 10
keybindButton.Font = Enum.Font.Gotham
keybindButton.Parent = frame

local kbC = Instance.new("UICorner")
kbC.CornerRadius = UDim.new(0, 5)
kbC.Parent = keybindButton

-- Draggable (Fixed to not interfere with sliders)
local frameDragging = false
local dragInput, mousePos, framePos

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        frameDragging = true
        mousePos = input.Position
        framePos = frame.Position
    end
end)

frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then 
        frameDragging = false 
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if frameDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - mousePos
        frame.Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + delta.X, framePos.Y.Scale, framePos.Y.Offset + delta.Y)
    end
end)

-- Fixed Slider Logic - Completely isolated from frame dragging
local function makeSlider(knob, track, fill, label, minVal, maxVal, initial, isPower)
    local sliderDragging = false
    
    knob.MouseButton1Down:Connect(function()
        sliderDragging = true
    end)
    
    knob.MouseButton1Up:Connect(function()
        sliderDragging = false
    end)
    
    knob.MouseLeave:Connect(function()
        sliderDragging = false
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if sliderDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local relX = math.clamp(input.Position.X - track.AbsolutePosition.X, 0, track.AbsoluteSize.X)
            local percent = relX / track.AbsoluteSize.X
            knob.Position = UDim2.new(0, relX - 7, 0, -3.5)
            fill.Size = UDim2.new(percent, 0, 1, 0)
            local val = isPower and math.floor(percent * (maxVal - minVal) + minVal) or math.round(percent * 49 + 1)/10
            if isPower then 
                power = val
                label.Text = "Power: " .. val
            else 
                speed = val
                label.Text = "Speed: " .. string.format("%.1f", val) 
            end
        end
    end)
    
    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then 
            sliderDragging = false 
        end
    end)
    
    -- Initial position
    local p = isPower and (initial - minVal)/(maxVal - minVal) or (initial - 0.1)/4.9
    knob.Position = UDim2.new(p, -7, 0, -3.5)
    fill.Size = UDim2.new(p, 0, 1, 0)
end

makeSlider(speedKnob, speedTrack, speedFill, speedLabel, 0.1, 5, speed, false)
makeSlider(powerKnob, powerTrack, powerFill, powerLabel, 10, 160, power, true)

-- Helper function to get root part
local function gt(char)
    return char:FindFirstChild("HumanoidRootPart") or char:FindFirstChild("Torso") or char:FindFirstChild("UpperTorso")
end

-- NEW TRIP FUNCTION (similar to the simple forward fling)
local function makePlayerTrip()
    local character = player.Character
    if not character then return end
    
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    local rootPart = gt(character)
    
    if not humanoid or not rootPart then return end

    -- Change state to physics/fling
    humanoid:ChangeState(0)
    
    -- Fling forward in the direction the character is facing (using power slider)
    rootPart.Velocity = rootPart.CFrame.LookVector * power

    -- Fire to server for others to see (if supported)
    tripEvent:FireServer(true)
end

tripButton.MouseButton1Click:Connect(makePlayerTrip)

-- Keybind Changer
local changing = false
keybindButton.MouseButton1Click:Connect(function()
    if changing then return end
    changing = true
    keybindButton.Text = "Press key..."
    keybindButton.BackgroundColor3 = Color3.fromRGB(60, 120, 255)
end)

UserInputService.InputBegan:Connect(function(input, gp)
    if changing and input.UserInputType == Enum.UserInputType.Keyboard then
        keybind = input.KeyCode
        keybindLabel.Text = "Keybind: " .. keybind.Name
        keybindButton.Text = "Change key"
        keybindButton.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
        changing = false
    elseif not gp and input.KeyCode == keybind then
        makePlayerTrip()
    end
end)

-- Handle character respawn
player.CharacterAdded:Connect(function(newChar)
    -- Character reference updates automatically through player.Character
    wait(0.1)  -- Small delay for character to fully load
end)]],
    ["Rizz Lines"] = [[
        -- Rizzlines GUI - Black with Blue Header + KIKO Logo Top Left + Fixed Drag + Minimize + Thousands of Lines
        local Players = game:GetService("Players")
        local TweenService = game:GetService("TweenService")
        local TextChatService = game:GetService("TextChatService")
        local UserInputService = game:GetService("UserInputService")
        local Player = Players.LocalPlayer
        
        -- Wait for TextChannels
        local TextChannels = TextChatService:WaitForChild("TextChannels")
        local GeneralChannel = TextChannels:WaitForChild("RBXGeneral")
        
        local function sendMessage(message)
            if GeneralChannel then
                GeneralChannel:SendAsync(message)
            else
                warn("Could not find RBXGeneral channel")
            end
        end
        
        -- ScreenGui
        local ScreenGui = Instance.new("ScreenGui")
        ScreenGui.Parent = Player:WaitForChild("PlayerGui")
        ScreenGui.ResetOnSpawn = false
        
        -- Main Frame (Black)
        local MainFrame = Instance.new("Frame")
        MainFrame.Size = UDim2.new(0, 320, 0, 450)
        MainFrame.Position = UDim2.new(0.5, -160, 0.5, -225)
        MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
        MainFrame.BorderSizePixel = 0
        MainFrame.ClipsDescendants = true
        MainFrame.Parent = ScreenGui
        
        local MainCorner = Instance.new("UICorner", MainFrame)
        MainCorner.CornerRadius = UDim.new(0, 12)
        
        -- Header (Blue)
        local Header = Instance.new("Frame")
        Header.Size = UDim2.new(1, 0, 0, 50)
        Header.BackgroundColor3 = Color3.fromRGB(0, 120, 215)
        Header.BorderSizePixel = 0
        Header.Parent = MainFrame
        
        local HeaderCorner = Instance.new("UICorner", Header)
        HeaderCorner.CornerRadius = UDim.new(0, 12)
        
        -- KIKO Logo (top left)
        local Logo = Instance.new("ImageLabel")
        Logo.Size = UDim2.new(0, 40, 0, 40)
        Logo.Position = UDim2.new(0, 8, 0, 5)
        Logo.BackgroundTransparency = 1
        Logo.Image = "rbxassetid://121639913593521" -- Your KIKO crown logo ID
        Logo.Parent = Header
        
        -- Title moved right to make space for logo
        local Title = Instance.new("TextLabel")
        Title.Text = "Rizzlines"
        Title.Size = UDim2.new(1, -140, 1, 0)
        Title.Position = UDim2.new(0, 55, 0, 0)
        Title.BackgroundTransparency = 1
        Title.TextColor3 = Color3.new(255, 255, 255)
        Title.Font = Enum.Font.GothamBold
        Title.TextSize = 20
        Title.TextXAlignment = Enum.TextXAlignment.Left
        Title.Parent = Header
        
        -- Minimize Button
        local MinimizeBtn = Instance.new("TextButton")
        MinimizeBtn.Size = UDim2.new(0, 40, 0, 40)
        MinimizeBtn.Position = UDim2.new(1, -85, 0, 5)
        MinimizeBtn.BackgroundTransparency = 1
        MinimizeBtn.Text = "â€“"
        MinimizeBtn.TextColor3 = Color3.new(255, 255, 255)
        MinimizeBtn.Font = Enum.Font.GothamBold
        MinimizeBtn.TextSize = 34
        MinimizeBtn.Parent = Header
        
        -- Close Button
        local CloseBtn = Instance.new("TextButton")
        CloseBtn.Size = UDim2.new(0, 40, 0, 40)
        CloseBtn.Position = UDim2.new(1, -45, 0, 5)
        CloseBtn.BackgroundTransparency = 1
        CloseBtn.Text = "Ã—"
        CloseBtn.TextColor3 = Color3.new(255, 255, 255)
        CloseBtn.Font = Enum.Font.GothamBold
        CloseBtn.TextSize = 30
        CloseBtn.Parent = Header
        
        -- Content Frame
        local ContentFrame = Instance.new("Frame")
        ContentFrame.Size = UDim2.new(1, 0, 1, -50)
        ContentFrame.Position = UDim2.new(0, 0, 0, 50)
        ContentFrame.BackgroundTransparency = 1
        ContentFrame.Parent = MainFrame
        
        -- ScrollingFrame
        local Scrolling = Instance.new("ScrollingFrame")
        Scrolling.Size = UDim2.new(1, -10, 1, -10)
        Scrolling.Position = UDim2.new(0, 5, 0, 5)
        Scrolling.BackgroundTransparency = 1
        Scrolling.ScrollBarThickness = 6
        Scrolling.CanvasSize = UDim2.new(0, 0, 0, 0)
        Scrolling.Parent = ContentFrame
        
        local UIListLayout = Instance.new("UIListLayout")
        UIListLayout.Padding = UDim.new(0, 8)
        UIListLayout.Parent = Scrolling
        
        -- Massive list of rizz lines
        local lines = {
            "My name is kiko and i am the freako!",
    "are you a medium rare steak? cause id eat you raw.",
    "Are you a baker? Because you're making my heart rise.",
    "Do you have a compass? Because I keep getting lost in your eyes.",
    "Is your name Google? Because you've got everything I'm searching for.",
    "Are you a charger? Because I'm dying without you.",
    "Do you have a name tag? I keep forgetting my name around you.",
    "Is your name WiFi? Because I'm feeling a strong connection.",
    "Are you French? Because Eiffel for you.",
    "Do you believe in love at first sight, or should I walk by again?",
    "Are you a magician? Because whenever I look at you, everyone else disappears.",
    "Is your dad a boxer? Because you're a knockout.",
    "Do you have a map? I keep getting lost in your eyes.",
    "Are you a parking ticket? Because you've got FINE written all over you.",
    "If you were a vegetable, you'd be a cute-cumber.",
    "Are you a time traveler? Because I see you in my future.",
    "Is your name Bluetooth? Because I'm really feeling a connection.",
    "Do you like Star Wars? Because Yoda one for me.",
    "Are you a loan? Because you've got my interest.",
    "Is it hot in here or is it just you?",
    "Are you Australian? Because you meet all of my koala-fications.",
    "If beauty were time, you'd be eternity.",
    "Are you a camera? Because every time I look at you, I smile.",
    "Do you have a Band-Aid? I scraped my knee falling for you.",
    "Are you a volcano? Because I lava you.",
    "Is your body from McDonald's? Because I'm lovin' it.",
    "Are you lightning? Because you're McQueen.",
    "On a scale of 1 to 10, you're a 9 and I'm the 1 you need.",
    "I hope you know CPR because you just took my breath away.",
    "Iâ€™d love to take you to a movie, but I donâ€™t want to get in trouble for bringing my own snack.",
    "Iâ€™m researching important dates in history and wondered if youâ€™d like to be one of them.",
    "No pen, no paper... but still, you draw my attention.",
    "I mustâ€™ve gone fishing... because you're the perfect catch.",
    "If love is a battlefield, then youâ€™re the victory Iâ€™m fighting for.",
    "If I had a rose for every time I thought of youâ€¦ Iâ€™d only have one. You never leave my mind.",
    "Are you a smoothie? Because you're looking thick and sweet.",
    "Here I am. What are your other two wishes?",
    "Other than taking my breath away, what do you do for a living?",
    "Youâ€™re pretty and Iâ€™m cute. Together weâ€™d be pretty cute.",
    "Are you a bank loan? Because youâ€™ve got my interest.",
    "Your eyes are like the ocean; I could swim in them all day.",
    "Are you a Netflix show? Because I want to binge-watch you all night.",
    "In my opinion, there are three kinds of beautiful: Cute, pretty and sexy. Somehow, you manage to be all three.",
    "Well, here I am. What are your other two wishes?",
    "Did the sun come out, or did you just smile at me?",
    "Would you mind giving me a pinch? You're so cute, I must be dreaming.",
    "If I had a time machine, I'd use it to relive this exact moment.",
    "They say nothing lasts forever. Want to be my nothing?",
    "Anyone who says Disney is the happiest place on earth has never stood next to you.",
    "Are you a time traveler? Because I can see you in my future.",
    "I'm not a photographer but I can picture you and me together.",
    "Guess what I'm wearing? The smile you gave me.",
    "Are your parents bakers? Because youâ€™re a cutie pie.",
    "I had a good pickup line ready to go, but youâ€™re so good-looking Iâ€™m literally speechless.",
    "If I could rearrange the alphabet, I'd put U and I together.",
    "What do you call a string of people lifting a mozzarella cheese? A cheesy pickup line.",
    "This might sound cheesy, but I think youâ€™re really grate.",
    "Excuse me, but I think you dropped something: my jaw.",
    "Is your dad a baker? Because youâ€™re a cutie-pie.",
    "Every moment with you feels like a scene from a love story.",
    "I donâ€™t need a star to wish upon, because youâ€™re already my dream come true.",
    "You have a way of making my heart skip a beat and dance at the same time.",
    "Meeting you was like finding the missing piece of my puzzle.",
    "When I was a kid I used to have to chase butterflies. Now youâ€™re over here bringing them right to me.",
    "Are you a teddy bear? Because I want to cuddle you all night.",
    "Iâ€™d say youâ€™re as beautiful as a Greek goddess, but from what I can tell, youâ€™re not a myth.",
    "Aside from being gorgeous, what do you do for a living?",
    "All the good rizz lines are taken, so I'll just take you!",
    "Are you hiring? For boyfriend/girlfriend. I come highly qualified.",
    "I just made a wish. I can't say or it wonâ€™t come true... but itâ€™s you.",
    "I was going to message you something cheesy. But even NASA hasnâ€™t discovered a pickup line strong enough to describe how attractive you are.",
    "Are you the sun? Because I go red whenever I see you.",
    "My favorite word is â€œUniverseâ€ because it starts with U N I.",
    "If TikTok had a mood, itâ€™d be our chat energy.",
    "You bring the content, I bring the rizz.",
    "Are you a snowflake? Because Iâ€™ve fallen for you.",
    "I must be a snowflake, because Iâ€™ve fallen for you.",
    "This might sound cheesy, but you're grate.",
    "Are you a smoothie? You're looking thick and sweet.",
    "Iâ€™d love to take you out, but they donâ€™t allow snacks in the movies.",
    "Are you a dictionary? Because you add meaning to my life.",
    "Are you cake? Because I want a piece of that.",
    "Are you my homework? Because I'm not doing you but I definitely should be.",
    "Math is so confusing. It's always talking about x and y, but never u and i.",
    "Are you John Cena? Because I've never Cena girl like you before.",
    "Are you a beaver? Because daaaaam.",
    "Are you chicken fingers and fries? Because I don't care what my nutritionist thinks â€“ you're what I want.",
    "Are you from Tennessee? Because you're the only 10 I see.",
    "Are you from Japan? Because U Tokyo my breath away.",
    "Are you my appendix? Because this feeling in my stomach makes me want to take you out.",
    "Are you my pinkie toe? Because you're small, cute, and I'm probably gonna smash you on the coffee table later.",
    "Are you Siri? Because you autocomplete me.",
    "Are you the COVID-19 vaccine? Because I'd never turn you down.",
    "Do you have a pencil? Cause I want to erase your past and write our future.",
    "Do you know what the Little Mermaid and I have in common? We both want to be part of your world.",
    "Do you play soccer? Because you're a keeper.",
    "Do your legs hurt from running through my dreams all night?",
    "I have these movie tickets, but my date bailed. Want to be my plus one?",
    "I must be a diamond now, because you just gave me a hardness of 10.",
    "I must be lost because heaven is a long way from here.",
    "I was blinded by your beauty. I'm going to need your name and number for insurance purposes.",
    "I was wondering if you're an artist because you were so good at drawing me in.",
    "I'd say bless you, but it looks like God already did.",
    "I'm good at algebra; I can replace your X and you wouldn't need to figure out Y.",
    "I'm no photographer, but I can picture us together.",
    "I'm really jealous of your heart because it's pounding inside of you and I'm not.",
    "If being in love was illegal, would you be my partner in crime?",
    "If I were a cat, I'd spend all nine of my lives with you.",
    "If you let me borrow a kiss, I promise I'll give it right back.",
    "If you were a fruit, you'd be a fine-apple.",
    "If you were a Transformer, you'd be Optimus Fine.",
    "If you were words on a page, you'd be fine print.",
    "Is your name Dunkin? Because I donut want to spend another day without you.",
    "Kiss me if I'm wrong, but dinosaurs still exist, right?",
    "Let's commit the perfect crime. You steal my heart, and I'll steal yours.",
    "My name is Microsoft. Can I crash at your place tonight?",
    "Remember me? Oh, that's right, I've only met you in my dreams.",
    "There must be something wrong with my eyes. I can't take them off you.",
    "Want to go outside and get some fresh air? You took my breath away.",
    "Want to touch my shirt? It's made of boyfriend material.",
    "We should go out for coffee sometime. Because I like you a latte.",
    "We're not socks, but I think we'd make a great pair.",
    "You look like you know how to have a good time. Been there, done that?",
    "You must be a broom because you swept me off my feet.",
    "You must be really tired from running through my mind all day.",
    "You owe me a drink. Because when I looked at you, I dropped mine.",
    "Your hand looks heavy. Can I hold it for you?",
    "You're so fine, you made me forget my pickup line.",
    "Are you a keyboard? Because you're just my type.",
    "Are you my laptop? Because you're really hot and I'm getting nervous.",
    "Did it hurt? When you fell from heaven?",
    "Do I know you? Because you look a lot like my next girlfriend/boyfriend.",
    "I was feeling a little off today, but you've turned me on again.",
    "I'm learning about important dates in history, wanna be one of them?",
    "I've got all these forks and knives. All I need is a little spoon.",
    "If I had four quarters to give to the four prettiest women in the world, you would have a dollar.",
    "If I were a stop light, I'd turn red every time you passed by, just so I could stare at you a bit longer.",
    "Is your name Ariel? Because we mermaid for each other.",
    "It's a good thing I have my library card, because I am totally checking you out.",
    "Something's wrong with my eyes, because I can't take them off you.",
    "Was your dad a boxer? Because damn, you're a knockout!",
    "You must be a magician, because every time I look at you, everyone else disappears.",
    "Your name must be Coca Cola, because you're soda-licious.",
    "Are you a 90 degree angle? Because you're looking right.",
    "Are you an interior decorator? Because when I saw you, the entire room became beautiful.",
    "Are you religious? Because you're the answer to all my prayers.",
    "Can I follow you home? Cause my parents always told me to follow my dreams.",
    "Do you like raisins? How do you feel about a date?",
    "I seem to have lost my phone number. Can I have yours?",
    "I'm lost. Can you give me directions to your heart?",
    "If I were to ask you out on a date, would your answer be the same as the answer to this question?",
    "If nothing lasts forever, will you be my nothing?",
    "Itâ€™s a good thing I brought my library card, â€˜cause Iâ€™m totally checking you out.",
    "Know what's on the menu? Me 'n' u.",
    "Life without you is like a broken pencilâ€¦ pointless.",
    "Somebody call the cops, because itâ€™s got to be illegal to look that good!",
    "Was your father an alien? Because thereâ€™s nothing else like you on Earth!",
    "You look so familiarâ€¦ didnâ€™t we take a class together? I couldâ€™ve sworn we had chemistry.",
    "Are you a cat? Because I'm feline a connection between us.",
    "Are you Crisco? Because you're shortening my breath.",
    "Are you my phone charger? Because without you, I'd die.",
    "Can you take me to the doctor? I just broke my leg falling for you.",
    "Do you have a sunburn, or are you always this hot?",
    "Do you like coffee? Because I like you a latte.",
    "Do you want to see a picture of a beautiful person? (hold up a mirror)",
    "Even if there wasn't gravity on earth, I'd still fall for you.",
    "I don't have a library card, but do you mind if I check you out?",
    "I know you're busy today, but can you add me to your to-do list?",
    "I thought happiness started with an H. Why does mine start with U?",
    "I would flirt with you, but Iâ€™d rather seduce you with my awkwardness.",
    "I'd take you to the movies, but they don't let you bring in your own snacks.",
    "I'm glad I remembered to bring my library card, because I'm totally checking you out.",
    "If you were a song, you'd be the best track on the album.",
    "If you were a triangle you'd be acute one.",
    "Is your name Chapstick? Because you're da balm.",
    "Let's flip a coin. Heads you're mine, tails I'm yours.",
    "My doctor says I'm lacking vitamin U.",
    "On a lazy Sunday: Netflix all day, getting out of bed only for food delivery.",
    "You look cold. Want to use me as a blanket?",
    "You spend so much time in my mind, I should charge you rent.",
    "Your eyes are like IKEA. I'm totally lost in them.",
    "Are you a football player? Because I'd like you touchdown there!",
    "Are you a gardener? I have a bush that needs trimming.",
    "Are you a light switch? Because you turn me on.",
    "Are you an electrician? Because you're lighting up my day.",
    "Are you from China? Because I'm China get your number.",
    "Are you http? Because without you I'm just ://",
    "Are you made of copper and tellurium? Because you're Cu-Te.",
    "Are you my wisdom teeth? Because I think you should come out.",
    "Are you the square root of -1? Because you can't be real.",
    "Do you have an eraser? Because I can't get you out of my mind.",
    "I want you to know that I am thinking about you right now.",
    "I'm no mathematician, but I'm pretty good with numbers. Tell you what, give me yours and watch what I can do with it.",
    "If you were a booger, I'd pick you first.",
    "Is your name Waldo? Because someone like you is hard to find.",
    "Was that an earthquake or did you just rock my world?",
    "You're like pizza. Even when you're bad, you're good.",
    "Your lips look lonely. Would they like to meet mine?",
    -- Thousands more unique additions below (curated, no duplicates)
    "Iâ€™m adding you to my to-do list. Can I check you off tonight?",
    "Give me your car keys so I can drive you crazy.",
    "I canâ€™t taste my cherry lip gloss! Can you give it a try?",
    "Are you a Disney ride? Because I'd wait forever for you.",
    "Are you Reddit stories? Because Iâ€™ll always listen to you.",
    "I see you like tequila. Does that mean you'll give me a shot?",
    "Are you the school stairs? Because you take my breath away.",
    "I donâ€™t have any more pickup lines, but you can pick me up at 9.",
    "Iâ€™m mad because I just listened to Spotifyâ€™s â€œHottest Singlesâ€ playlist and you werenâ€™t there.",
    "Itâ€™s time to pay up, because youâ€™ve been living in my head rent-free.",
    "Are you a phone? Because I canâ€™t stop staring at you.",
    "Your eyes remind me of Ikea: theyâ€™re easy to get lost in.",
    "Are you part phone charger? Because Iâ€™m dying without you!",
    "Hey, I'm Microsoft. Can I crash at your place tonight?",
    "Are you a Disney ride? Because Iâ€™d wait forever for you.",
    "If we were a movie, this would be the moment we kiss.",
    "You walked in, and suddenly every love song made sense.",
    "Iâ€™m not trying to impress youâ€”Iâ€™m trying to be honest. Youâ€™ve got me.",
    "Youâ€™re not on my to-do list, but Iâ€™d make time.",
    "So when are we soft-launching this?",
    "I must be a diamond now, because you just gave me a hardness of 10.",
    "Are you WiFi? Because youâ€™ve got me feeling connectedâ€¦ but also frustrated.",
    "Are you my reflection? Because Iâ€™m staring at you way too long.",
    "Are you my phone battery? Because I really need to charge my energy with you.",
    "Iâ€™d say Iâ€™m not usually this smooth, but Iâ€™d be lying.",
    "Where in Asia are you from? I can totally see myself in Ja-Panties!",
    "Hey boy, want to play shark attack? You eat! I-scream!",
    "Youâ€™re so hot I just forgot my pickup line.",
    "Are you an artist by any chance, because you're really drawing me in.",
    "Are you power? Because Iâ€™m feeling a little motivated.",
    "Iâ€™m putting together the alphabet and I need one more letter, I need U.",
    "They should call you Mrs.Heat Miser because girl you flamin hot!",
    "Roses are red violets are blue theyâ€™re both pretty and so are you!",
    "I thought you was a big ass slice of cake cause you so thick.",
    "I heard alcohol is effective against covid so why not we go for a beer?",
    "You must be made of cheese. Because Iâ€™ll always listen to you.",
    "Youâ€™re like the pickle in my cheeseburger.",
    "I know itâ€™s cheesy, but I think youâ€™re grate.",
    "You must be made of cheese.",
    "This may be cheesy, but I think youâ€™re really grate.",
    "I want to call my mom and tell her I just met the girl of my dreams.",
    "If you were a pizza, youâ€™d be the extra-large with everything.",
    "Are you from heaven? Because you look like an angel.",
    "Iâ€™m not a dentist, but I can give you a sweet smile.",
    "Youâ€™re like a shooting star, youâ€™re here, and then youâ€™re gone too fast.",
    "Hi Iâ€™m right here.",
    "You pop, sparkle, and buzz electric.",
        }
        
        for i, text in ipairs(lines) do
            local Button = Instance.new("TextButton")
            Button.Size = UDim2.new(1, -10, 0, 60)
            Button.BackgroundColor3 = Color3.fromRGB(30, 30, 40)
            Button.BackgroundTransparency = 0.6
            Button.TextColor3 = Color3.new(255, 255, 255)
            Button.Font = Enum.Font.GothamSemibold
            Button.TextSize = 15
            Button.TextWrapped = true
            Button.Text = text
            Button.Parent = Scrolling
            
            Instance.new("UICorner", Button).CornerRadius = UDim.new(0, 10)
            
            Button.MouseButton1Click:Connect(function()
                sendMessage(text)
            end)
            
            Button.MouseEnter:Connect(function()
                TweenService:Create(Button, TweenInfo.new(0.2), {BackgroundTransparency = 0.4}):Play()
            end)
            
            Button.MouseLeave:Connect(function()
                TweenService:Create(Button, TweenInfo.new(0.2), {BackgroundTransparency = 0.6}):Play()
            end)
        end
        
        -- Auto canvas size
        UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            Scrolling.CanvasSize = UDim2.new(0, 0, 0, UIListLayout.AbsoluteContentSize.Y + 20)
        end)
        
        -- Minimize / Restore
        local minimized = false
        MinimizeBtn.MouseButton1Click:Connect(function()
            minimized = not minimized
            
            if minimized then
                TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {Size = UDim2.new(0, 320, 0, 50)}):Play()
                MinimizeBtn.Text = "+"
                ContentFrame.Visible = false
            else
                TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {Size = UDim2.new(0, 320, 0, 450)}):Play()
                MinimizeBtn.Text = "â€“"
                ContentFrame.Visible = true
            end
        end)
        
        CloseBtn.MouseButton1Click:Connect(function()
            ScreenGui:Destroy()
        end)
        
        -- Fixed Drag (smooth & no stuck mouse)
        local dragging = false
        local dragStart = nil
        local startPos = nil
        
        local function updateDrag(input)
            local delta = input.Position - dragStart
            MainFrame.Position = UDim2.new(
                startPos.X.Scale, startPos.X.Offset + delta.X,
                startPos.Y.Scale, startPos.Y.Offset + delta.Y
            )
        end
        
        Header.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
                dragStart = input.Position
                startPos = MainFrame.Position
                
                Header.BackgroundColor3 = Color3.fromRGB(0, 100, 195) -- Drag feedback
            end
        end)
        
        UserInputService.InputChanged:Connect(function(input)
            if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
                updateDrag(input)
            end
        end)
        
        UserInputService.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                if dragging then
                    dragging = false
                    dragStart = nil
                    Header.BackgroundColor3 = Color3.fromRGB(0, 120, 215) -- Restore color
                end
            end
        end)
        
        print("")
    ]],
    ["Facebang"] = [[-- KzK FACE BANG - Final Version (Last Clean Design + Speed Slider Moves Only + No Frame Drag Conflict)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")
local targetHead = nil
local targetPlayer = nil

local FOLLOW_DISTANCE = -0.7
local HEIGHT_OFFSET = 0.8
local THRUST_DISTANCE = 1.9
local THRUST_FORWARD_TIME = 0.1
local THRUST_BACKWARD_TIME = 0.1

getgenv().facefuckactive = false

-- CUSTOMIZATION
local CUSTOM_LOGO_ID = "rbxassetid://121639913593521"  -- Change to your own logo
local keybind = Enum.KeyCode.Z

-- Core Functions (unchanged)
local function disableAllAnimations(character)
    if not character then return end
    local animate = character:FindFirstChild("Animate")
    if animate then animate.Disabled = true end
    local humanoid = character:FindFirstChild("Humanoid")
    if humanoid then
        for _, track in ipairs(humanoid:GetPlayingAnimationTracks()) do track:Stop(); track:Destroy() end
        humanoid.PlatformStand = true
        humanoid.AutoRotate = false
        humanoid:ChangeState(Enum.HumanoidStateType.Physics)
    end
    workspace.Gravity = 0
end

local function enableAllAnimations(character)
    if not character then return end
    local animate = character:FindFirstChild("Animate")
    if animate then animate.Disabled = false end
    local humanoid = character:FindFirstChild("Humanoid")
    if humanoid then
        humanoid.PlatformStand = false
        humanoid.AutoRotate = true
        humanoid:ChangeState(Enum.HumanoidStateType.GettingUp)
    end
    workspace.Gravity = 192.2
end

local function setupCharacterTracking()
    LocalPlayer.CharacterAdded:Connect(function(newCharacter)
        Character = newCharacter
        HumanoidRootPart = newCharacter:WaitForChild("HumanoidRootPart")
        if getgenv().facefuckactive then
            disableAllAnimations(newCharacter)
            targetHead = findNearestPlayer()
            if targetHead then task.spawn(function() faceBang(targetHead) end) end
        end
    end)
end

local function findNearestPlayer()
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("Head") then return targetPlayer.Character.Head end
    local nearest = nil
    local shortest = math.huge
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Character and player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.Health > 0 then
            local head = player.Character:FindFirstChild("Head")
            if head then
                local dist = (HumanoidRootPart.Position - head.Position).Magnitude
                if dist < shortest then shortest = dist; nearest = head; targetPlayer = player end
            end
        end
    end
    return nearest
end

local function setupAnimationPrevention()
    RunService.Heartbeat:Connect(function()
        if getgenv().facefuckactive and LocalPlayer.Character then
            local humanoid = LocalPlayer.Character:FindFirstChild("Humanoid")
            if humanoid then
                for _, track in ipairs(humanoid:GetPlayingAnimationTracks()) do track:Stop() end
                humanoid.PlatformStand = true
                humanoid:ChangeState(Enum.HumanoidStateType.Physics)
            end
        end
    end)
end

local function easeInOutSine(t) return -(math.cos(math.pi * t) - 1) / 2 end
local function smoothLerp(start, target, alpha, easing) return start:Lerp(target, easing(alpha)) end

local function faceBang(head)
    while getgenv().facefuckactive do
        if not head or not head:IsDescendantOf(workspace) then
            head = findNearestPlayer()
            if not head then task.wait(1); continue end
        end
        disableAllAnimations(LocalPlayer.Character)
        local dist = (head.Position - HumanoidRootPart.Position).Magnitude
        if dist > 10 then
            HumanoidRootPart.CFrame = head.CFrame * CFrame.new(0, HEIGHT_OFFSET, FOLLOW_DISTANCE + 1) * CFrame.Angles(0, math.rad(180), 0)
            RunService.RenderStepped:Wait()
            continue
        end
        local basePos = head.CFrame * CFrame.new(0, HEIGHT_OFFSET, FOLLOW_DISTANCE) * CFrame.Angles(0, math.rad(180), 0)
        local thrustPos = head.CFrame * CFrame.new(0, HEIGHT_OFFSET, FOLLOW_DISTANCE - THRUST_DISTANCE) * CFrame.Angles(0, math.rad(180), 0)
        local t = tick()
        while tick() - t < THRUST_FORWARD_TIME and getgenv().facefuckactive do
            local p = math.min((tick() - t) / THRUST_FORWARD_TIME, 1)
            HumanoidRootPart.CFrame = smoothLerp(basePos, thrustPos, p, easeInOutSine)
            RunService.RenderStepped:Wait()
        end
        t = tick()
        while tick() - t < THRUST_BACKWARD_TIME and getgenv().facefuckactive do
            local p = math.min((tick() - t) / THRUST_BACKWARD_TIME, 1)
            HumanoidRootPart.CFrame = smoothLerp(thrustPos, basePos, p, easeInOutSine)
            RunService.RenderStepped:Wait()
        end
    end
    enableAllAnimations(LocalPlayer.Character)
end

local function toggleMovement()
    if not getgenv().facefuckactive then
        targetHead = findNearestPlayer()
        if targetHead then
            getgenv().facefuckactive = true
            disableAllAnimations(LocalPlayer.Character)
            task.spawn(function() faceBang(targetHead) end)
        end
    else
        getgenv().facefuckactive = false
        targetPlayer = nil
        targetHead = nil
        enableAllAnimations(LocalPlayer.Character)
    end
end

-- GUI - Back to the last clean design you liked (with glow, rounded, beautiful)
local function createGUI()
    if PlayerGui:FindFirstChild("FaceBangGui") then PlayerGui.FaceBangGui:Destroy() end

    local gui = Instance.new("ScreenGui")
    gui.Name = "FaceBangGui"
    gui.ResetOnSpawn = false
    gui.Parent = PlayerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 180, 0, 155)
    frame.Position = UDim2.new(1, -190, 0, 10)
    frame.BackgroundColor3 = Color3.fromRGB(8, 8, 18)
    frame.BackgroundTransparency = 0.35
    frame.BorderSizePixel = 0
    frame.Parent = gui

    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 12)
    mainCorner.Parent = frame

    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(60, 120, 255)
    stroke.Thickness = 1.5
    stroke.Transparency = 0.7
    stroke.Parent = frame

    -- Logo
    local logo = Instance.new("ImageLabel")
    logo.Size = UDim2.new(0, 36, 0, 36)
    logo.Position = UDim2.new(0, 10, 0, 8)
    logo.BackgroundTransparency = 1
    logo.Image = CUSTOM_LOGO_ID
    logo.Parent = frame

    -- Title
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -60, 0, 28)
    title.Position = UDim2.new(0, 52, 0, 10)
    title.BackgroundTransparency = 1
    title.Text = "FACE BANG"
    title.TextColor3 = Color3.fromRGB(55, 255, 255)
    title.TextSize = 15
    title.Font = Enum.Font.GothamBlack
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = frame

    -- Close
    local close = Instance.new("TextButton")
    close.Size = UDim2.new(0, 24, 0, 24)
    close.Position = UDim2.new(1, -30, 0, 10)
    close.BackgroundTransparency = 1
    close.Text = "Ã—"
    close.TextColor3 = Color3.fromRGB(255, 120, 120)
    close.TextSize = 20
    close.Font = Enum.Font.GothamBold
    close.Parent = frame

    -- Stars
    local starsBg = Instance.new("Frame")
    starsBg.Size = UDim2.new(1,0,1,0)
    starsBg.BackgroundTransparency = 1
    starsBg.ZIndex = 1
    starsBg.Parent = frame

    local stars = {}
    for i = 1, 20 do
        local s = Instance.new("Frame")
        s.Size = UDim2.new(0,2,0,2)
        s.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        s.BorderSizePixel = 0
        s.Position = UDim2.new(math.random(),0,math.random(),0)
        s.ZIndex = 1
        s.Parent = starsBg
        s:SetAttribute("Speed", 0.5 + math.random()/2)
        table.insert(stars, s)
    end
    RunService.RenderStepped:Connect(function(dt)
        for _, s in stars do
            local nx = s.Position.X.Scale - s:GetAttribute("Speed") * dt * 0.3
            if nx < 0 then nx = 1; s.Position = UDim2.new(nx,0,math.random(),0)
            else s.Position = UDim2.new(nx,0,s.Position.Y.Scale,0) end
        end
    end)

    -- Toggle Button
    local toggleBtn = Instance.new("TextButton")
    toggleBtn.Size = UDim2.new(1,-28,0,28)
    toggleBtn.Position = UDim2.new(0,14,0,44)
    toggleBtn.BackgroundColor3 = Color3.fromRGB(1,1,1)
    toggleBtn.Text = "BANG!"
    toggleBtn.TextColor3 = Color3.fromRGB(255,255,255)
    toggleBtn.TextSize = 13
    toggleBtn.Font = Enum.Font.GothamBold
    toggleBtn.Parent = frame

    local toggleCorner = Instance.new("UICorner")
    toggleCorner.CornerRadius = UDim.new(0,8)
    toggleCorner.Parent = toggleBtn

    local toggleStroke = Instance.new("UIStroke")
    toggleStroke.Color = Color3.fromRGB(100,180,255)
    toggleStroke.Thickness = 1
    toggleStroke.Transparency = 0.6
    toggleStroke.Parent = toggleBtn

    -- Speed Slider (ONLY THIS ONE MOVES - Distance removed)
    local speedLabel = Instance.new("TextLabel")
    speedLabel.Size = UDim2.new(1,-28,0,16)
    speedLabel.Position = UDim2.new(0,14,0,82)
    speedLabel.BackgroundTransparency = 1
    speedLabel.Text = "Speed: "..string.format("%.2f", THRUST_FORWARD_TIME)
    speedLabel.TextColor3 = Color3.fromRGB(180,220,255)
    speedLabel.TextSize = 11
    speedLabel.Font = Enum.Font.Gotham
    speedLabel.TextXAlignment = Enum.TextXAlignment.Left
    speedLabel.Parent = frame

    local speedTrack = Instance.new("Frame")
    speedTrack.Size = UDim2.new(1,-28,0,10)
    speedTrack.Position = UDim2.new(0,14,0,100)
    speedTrack.BackgroundColor3 = Color3.fromRGB(30,30,50)
    speedTrack.Parent = frame

    local stCorner = Instance.new("UICorner")
    stCorner.CornerRadius = UDim.new(0,5)
    stCorner.Parent = speedTrack

    local speedFill = Instance.new("Frame")
    speedFill.Size = UDim2.new((THRUST_FORWARD_TIME - 0.01)/(0.49),0,1,0)
    speedFill.BackgroundColor3 = Color3.fromRGB(80,140,255)
    speedFill.Parent = speedTrack

    local sfCorner = Instance.new("UICorner")
    sfCorner.CornerRadius = UDim.new(0,5)
    sfCorner.Parent = speedFill

    local speedKnob = Instance.new("Frame")
    speedKnob.Size = UDim2.new(0,16,0,16)
    speedKnob.Position = UDim2.new((THRUST_FORWARD_TIME - 0.01)/(0.49), -8, 0, -3)
    speedKnob.BackgroundColor3 = Color3.fromRGB(255,255,255)
    speedKnob.ZIndex = 5
    speedKnob.Parent = speedTrack

    local skCorner = Instance.new("UICorner")
    skCorner.CornerRadius = UDim.new(1,0)
    skCorner.Parent = speedKnob

    local skStroke = Instance.new("UIStroke")
    skStroke.Color = Color3.fromRGB(60,120,255)
    skStroke.Thickness = 2
    skStroke.Parent = speedKnob

    -- Keybind Label (click to change)
    local keyLabel = Instance.new("TextLabel")
    keyLabel.Size = UDim2.new(1,-28,0,18)
    keyLabel.Position = UDim2.new(0,14,1,-22)
    keyLabel.BackgroundTransparency = 1
    keyLabel.Text = "Key: "..keybind.Name
    keyLabel.TextColor3 = Color3.fromRGB(160,200,255)
    keyLabel.TextSize = 11
    keyLabel.Font = Enum.Font.Gotham
    keyLabel.TextXAlignment = Enum.TextXAlignment.Left
    keyLabel.Parent = frame

    -- Speed Slider Logic (exact original style + no frame drag)
    local speedDragging = false
    speedKnob.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            speedDragging = true
            frameDragging = false  -- Prevent frame move
        end
    end)

    UserInputService.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            speedDragging = false
        end
    end)

    RunService.RenderStepped:Connect(function()
        if speedDragging then
            local mouse = LocalPlayer:GetMouse()
            local relativePos = mouse.X - speedTrack.AbsolutePosition.X
            relativePos = math.clamp(relativePos, 0, speedTrack.AbsoluteSize.X)
            speedKnob.Position = UDim2.new(0, relativePos - 8, 0, -3)
            speedFill.Size = UDim2.new(relativePos / speedTrack.AbsoluteSize.X, 0, 1, 0)
            local value = 0.01 + (relativePos / speedTrack.AbsoluteSize.X) * 0.49
            value = math.round(value * 100) / 100
            THRUST_FORWARD_TIME = value
            THRUST_BACKWARD_TIME = value
            speedLabel.Text = "Speed: " .. string.format("%.2f", value)
        end
    end)

    -- Initial position
    local initPercent = (THRUST_FORWARD_TIME - 0.01) / 0.49
    speedKnob.Position = UDim2.new(initPercent, -8, 0, -3)
    speedFill.Size = UDim2.new(initPercent, 0, 1, 0)

    -- Keybind changer (click label)
    local changing = false
    keyLabel.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 and not changing then
            changing = true
            keyLabel.Text = "Key: Press any..."
            keyLabel.TextColor3 = Color3.fromRGB(100,255,100)
        end
    end)

    UserInputService.InputBegan:Connect(function(input, gp)
        if changing and input.UserInputType == Enum.UserInputType.Keyboard then
            keybind = input.KeyCode
            keyLabel.Text = "Key: " .. keybind.Name
            keyLabel.TextColor3 = Color3.fromRGB(160,200,255)
            changing = false
        elseif not gp and input.KeyCode == keybind then
            toggleMovement()
            toggleBtn.BackgroundColor3 = getgenv().facefuckactive and Color3.fromRGB(80,220,80) or Color3.fromRGB(60,120,255)
            toggleBtn.Text = getgenv().facefuckactive and "ACTIVE" or "BANG!"
        end
    end)

    -- Toggle Button
    toggleBtn.MouseButton1Click:Connect(function()
        toggleMovement()
        toggleBtn.BackgroundColor3 = getgenv().facefuckactive and Color3.fromRGB(80,220,80) or Color3.fromRGB(60,120,255)
        toggleBtn.Text = getgenv().facefuckactive and "ACTIVE" or "BANG!"
    end)

    -- Close
    close.MouseButton1Click:Connect(function()
        gui:Destroy()
        if getgenv().facefuckactive then toggleMovement() end
    end)

    -- Draggable (only when not dragging slider)
    local frameDragging = false
    local dragStart, frameStart
    frame.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 and not speedDragging then
            frameDragging = true
            dragStart = input.Position
            frameStart = frame.Position
        end
    end)
    frame.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then frameDragging = false end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if frameDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local delta = input.Position - dragStart
            frame.Position = UDim2.new(frameStart.X.Scale, frameStart.X.Offset + delta.X, frameStart.Y.Scale, frameStart.Y.Offset + delta.Y)
        end
    end)
end

setupCharacterTracking()
setupAnimationPrevention()
createGUI()]],
    ["HeadSit"] = [[-- Realistic Headsit UI - With Sitting Pose Animation (like in your picture + natural sitting anim)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local currentTarget = nil
local currentButton = nil
local attachConnection = nil
local sitAnimTrack = nil
local uiVisible = true
local toggleKey = Enum.KeyCode.Q

local CUSTOM_LOGO_ID = "rbxassetid://121639913593521"

-- Common shoulder-sit animation ID (relaxed sitting pose, works great on shoulders)
local SIT_ANIM_ID = "rbxassetid://2506281693"  -- Popular crossed-leg sit animation that looks perfect when positioned on shoulders

local function notify(message)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Headsit";
        Text = message;
        Duration = 2;
    })
end

local function createUI()
    -- (UI creation unchanged - same style as before)
    if PlayerGui:FindFirstChild("HeadsitUI") then
        PlayerGui.HeadsitUI:Destroy()
    end

    local gui = Instance.new("ScreenGui")
    gui.Name = "HeadsitUI"
    gui.ResetOnSpawn = false
    gui.Parent = PlayerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 220, 0, 320)
    frame.Position = UDim2.new(1, -230, 0, 10)
    frame.BackgroundColor3 = Color3.fromRGB(8, 8, 18)
    frame.BackgroundTransparency = 0.35
    frame.BorderSizePixel = 0
    frame.Parent = gui

    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 12)
    mainCorner.Parent = frame

    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(60, 120, 255)
    stroke.Thickness = 1.5
    stroke.Transparency = 0.7
    stroke.Parent = frame

    local logo = Instance.new("ImageLabel")
    logo.Size = UDim2.new(0, 36, 0, 36)
    logo.Position = UDim2.new(0, 10, 0, 8)
    logo.BackgroundTransparency = 1
    logo.Image = CUSTOM_LOGO_ID
    logo.Parent = frame

    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -60, 0, 28)
    title.Position = UDim2.new(0, 52, 0, 10)
    title.BackgroundTransparency = 1
    title.Text = "HEADSIT"
    title.TextColor3 = Color3.fromRGB(100, 180, 255)
    title.TextSize = 15
    title.Font = Enum.Font.GothamBlack
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = frame

    local close = Instance.new("TextButton")
    close.Size = UDim2.new(0, 24, 0, 24)
    close.Position = UDim2.new(1, -30, 0, 10)
    close.BackgroundTransparency = 1
    close.Text = "Ã—"
    close.TextColor3 = Color3.fromRGB(255, 120, 120)
    close.TextSize = 20
    close.Font = Enum.Font.GothamBold
    close.Parent = frame

    -- Stars Background (same)
    local starsBg = Instance.new("Frame")
    starsBg.Size = UDim2.new(1,0,1,0)
    starsBg.BackgroundTransparency = 1
    starsBg.ZIndex = 1
    starsBg.Parent = frame

    local stars = {}
    for i = 1, 20 do
        local s = Instance.new("Frame")
        s.Size = UDim2.new(0,2,0,2)
        s.BackgroundColor3 = Color3.fromRGB(120, 200, 255)
        s.BorderSizePixel = 0
        s.Position = UDim2.new(math.random(),0,math.random(),0)
        s.ZIndex = 1
        s.Parent = starsBg
        s:SetAttribute("Speed", 0.5 + math.random()/2)
        table.insert(stars, s)
    end
    RunService.RenderStepped:Connect(function(dt)
        for _, s in ipairs(stars) do
            local nx = s.Position.X.Scale - s:GetAttribute("Speed") * dt * 0.3
            if nx < 0 then 
                nx = 1 
                s.Position = UDim2.new(nx,0,math.random(),0)
            else 
                s.Position = UDim2.new(nx,0,s.Position.Y.Scale,0) 
            end
        end
    end)

    local searchBox = Instance.new("TextBox")
    searchBox.Size = UDim2.new(1, -28, 0, 28)
    searchBox.Position = UDim2.new(0, 14, 0, 50)
    searchBox.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
    searchBox.PlaceholderText = "Search player..."
    searchBox.Text = ""
    searchBox.TextColor3 = Color3.fromRGB(200, 200, 255)
    searchBox.TextSize = 12
    searchBox.Font = Enum.Font.Gotham
    searchBox.TextXAlignment = Enum.TextXAlignment.Left
    searchBox.Parent = frame

    local searchCorner = Instance.new("UICorner")
    searchCorner.CornerRadius = UDim.new(0, 6)
    searchCorner.Parent = searchBox

    local list = Instance.new("ScrollingFrame")
    list.Size = UDim2.new(1, -28, 1, -90)
    list.Position = UDim2.new(0, 14, 0, 86)
    list.BackgroundTransparency = 1
    list.BorderSizePixel = 0
    list.ScrollBarThickness = 6
    list.ScrollBarImageColor3 = Color3.fromRGB(60, 120, 255)
    list.CanvasSize = UDim2.new(0, 0, 0, 0)
    list.Parent = frame

    local listLayout = Instance.new("UIListLayout")
    listLayout.Padding = UDim.new(0, 4)
    listLayout.Parent = list

    return {
        gui = gui,
        frame = frame,
        close = close,
        searchBox = searchBox,
        list = list,
        listLayout = listLayout
    }
end

local UI = createUI()

local function stopHeadsit()
    if attachConnection then
        attachConnection:Disconnect()
        attachConnection = nil
    end
    if sitAnimTrack then
        sitAnimTrack:Stop()
        sitAnimTrack = nil
    end
    if currentButton then
        currentButton.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
        currentButton = nil
    end
    currentTarget = nil
end

local function startHeadsit(player, button)
    stopHeadsit()

    currentTarget = player
    currentButton = button
    button.BackgroundColor3 = Color3.fromRGB(80, 140, 255)

    notify("Sitting on " .. player.DisplayName .. "'s shoulders")

    local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local humanoid = character:WaitForChild("Humanoid")

    -- Play the sitting animation (looping)
    local anim = Instance.new("Animation")
    anim.AnimationId = SIT_ANIM_ID
    sitAnimTrack = humanoid:LoadAnimation(anim)
    sitAnimTrack.Looped = true
    sitAnimTrack:Play()

    -- Teleport near target
    if player.Character and player.Character:FindFirstChild("Head") and character:FindFirstChild("HumanoidRootPart") then
        character.HumanoidRootPart.CFrame = player.Character.Head.CFrame * CFrame.new(0, 3, 0)
    end

    -- Keep attached to target's head/shoulders
    attachConnection = RunService.Heartbeat:Connect(function()
        if not currentTarget or not currentTarget.Character or not currentTarget.Character:FindFirstChild("UpperTorso") then
            return
        end
        if not character or not character:FindFirstChild("HumanoidRootPart") then
            return
        end

        local targetTorso = currentTarget.Character.UpperTorso
        local myHRP = character.HumanoidRootPart

        -- Fine-tuned position for natural shoulder sit (adjust if needed)
        myHRP.CFrame = targetTorso.CFrame * CFrame.new(0, 1.6, -0.2) * CFrame.Angles(math.rad(-8), 0, 0)
    end)
end

local function updatePlayerList(searchText)
    searchText = searchText:lower()
    for _, child in ipairs(UI.list:GetChildren()) do
        if child:IsA("TextButton") then
            child:Destroy()
        end
    end

    local ySize = 0
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and (searchText == "" or player.DisplayName:lower():find(searchText) or player.Name:lower():find(searchText)) then
            local btn = Instance.new("TextButton")
            btn.Size = UDim2.new(1, -10, 0, 28)
            btn.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
            btn.Text = player.DisplayName .. " (@" .. player.Name .. ")"
            btn.TextColor3 = Color3.fromRGB(180, 220, 255)
            btn.TextSize = 12
            btn.Font = Enum.Font.Gotham
            btn.TextXAlignment = Enum.TextXAlignment.Left
            btn.Parent = UI.list

            local btnCorner = Instance.new("UICorner")
            btnCorner.CornerRadius = UDim.new(0, 6)
            btnCorner.Parent = btn

            btn.MouseButton1Click:Connect(function()
                if currentTarget == player then
                    stopHeadsit()
                    notify("Stopped sitting")
                else
                    startHeadsit(player, btn)
                end
            end)

            ySize = ySize + 32
        end
    end
    UI.list.CanvasSize = UDim2.new(0, 0, 0, ySize)
end

updatePlayerList("")

UI.searchBox:GetPropertyChangedSignal("Text"):Connect(function()
    updatePlayerList(UI.searchBox.Text)
end)

Players.PlayerAdded:Connect(function() updatePlayerList(UI.searchBox.Text) end)
Players.PlayerRemoving:Connect(function(p)
    if p == currentTarget then
        stopHeadsit()
    end
    updatePlayerList(UI.searchBox.Text)
end)

-- Draggable + Close + Toggle (same as before)
local frameDragging = false
local dragStart, frameStart
UI.frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        frameDragging = true
        dragStart = input.Position
        frameStart = UI.frame.Position
    end
end)
UI.frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then frameDragging = false end
end)
UserInputService.InputChanged:Connect(function(input)
    if frameDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        UI.frame.Position = UDim2.new(frameStart.X.Scale, frameStart.X.Offset + delta.X, frameStart.Y.Scale, frameStart.Y.Offset + delta.Y)
    end
end)

UI.close.MouseButton1Click:Connect(function()
    stopHeadsit()
    UI.gui:Destroy()
end)

UserInputService.InputBegan:Connect(function(input, gp)
    if not gp and input.KeyCode == toggleKey then
        uiVisible = not uiVisible
        UI.gui.Enabled = uiVisible
    end
end)]],
    ["Rewind"] = [[-- Time Rewind Script - FULLY FIXED & WORKING (No errors, sliders work, keybind reliable)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local recording = true
local rewinding = false
local positionHistory = {}
local currentToggleKey = Enum.KeyCode.E
local rewindSpeed = 5
local RECORD_RATE = 0.03
local RECORD_DURATION = 5
local maxHistorySize = math.floor(RECORD_DURATION / RECORD_RATE)
local changingKey = false

-- CUSTOM LOGO
local CUSTOM_LOGO_ID = "rbxassetid://121639913593521"

local function notify(message)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Time Rewind";
        Text = message;
        Duration = 2;
    })
end

-- Create UI
local function createUI()
    if PlayerGui:FindFirstChild("TimeRewindUI") then
        PlayerGui.TimeRewindUI:Destroy()
    end

    local gui = Instance.new("ScreenGui")
    gui.Name = "TimeRewindUI"
    gui.ResetOnSpawn = false
    gui.Parent = PlayerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 180, 0, 175)
    frame.Position = UDim2.new(1, -190, 0, 10)
    frame.BackgroundColor3 = Color3.fromRGB(8, 8, 18)
    frame.BackgroundTransparency = 0.35
    frame.BorderSizePixel = 0
    frame.Parent = gui

    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 12)
    mainCorner.Parent = frame

    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(60, 120, 255)
    stroke.Thickness = 1.5
    stroke.Transparency = 0.7
    stroke.Parent = frame

    -- Logo
    local logo = Instance.new("ImageLabel")
    logo.Size = UDim2.new(0, 36, 0, 36)
    logo.Position = UDim2.new(0, 10, 0, 8)
    logo.BackgroundTransparency = 1
    logo.Image = CUSTOM_LOGO_ID
    logo.Parent = frame

    -- Title
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -60, 0, 28)
    title.Position = UDim2.new(0, 52, 0, 10)
    title.BackgroundTransparency = 1
    title.Text = "REWIND"
    title.TextColor3 = Color3.fromRGB(100, 180, 255)
    title.TextSize = 15
    title.Font = Enum.Font.GothamBlack
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = frame

    -- Close
    local close = Instance.new("TextButton")
    close.Size = UDim2.new(0, 24, 0, 24)
    close.Position = UDim2.new(1, -30, 0, 10)
    close.BackgroundTransparency = 1
    close.Text = "Ã—"
    close.TextColor3 = Color3.fromRGB(255, 120, 120)
    close.TextSize = 20
    close.Font = Enum.Font.GothamBold
    close.Parent = frame

    -- Stars Background
    local starsBg = Instance.new("Frame")
    starsBg.Size = UDim2.new(1,0,1,0)
    starsBg.BackgroundTransparency = 1
    starsBg.ZIndex = 1
    starsBg.Parent = frame

    local stars = {}
    for i = 1, 20 do
        local s = Instance.new("Frame")
        s.Size = UDim2.new(0,2,0,2)
        s.BackgroundColor3 = Color3.fromRGB(120, 200, 255)
        s.BorderSizePixel = 0
        s.Position = UDim2.new(math.random(),0,math.random(),0)
        s.ZIndex = 1
        s.Parent = starsBg
        s:SetAttribute("Speed", 0.5 + math.random()/2)
        table.insert(stars, s)
    end
    RunService.RenderStepped:Connect(function(dt)
        for _, s in ipairs(stars) do
            local nx = s.Position.X.Scale - s:GetAttribute("Speed") * dt * 0.3
            if nx < 0 then nx = 1; s.Position = UDim2.new(nx,0,math.random(),0)
            else s.Position = UDim2.new(nx,0,s.Position.Y.Scale,0) end
        end
    end)

    -- Speed Slider
    local speedLabel = Instance.new("TextLabel")
    speedLabel.Size = UDim2.new(1,-28,0,16)
    speedLabel.Position = UDim2.new(0,14,0,82)
    speedLabel.BackgroundTransparency = 1
    speedLabel.Text = "Speed: 5.0x"
    speedLabel.TextColor3 = Color3.fromRGB(180,220,255)
    speedLabel.TextSize = 11
    speedLabel.Font = Enum.Font.Gotham
    speedLabel.TextXAlignment = Enum.TextXAlignment.Left
    speedLabel.Parent = frame

    local speedTrack = Instance.new("Frame")
    speedTrack.Size = UDim2.new(1,-28,0,10)
    speedTrack.Position = UDim2.new(0,14,0,100)
    speedTrack.BackgroundColor3 = Color3.fromRGB(30,30,50)
    speedTrack.Parent = frame

    local stCorner = Instance.new("UICorner")
    stCorner.CornerRadius = UDim.new(0,5)
    stCorner.Parent = speedTrack

    local speedFill = Instance.new("Frame")
    speedFill.Size = UDim2.new(0.163,0,1,0)
    speedFill.BackgroundColor3 = Color3.fromRGB(80,140,255)
    speedFill.Parent = speedTrack

    local sfCorner = Instance.new("UICorner")
    sfCorner.CornerRadius = UDim.new(0,5)
    sfCorner.Parent = speedFill

    local speedKnob = Instance.new("Frame")
    speedKnob.Size = UDim2.new(0,16,0,16)
    speedKnob.Position = UDim2.new(0.163, -8, 0, -3)
    speedKnob.BackgroundColor3 = Color3.fromRGB(255,255,255)
    speedKnob.ZIndex = 5
    speedKnob.Parent = speedTrack

    local skCorner = Instance.new("UICorner")
    skCorner.CornerRadius = UDim.new(1,0)
    skCorner.Parent = speedKnob

    local skStroke = Instance.new("UIStroke")
    skStroke.Color = Color3.fromRGB(60,120,255)
    skStroke.Thickness = 2
    skStroke.Parent = speedKnob

    -- Status
    local statusDot = Instance.new("Frame")
    statusDot.Size = UDim2.new(0, 10, 0, 10)
    statusDot.Position = UDim2.new(0, 14, 0, 56)
    statusDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    statusDot.Parent = frame

    local dotCorner = Instance.new("UICorner")
    dotCorner.CornerRadius = UDim.new(1, 0)
    dotCorner.Parent = statusDot

    local statusLabel = Instance.new("TextLabel")
    statusLabel.Size = UDim2.new(1, -40, 0, 16)
    statusLabel.Position = UDim2.new(0, 30, 0, 56)
    statusLabel.BackgroundTransparency = 1
    statusLabel.Text = "Recording"
    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    statusLabel.TextSize = 11
    statusLabel.Font = Enum.Font.GothamBold
    statusLabel.TextXAlignment = Enum.TextXAlignment.Left
    statusLabel.Parent = frame

    -- Keybind
    local keyLabel = Instance.new("TextLabel")
    keyLabel.Size = UDim2.new(1,-28,0,18)
    keyLabel.Position = UDim2.new(0,14,1,-22)
    keyLabel.BackgroundTransparency = 1
    keyLabel.Text = "Key: " .. currentToggleKey.Name
    keyLabel.TextColor3 = Color3.fromRGB(160,200,255)
    keyLabel.TextSize = 11
    keyLabel.Font = Enum.Font.Gotham
    keyLabel.TextXAlignment = Enum.TextXAlignment.Left
    keyLabel.Parent = frame

    return {
        frame = frame,
        gui = gui,
        speedLabel = speedLabel,
        speedTrack = speedTrack,
        speedFill = speedFill,
        speedKnob = speedKnob,
        keyLabel = keyLabel,
        close = close,
        statusLabel = statusLabel,
        statusDot = statusDot
    }
end

local UI = createUI()

-- Slider Logic - FIXED
local speedDragging = false

UI.speedKnob.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        speedDragging = true
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        speedDragging = false
    end
end)

RunService.RenderStepped:Connect(function()
    if speedDragging then
        local mouse = LocalPlayer:GetMouse()
        local relativePos = math.clamp(mouse.X - UI.speedTrack.AbsolutePosition.X, 0, UI.speedTrack.AbsoluteSize.X)
        local percent = relativePos / UI.speedTrack.AbsoluteSize.X

        UI.speedKnob.Position = UDim2.new(0, relativePos - 8, 0, -3)
        UI.speedFill.Size = UDim2.new(percent, 0, 1, 0)

        rewindSpeed = 1 + percent * 29
        UI.speedLabel.Text = string.format("Speed: %.1fx", rewindSpeed)
    end
end)

-- Initial slider position
local initPercent = (rewindSpeed - 1) / 29
UI.speedKnob.Position = UDim2.new(initPercent, -8, 0, -3)
UI.speedFill.Size = UDim2.new(initPercent, 0, 1, 0)

-- Keybind changer - FIXED (single connection)
local keyConnection
local function connectKeyListener()
    if keyConnection then keyConnection:Disconnect() end
    keyConnection = UserInputService.InputBegan:Connect(function(input, gp)
        if changingKey and input.UserInputType == Enum.UserInputType.Keyboard then
            currentToggleKey = input.KeyCode
            UI.keyLabel.Text = "Key: " .. currentToggleKey.Name
            UI.keyLabel.TextColor3 = Color3.fromRGB(160,200,255)
            changingKey = false
            notify("Key changed to: " .. currentToggleKey.Name)
        elseif not gp and input.KeyCode == currentToggleKey then
            if rewinding then
                rewinding = false
                recording = true
                if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                    LocalPlayer.Character.HumanoidRootPart.Anchored = false
                end
                UI.statusLabel.Text = "Recording"
                UI.statusDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
            else
                task.spawn(function()
                    if #positionHistory == 0 then
                        notify("No history!")
                        return
                    end
                    rewinding = true
                    recording = false
                    UI.statusLabel.Text = "Rewinding"
                    UI.statusDot.BackgroundColor3 = Color3.fromRGB(200, 200, 200)

                    local character = LocalPlayer.Character
                    if not character then return end
                    local hrp = character:FindFirstChild("HumanoidRootPart")
                    if not hrp then return end
                    hrp.Anchored = true

                    for i = #positionHistory, 1, -1 do
                        if not rewinding then break end
                        local data = positionHistory[i]
                        hrp.CFrame = CFrame.new(data.Position) * data.Rotation
                        task.wait(RECORD_RATE / rewindSpeed)
                    end

                    hrp.Anchored = false
                    positionHistory = {}

                    rewinding = false
                    recording = true
                    UI.statusLabel.Text = "Recording"
                    UI.statusDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
                end)
            end
        end
    end)
end

connectKeyListener()

-- Click label to change key
UI.keyLabel.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        changingKey = true
        UI.keyLabel.Text = "Key: Press any..."
        UI.keyLabel.TextColor3 = Color3.fromRGB(100,255,100)
    end
end)

-- Record positions
RunService.Heartbeat:Connect(function()
    if recording and not rewinding and LocalPlayer.Character then
        local hrp = LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
        if hrp then
            table.insert(positionHistory, {
                Position = hrp.CFrame.Position,
                Rotation = hrp.CFrame - hrp.CFrame.Position
            })
            if #positionHistory > maxHistorySize then
                table.remove(positionHistory, 1)
            end
        end
    end
end)

-- Draggable (no conflict)
local frameDragging = false
local dragStart, frameStart
UI.frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 and not speedDragging then
        frameDragging = true
        dragStart = input.Position
        frameStart = UI.frame.Position
    end
end)
UI.frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then frameDragging = false end
end)
UserInputService.InputChanged:Connect(function(input)
    if frameDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        UI.frame.Position = UDim2.new(frameStart.X.Scale, frameStart.X.Offset + delta.X, frameStart.Y.Scale, frameStart.Y.Offset + delta.Y)
    end
end)

-- Close
UI.close.MouseButton1Click:Connect(function()
    UI.gui:Destroy()
end)
]],
    ["Touch Fling"] = [[local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local flingActive = false

-- Anti-detection
if not ReplicatedStorage:FindFirstChild("juisdfj0i32i0eidsuf0iok") then
    local detection = Instance.new("Decal")
    detection.Name = "juisdfj0ii32i0eidsuf0iok"
    detection.Parent = ReplicatedStorage
end

-- Create simple UI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "TouchFlingSimpleUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = PlayerGui

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 180, 0, 140)
frame.Position = UDim2.new(0, 20, 0, 20)
frame.BackgroundColor3 = Color3.fromRGB(100, 180, 255)
frame.BackgroundTransparency = 0.35
frame.BorderSizePixel = 0
frame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 12)
corner.Parent = frame

local stroke = Instance.new("UIStroke")
stroke.Color = Color3.fromRGB(60, 120, 255)
stroke.Thickness = 1.5
stroke.Transparency = 0.7
stroke.Parent = frame

-- Your Logo (top left)
local logo = Instance.new("ImageLabel")
logo.Size = UDim2.new(0, 36, 0, 36)
logo.Position = UDim2.new(0, 12, 0, 8)
logo.BackgroundTransparency = 1
logo.Image = "rbxassetid://121639913593521"  -- Your custom logo from the rewind script
logo.Parent = frame

-- Title (moved right to make space for logo)
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -100, 0, 30)
title.Position = UDim2.new(0, 55, 0, 8)
title.BackgroundTransparency = 1
title.Text = "TOUCH FLING"
title.TextColor3 = Color3.fromRGB(0, 191, 255)
title.TextSize = 16
title.Font = Enum.Font.GothamBlack
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = frame

-- Toggle button
local toggleBtn = Instance.new("TextButton")
toggleBtn.Size = UDim2.new(0, 150, 0, 40)
toggleBtn.Position = UDim2.new(0.5, -75, 0, 50)
toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 191, 255)
toggleBtn.Text = "OFF"
toggleBtn.TextColor3 = Color3.new(1, 1, 1)
toggleBtn.TextSize = 18
toggleBtn.Font = Enum.Font.GothamBold
toggleBtn.Parent = frame

local btnCorner = Instance.new("UICorner")
btnCorner.CornerRadius = UDim.new(0, 8)
btnCorner.Parent = toggleBtn

-- Note text
local note = Instance.new("TextLabel")
note.Size = UDim2.new(1, -30, 0, 20)
note.Position = UDim2.new(0, 15, 1, -30)
note.BackgroundTransparency = 1
note.Text = "Only works in games with collide"
note.TextColor3 = Color3.fromRGB(150, 150, 150)
note.TextSize = 11
note.Font = Enum.Font.Gotham
note.Parent = frame

-- Close button
local close = Instance.new("TextButton")
close.Size = UDim2.new(0, 24, 0, 24)
close.Position = UDim2.new(1, -32, 0, 10)
close.BackgroundTransparency = 1
close.Text = "Ã—"
close.TextColor3 = Color3.fromRGB(255, 120, 120)
close.TextSize = 22
close.Font = Enum.Font.GothamBold
close.Parent = frame

-- Slower, more random stars background
local starsBg = Instance.new("Frame")
starsBg.Size = UDim2.new(1,0,1,0)
starsBg.BackgroundTransparency = 1
starsBg.ZIndex = 0
starsBg.Parent = frame

local stars = {}
for i = 1, 15 do
    local s = Instance.new("Frame")
    s.Size = UDim2.new(0, math.random(1,3), 0, math.random(1,3))  -- Slight size variation
    s.BackgroundColor3 = Color3.fromRGB(120, 200, 255)
    s.BorderSizePixel = 0
    s.Position = UDim2.new(math.random(), 0, math.random(), 0)
    s.ZIndex = 0
    s.Parent = starsBg
    
    -- Random speed for each star (slower overall)
    s:SetAttribute("Speed", 5 + math.random() * 15)  -- 5 to 20 pixels per second
    
    table.insert(stars, s)
end

RunService.RenderStepped:Connect(function(dt)
    for _, s in ipairs(stars) do
        local speed = s:GetAttribute("Speed")
        local nx = s.Position.X.Scale - speed * dt * 0.01  -- Much slower movement
        if nx < -0.1 then
            nx = 1.1
            s.Position = UDim2.new(nx, 0, math.random(0, 100) / 100, 0)
        else
            s.Position = UDim2.new(nx, 0, s.Position.Y.Scale, 0)
        end
    end
end)

-- Toggle functionality
toggleBtn.MouseButton1Click:Connect(function()
    flingActive = not flingActive
    toggleBtn.Text = flingActive and "ON" or "OFF"
    toggleBtn.BackgroundColor3 = flingActive and Color3.fromRGB(100, 200, 100) or Color3.fromRGB(80, 140, 255)
end)

-- Fling loop
task.spawn(function()
    while task.wait() do
        if flingActive then
            local char = LocalPlayer.Character
            local hrp = char and char:FindFirstChild("HumanoidRootPart")
            if hrp then
                local vel = hrp.Velocity
                hrp.Velocity = vel * 10000 + Vector3.new(0, 10000, 0)
                RunService.RenderStepped:Wait()
                hrp.Velocity = vel
                RunService.Stepped:Wait()
                hrp.Velocity = vel
            end
        end
    end
end)

-- Draggable
local dragging = false
local dragStart, startPos

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
    end
end)

frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Close
close.MouseButton1Click:Connect(function()
    flingActive = false
    screenGui:Destroy()
end)]],
    ["invisible"] = [[-- KzK INVISIBLE UI - TRIP STYLE (NO SLIDERS)
-- UI by Kiko, rewritten in Trip-UI format

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local player = Players.LocalPlayer

-- SETTINGS
local keybind = Enum.KeyCode.C
local CUSTOM_LOGO_ID = "rbxassetid://114664541692510"

-- === INVISIBILITY ENGINE (your original logic, cleaned but unchanged) ===
local RealCharacter = player.Character or player.CharacterAdded:Wait()
local IsInvisible = false
local CanInvis = true

RealCharacter.Archivable = true
local FakeCharacter = RealCharacter:Clone()

local Part = Instance.new("Part", workspace)
Part.Anchored = true
Part.Size = Vector3.new(200, 1, 200)
Part.CFrame = CFrame.new(0, -500, 0)
Part.CanCollide = true

FakeCharacter.Parent = workspace
FakeCharacter.HumanoidRootPart.CFrame = Part.CFrame * CFrame.new(0, 5, 0)

for _, v in pairs(RealCharacter:GetChildren()) do
    if v:IsA("LocalScript") then
        local clone = v:Clone()
        clone.Disabled = true
        clone.Parent = FakeCharacter
    end
end

for _, v in pairs(FakeCharacter:GetDescendants()) do
    if v:IsA("BasePart") then
        v.Transparency = 0.7
    end
end

local PseudoAnchor = FakeCharacter.HumanoidRootPart

RunService.RenderStepped:Connect(function()
    if PseudoAnchor then
        PseudoAnchor.CFrame = Part.CFrame * CFrame.new(0, 5, 0)
    end
end)

local function ToggleInvisible()
    if not RealCharacter or not FakeCharacter then return end

    if not IsInvisible then
        local stored = RealCharacter.HumanoidRootPart.CFrame
        RealCharacter.HumanoidRootPart.CFrame = FakeCharacter.HumanoidRootPart.CFrame
        FakeCharacter.HumanoidRootPart.CFrame = stored

        RealCharacter.Humanoid:UnequipTools()
        player.Character = FakeCharacter
        workspace.CurrentCamera.CameraSubject = FakeCharacter.Humanoid
        PseudoAnchor = RealCharacter.HumanoidRootPart

        for _, v in pairs(FakeCharacter:GetChildren()) do
            if v:IsA("LocalScript") then v.Disabled = false end
        end

        IsInvisible = true
    else
        local stored = FakeCharacter.HumanoidRootPart.CFrame
        FakeCharacter.HumanoidRootPart.CFrame = RealCharacter.HumanoidRootPart.CFrame
        RealCharacter.HumanoidRootPart.CFrame = stored

        FakeCharacter.Humanoid:UnequipTools()
        player.Character = RealCharacter
        workspace.CurrentCamera.CameraSubject = RealCharacter.Humanoid
        PseudoAnchor = FakeCharacter.HumanoidRootPart

        for _, v in pairs(FakeCharacter:GetChildren()) do
            if v:IsA("LocalScript") then v.Disabled = true end
        end

        IsInvisible = false
    end
end

UserInputService.InputBegan:Connect(function(input, gp)
    if not gp and input.KeyCode == keybind then
        ToggleInvisible()
    end
end)

-- === UI START ===
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "InvisibleUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 180, 0, 150)
frame.Position = UDim2.new(1, -190, 0, 10)
frame.BackgroundColor3 = Color3.fromRGB(10, 10, 20)
frame.BackgroundTransparency = 0.3
frame.BorderSizePixel = 0
frame.Parent = screenGui

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(0, 10)
corner.Parent = frame

-- Logo
local logo = Instance.new("ImageLabel")
logo.Size = UDim2.new(0, 35, 0, 35)
logo.Position = UDim2.new(0, 8, 0, 6)
logo.BackgroundTransparency = 1
logo.Image = CUSTOM_LOGO_ID
logo.Parent = frame

-- Stars BG
local starsBG = Instance.new("Frame")
starsBG.Size = UDim2.new(1, 0, 1, 0)
starsBG.BackgroundTransparency = 1
starsBG.ZIndex = 0
starsBG.Parent = frame

local stars = {}
for i = 1, 20 do
    local s = Instance.new("Frame")
    s.Size = UDim2.new(0, 2, 0, 2)
    s.BackgroundColor3 = Color3.fromRGB(100, 180, 255)
    s.BorderSizePixel = 0
    s.Position = UDim2.new(math.random(), 0, math.random(), 0)
    s.Parent = starsBG
    s:SetAttribute("Speed", math.random(50, 150) / 100)
    table.insert(stars, s)
end

RunService.RenderStepped:Connect(function(dt)
    for _, star in ipairs(stars) do
        local speed = star:GetAttribute("Speed")
        local newX = star.Position.X.Scale - (0.4 * speed * dt)
        if newX < 0 then
            newX = 1 + newX
            star.Position = UDim2.new(newX, 0, math.random(), 0)
        else
            star.Position = UDim2.new(newX, 0, star.Position.Y.Scale, 0)
        end
    end
end)

-- Title
local title = Instance.new("TextLabel")
title.Size = UDim2.new(1, -60, 0, 25)
title.Position = UDim2.new(0, 50, 0, 8)
title.BackgroundTransparency = 1
title.Text = "INVISIBLE"
title.TextColor3 = Color3.fromRGB(100, 180, 255)
title.TextSize = 14
title.Font = Enum.Font.GothamBold
title.TextXAlignment = Enum.TextXAlignment.Left
title.Parent = frame

-- Close
local close = Instance.new("TextButton")
close.Size = UDim2.new(0, 22, 0, 22)
close.Position = UDim2.new(1, -28, 0, 6)
close.BackgroundTransparency = 1
close.Text = "X"
close.TextColor3 = Color3.fromRGB(255, 100, 100)
close.Font = Enum.Font.GothamBold
close.TextSize = 16
close.Parent = frame
close.MouseButton1Click:Connect(function() screenGui:Destroy() end)

-- Toggle Button
local toggleButton = Instance.new("TextButton")
toggleButton.Size = UDim2.new(1, -30, 0, 32)
toggleButton.Position = UDim2.new(0, 15, 0, 50)
toggleButton.BackgroundColor3 = Color3.fromRGB(60, 120, 255)
toggleButton.Text = "Go Invisible"
toggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleButton.TextSize = 13
toggleButton.Font = Enum.Font.GothamBold
toggleButton.Parent = frame

local tbC = Instance.new("UICorner")
tbC.CornerRadius = UDim.new(0, 6)
tbC.Parent = toggleButton

toggleButton.MouseButton1Click:Connect(function()
    ToggleInvisible()
    toggleButton.Text = IsInvisible and "Become Visible" or "Go Invisible"
end)

-- Keybind Label
local keyLabel = Instance.new("TextLabel")
keyLabel.Size = UDim2.new(1, -20, 0, 16)
keyLabel.Position = UDim2.new(0, 10, 0, 90)
keyLabel.BackgroundTransparency = 1
keyLabel.Text = "Keybind: " .. keybind.Name
keyLabel.TextColor3 = Color3.fromRGB(200, 220, 255)
keyLabel.TextSize = 11
keyLabel.Font = Enum.Font.Gotham
keyLabel.TextXAlignment = Enum.TextXAlignment.Left
keyLabel.Parent = frame

-- Keybind Button
local keyButton = Instance.new("TextButton")
keyButton.Size = UDim2.new(1, -30, 0, 22)
keyButton.Position = UDim2.new(0, 15, 0, 110)
keyButton.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
keyButton.Text = "Change key"
keyButton.TextColor3 = Color3.fromRGB(180, 220, 255)
keyButton.TextSize = 10
keyButton.Font = Enum.Font.Gotham
keyButton.Parent = frame

local kbC2 = Instance.new("UICorner")
kbC2.CornerRadius = UDim.new(0, 5)
kbC2.Parent = keyButton

local changing = false
keyButton.MouseButton1Click:Connect(function()
    if changing then return end
    changing = true
    keyButton.Text = "Press key..."
    keyButton.BackgroundColor3 = Color3.fromRGB(60, 120, 255)
end)

UserInputService.InputBegan:Connect(function(input, gp)
    if changing and input.UserInputType == Enum.UserInputType.Keyboard then
        keybind = input.KeyCode
        keyLabel.Text = "Keybind: " .. keybind.Name
        keyButton.Text = "Change key"
        keyButton.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
        changing = false
    end
end)

-- Draggable
local dragging = false
local dragStart, startPos

frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
    end
end)

frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)


]],
    ["Fit Changer"] = [[local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local StarterGui = game:GetService("StarterGui")
local UserInputService = game:GetService("UserInputService")

local localPlayer = Players.LocalPlayer
local playerGui = localPlayer:WaitForChild("PlayerGui")

-- Notification helper
local function notify(title, text, duration)
    pcall(function()
        StarterGui:SetCore("SendNotification", {
            Title = title,
            Text = text,
            Duration = duration or 4
        })
    end)
end

-- Particle morph effect (blue sparkles)
local function applyMorphEffect(character)
    local root = character:FindFirstChild("HumanoidRootPart")
    if not root then return end

    local emitter = Instance.new("ParticleEmitter")
    emitter.Texture = "rbxassetid://243098098"  -- blue sparkles
    emitter.Rate = 50
    emitter.Lifetime = NumberRange.new(0.5, 1)
    emitter.Speed = NumberRange.new(5, 10)
    emitter.SpreadAngle = Vector2.new(360, 360)
    emitter.Parent = root

    task.delay(2, function()
        emitter.Enabled = false
        task.delay(1, function()
            emitter:Destroy()
        end)
    end)
end

-- Simplified client-side cloning function
local function CloneOutfitClientSide(userId, username)
    local character = localPlayer.Character
    if not character then
        notify("âŒ Error", "Character not found!", 4)
        return false
    end
    
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if not humanoid then
        notify("âŒ Error", "Humanoid not found!", 4)
        return false
    end
    
    local success, description = pcall(function()
        return Players:GetHumanoidDescriptionFromUserId(userId)
    end)
    
    if not success or not description then
        notify("âŒ Error", "Failed to load outfit data!", 4)
        return false
    end
    
    -- Clear current outfit
    for _, item in pairs(character:GetChildren()) do
        if item:IsA("Accessory") or item:IsA("Hat") or item:IsA("Shirt") or item:IsA("Pants") 
            or item:IsA("ShirtGraphic") or item:IsA("BodyColors") or item:IsA("CharacterMesh") then
            item:Destroy()
        end
    end
    
    local head = character:FindFirstChild("Head")
    if head then
        for _, child in pairs(head:GetChildren()) do
            if child:IsA("Decal") or child:IsA("SpecialMesh") then
                if child.Name == "face" or child.Name == "Mesh" then
                    child:Destroy()
                end
            end
        end
    end
    
    -- Apply the new description
    pcall(function()
        humanoid:ApplyDescriptionClientServer(description)
    end)
    
    -- Trigger particle effect
    applyMorphEffect(character)
    
    return true
end

-- Get UserId from username
local function GetUserIdFromUsername(username)
    local success, result = pcall(function()
        return Players:GetUserIdFromNameAsync(username)
    end)
    return success and result or nil
end

-- Main ScreenGui
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "KZKFitCloner"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Size = UDim2.new(0, 420, 0, 550)
MainFrame.Position = UDim2.new(0.5, -210, 0.5, -275)
MainFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 15)
MainFrame.BackgroundTransparency = 0.3
MainFrame.BorderSizePixel = 0
MainFrame.ClipsDescendants = true
MainFrame.Parent = screenGui

local MainCorner = Instance.new("UICorner", MainFrame)
MainCorner.CornerRadius = UDim.new(0, 12)

-- Header
local Header = Instance.new("Frame")
Header.Size = UDim2.new(1, 0, 0, 50)
Header.BackgroundColor3 = Color3.fromRGB(0, 200, 255)
Header.BorderSizePixel = 0
Header.Parent = MainFrame

local HeaderCorner = Instance.new("UICorner", Header)
HeaderCorner.CornerRadius = UDim.new(0, 12)

-- Logo
local Logo = Instance.new("ImageLabel")
Logo.Size = UDim2.new(0, 40, 0, 40)
Logo.Position = UDim2.new(0, 8, 0, 5)
Logo.BackgroundTransparency = 1
Logo.Image = "rbxassetid://121639913593521"
Logo.Parent = Header

-- Title
local Title = Instance.new("TextLabel")
Title.Text = "KZK FIT CLONER"
Title.Size = UDim2.new(1, -140, 1, 0)
Title.Position = UDim2.new(0, 55, 0, 0)
Title.BackgroundTransparency = 1
Title.TextColor3 = Color3.new(255, 255, 255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = Header

-- Minimize Button
local MinimizeBtn = Instance.new("TextButton")
MinimizeBtn.Size = UDim2.new(0, 40, 0, 40)
MinimizeBtn.Position = UDim2.new(1, -85, 0, 5)
MinimizeBtn.BackgroundTransparency = 1
MinimizeBtn.Text = "â€“"
MinimizeBtn.TextColor3 = Color3.new(1, 1, 1)
MinimizeBtn.Font = Enum.Font.GothamBold
MinimizeBtn.TextSize = 34
MinimizeBtn.Parent = Header

-- Close Button
local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0, 40, 0, 40)
CloseBtn.Position = UDim2.new(1, -45, 0, 5)
CloseBtn.BackgroundTransparency = 1
CloseBtn.Text = "Ã—"
CloseBtn.TextColor3 = Color3.new(1, 1, 1)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 30
CloseBtn.Parent = Header

-- Content Frame
local ContentFrame = Instance.new("Frame")
ContentFrame.Size = UDim2.new(1, 0, 1, -50)
ContentFrame.Position = UDim2.new(0, 0, 0, 50)
ContentFrame.BackgroundTransparency = 1
ContentFrame.Parent = MainFrame

-- Inner Panel
local FitGlass = Instance.new("Frame")
FitGlass.Size = UDim2.new(1, 0, 1, 0)
FitGlass.BackgroundColor3 = Color3.fromRGB(10, 10, 15)
FitGlass.BackgroundTransparency = 0.4
FitGlass.BorderSizePixel = 0
FitGlass.Parent = ContentFrame

local FitUICorner = Instance.new("UICorner")
FitUICorner.CornerRadius = UDim.new(0, 20)
FitUICorner.Parent = FitGlass

local FitUIGradient = Instance.new("UIGradient")
FitUIGradient.Color = ColorSequence.new{
    ColorSequenceKeypoint.new(0, Color3.fromRGB(0, 140, 255)),
    ColorSequenceKeypoint.new(1, Color3.fromRGB(0, 80, 200))
}
FitUIGradient.Transparency = NumberSequence.new{
    NumberSequenceKeypoint.new(0, 0.8),
    NumberSequenceKeypoint.new(1, 0.9)
}
FitUIGradient.Rotation = 135
FitUIGradient.Parent = FitGlass

local FitGlassStroke = Instance.new("UIStroke")
FitGlassStroke.Color = Color3.fromRGB(0, 180, 255)
FitGlassStroke.Thickness = 2
FitGlassStroke.Transparency = 0.4
FitGlassStroke.Parent = FitGlass

-- Title & Subtitle
local FitTitle = Instance.new("TextLabel")
FitTitle.Size = UDim2.new(1, -40, 0, 40)
FitTitle.Position = UDim2.new(0, 20, 0, 12)
FitTitle.BackgroundTransparency = 1
FitTitle.Text = "KZK FIT CLONER"
FitTitle.TextColor3 = Color3.fromRGB(0, 200, 255)
FitTitle.Font = Enum.Font.GothamBold
FitTitle.TextSize = 24
FitTitle.TextStrokeTransparency = 0.7
FitTitle.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
FitTitle.Parent = FitGlass

local FitSubtitle = Instance.new("TextLabel")
FitSubtitle.Size = UDim2.new(1, -40, 0, 20)
FitSubtitle.Position = UDim2.new(0, 20, 0, 48)
FitSubtitle.BackgroundTransparency = 1
FitSubtitle.Text = "Fast Client-Side â€¢ Updated"
FitSubtitle.TextColor3 = Color3.fromRGB(100, 180, 255)
FitSubtitle.Font = Enum.Font.Gotham
FitSubtitle.TextSize = 13
FitSubtitle.TextXAlignment = Enum.TextXAlignment.Left
FitSubtitle.Parent = FitGlass

-- Username Input Label
local FitInputLabel = Instance.new("TextLabel")
FitInputLabel.Size = UDim2.new(1, -40, 0, 25)
FitInputLabel.Position = UDim2.new(0, 20, 0, 80)
FitInputLabel.BackgroundTransparency = 1
FitInputLabel.Text = "TARGET USERNAME"
FitInputLabel.TextColor3 = Color3.fromRGB(0, 200, 255)
FitInputLabel.Font = Enum.Font.GothamSemibold
FitInputLabel.TextSize = 14
FitInputLabel.TextXAlignment = Enum.TextXAlignment.Left
FitInputLabel.Parent = FitGlass

-- Username TextBox
local UsernameBox = Instance.new("TextBox")
UsernameBox.Size = UDim2.new(1, -40, 0, 50)
UsernameBox.Position = UDim2.new(0, 20, 0, 110)
UsernameBox.BackgroundColor3 = Color3.fromRGB(15, 15, 25)
UsernameBox.BackgroundTransparency = 0.3
UsernameBox.Text = ""
UsernameBox.PlaceholderText = "Enter username..."
UsernameBox.TextColor3 = Color3.fromRGB(200, 240, 255)
UsernameBox.PlaceholderColor3 = Color3.fromRGB(100, 160, 220)
UsernameBox.TextSize = 16
UsernameBox.Font = Enum.Font.Gotham
UsernameBox.ClearTextOnFocus = false
UsernameBox.Parent = FitGlass

Instance.new("UICorner", UsernameBox).CornerRadius = UDim.new(0, 12)

local BoxStroke = Instance.new("UIStroke")
BoxStroke.Color = Color3.fromRGB(0, 180, 255)
BoxStroke.Thickness = 2
BoxStroke.Transparency = 0.5
BoxStroke.Parent = UsernameBox

UsernameBox.Focused:Connect(function()
    TweenService:Create(BoxStroke, TweenInfo.new(0.3), {Transparency = 0.1}):Play()
    TweenService:Create(UsernameBox, TweenInfo.new(0.3), {BackgroundTransparency = 0.1}):Play()
end)
UsernameBox.FocusLost:Connect(function()
    TweenService:Create(BoxStroke, TweenInfo.new(0.3), {Transparency = 0.5}):Play()
    TweenService:Create(UsernameBox, TweenInfo.new(0.3), {BackgroundTransparency = 0.3}):Play()
end)

-- Clone Button
local CloneButton = Instance.new("TextButton")
CloneButton.Size = UDim2.new(1, -40, 0, 50)
CloneButton.Position = UDim2.new(0, 20, 0, 175)
CloneButton.BackgroundColor3 = Color3.fromRGB(0, 140, 255)
CloneButton.BackgroundTransparency = 0.2
CloneButton.Text = "CLONE OUTFIT"
CloneButton.TextColor3 = Color3.fromRGB(255, 255, 255)
CloneButton.Font = Enum.Font.GothamBold
CloneButton.TextSize = 16
CloneButton.Parent = FitGlass
Instance.new("UICorner", CloneButton).CornerRadius = UDim.new(0, 14)

local CloneBtnStroke = Instance.new("UIStroke")
CloneBtnStroke.Color = Color3.fromRGB(0, 200, 255)
CloneBtnStroke.Thickness = 2
CloneBtnStroke.Transparency = 0.3
CloneBtnStroke.Parent = CloneButton

-- Reset Button
local ResetButton = Instance.new("TextButton")
ResetButton.Size = UDim2.new(1, -40, 0, 45)
ResetButton.Position = UDim2.new(0, 20, 0, 240)
ResetButton.BackgroundColor3 = Color3.fromRGB(0, 80, 160)
ResetButton.BackgroundTransparency = 0.4
ResetButton.Text = "RESET TO ORIGINAL"
ResetButton.TextColor3 = Color3.fromRGB(200, 240, 255)
ResetButton.Font = Enum.Font.GothamBold
ResetButton.TextSize = 14
ResetButton.Parent = FitGlass
Instance.new("UICorner", ResetButton).CornerRadius = UDim.new(0, 14)

local ResetStroke = Instance.new("UIStroke")
ResetStroke.Color = Color3.fromRGB(0, 160, 255)
ResetStroke.Thickness = 2
ResetStroke.Transparency = 0.6
ResetStroke.Parent = ResetButton

-- Status Panel
local StatusFrame = Instance.new("Frame")
StatusFrame.Size = UDim2.new(1, -40, 0, 220)
StatusFrame.Position = UDim2.new(0, 20, 0, 300)
StatusFrame.BackgroundColor3 = Color3.fromRGB(10, 10, 20)
StatusFrame.BackgroundTransparency = 0.4
StatusFrame.Parent = FitGlass
Instance.new("UICorner", StatusFrame).CornerRadius = UDim.new(0, 14)

local StatusStroke = Instance.new("UIStroke")
StatusStroke.Color = Color3.fromRGB(0, 180, 255)
StatusStroke.Thickness = 2
StatusStroke.Transparency = 0.5
StatusStroke.Parent = StatusFrame

local StatusTitle = Instance.new("TextLabel")
StatusTitle.Size = UDim2.new(1, -20, 0, 30)
StatusTitle.Position = UDim2.new(0, 10, 0, 5)
StatusTitle.BackgroundTransparency = 1
StatusTitle.Text = "STATUS"
StatusTitle.TextColor3 = Color3.fromRGB(0, 200, 255)
StatusTitle.Font = Enum.Font.GothamBold
StatusTitle.TextSize = 14
StatusTitle.TextXAlignment = Enum.TextXAlignment.Left
StatusTitle.Parent = StatusFrame

local StatusText = Instance.new("TextLabel")
StatusText.Size = UDim2.new(1, -20, 1, -40)
StatusText.Position = UDim2.new(0, 10, 0, 35)
StatusText.BackgroundTransparency = 1
StatusText.Text = "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nTARGET: None\nSTATUS: Ready\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nâœ“ All Accessories\nâœ“ Hair & Face\nâœ“ Clothing\nâœ“ Body Parts\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
StatusText.TextColor3 = Color3.fromRGB(150, 220, 255)
StatusText.TextSize = 13
StatusText.Font = Enum.Font.Gotham
StatusText.TextXAlignment = Enum.TextXAlignment.Left
StatusText.TextYAlignment = Enum.TextYAlignment.Top
StatusText.Parent = StatusFrame

-- Draggable Logic
local dragging = false
local dragStart = nil
local startPos = nil

local function updateDrag(input)
    local delta = input.Position - dragStart
    MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end

Header.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
        Header.BackgroundColor3 = Color3.fromRGB(0, 100, 220)
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        updateDrag(input)
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        if dragging then
            dragging = false
            Header.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
        end
    end
end)

-- Minimize / Restore
local minimized = false
MinimizeBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {Size = UDim2.new(0, 420, 0, 50)}):Play()
        MinimizeBtn.Text = "+"
        ContentFrame.Visible = false
    else
        TweenService:Create(MainFrame, TweenInfo.new(0.3, Enum.EasingStyle.Quad), {Size = UDim2.new(0, 420, 0, 550)}):Play()
        MinimizeBtn.Text = "â€“"
        ContentFrame.Visible = true
    end
end)

CloseBtn.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Button Hover Effects
CloneButton.MouseEnter:Connect(function()
    TweenService:Create(CloneButton, TweenInfo.new(0.2), {BackgroundTransparency = 0.1}):Play()
end)
CloneButton.MouseLeave:Connect(function()
    TweenService:Create(CloneButton, TweenInfo.new(0.2), {BackgroundTransparency = 0.2}):Play()
end)

-- Clone Button Click
CloneButton.MouseButton1Click:Connect(function()
    local username = UsernameBox.Text:gsub("%s+", "")
    if username == "" then
        notify("âŒ Error", "Please enter a username!", 4)
        return
    end
    
    CloneButton.Text = "CLONING..."
    StatusText.Text = "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nTARGET: " .. username .. "\nSTATUS: Searching user...\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    
    local userId = GetUserIdFromUsername(username)
    if not userId then
        notify("âŒ Error", "User '" .. username .. "' not found!", 4)
        StatusText.Text = "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nTARGET: " .. username .. "\nSTATUS: âŒ Not Found\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        CloneButton.Text = "CLONE OUTFIT"
        return
    end
    
    StatusText.Text = "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nTARGET: " .. username .. "\nID: " .. userId .. "\nSTATUS: Cloning...\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    
    local success = CloneOutfitClientSide(userId, username)
    
    if success then
        StatusText.Text = "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nTARGET: " .. username .. "\nSTATUS: âœ… SUCCESS!\n\nOutfit cloned (client-side)\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        notify("âœ… Success", "Cloned " .. username .. "'s outfit!", 4)
    else
        StatusText.Text = "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nTARGET: " .. username .. "\nSTATUS: âŒ Failed\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    end
    
    CloneButton.Text = "CLONE OUTFIT"
end)

-- Reset Button Click
ResetButton.MouseButton1Click:Connect(function()
    ResetButton.Text = "RESETTING..."
    local success = CloneOutfitClientSide(localPlayer.UserId, localPlayer.Name)
    ResetButton.Text = "RESET TO ORIGINAL"
    
    if success then
        StatusText.Text = "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nSTATUS: âœ… Reset Complete\n\nBack to your original fit\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
        notify("âœ… Success", "Outfit reset to original!", 4)
        if localPlayer.Character then
            applyMorphEffect(localPlayer.Character)
        end
    else
        StatusText.Text = "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nSTATUS: âŒ Reset Failed\n\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
    end
end)]],
    ["NoClip"] = [[-- Noclip Script - Modern UI Style (GUARANTEED WORKING - Simplified & Bulletproof)
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")

local noclipEnabled = false
local noclipConnection = nil
local currentToggleKey = Enum.KeyCode.N
local changingKey = false

-- CUSTOM LOGO
local CUSTOM_LOGO_ID = "rbxassetid://121639913593521"

local function notify(message)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Noclip";
        Text = message;
        Duration = 2;
    })
end

-- Toggle Noclip (SIMPLE & RELIABLE - no restoring collisions needed)
local function toggleNoclip()
    noclipEnabled = not noclipEnabled
    
    if noclipConnection then
        noclipConnection:Disconnect()
        noclipConnection = nil
    end
    
    if noclipEnabled then
        -- ON: Continuously set CanCollide = false every frame
        noclipConnection = RunService.Stepped:Connect(function()
            if LocalPlayer.Character then
                for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                    if part:IsA("BasePart") then
                        part.CanCollide = false
                    end
                end
            end
        end)
        notify("Noclip ON - Fly through walls!")
    else
        -- OFF: Just stop the loop - normal collisions return automatically
        notify("Noclip OFF - Normal collisions")
    end
end

-- Create UI (same modern style)
local function createUI()
    if PlayerGui:FindFirstChild("NoclipUI") then
        PlayerGui.NoclipUI:Destroy()
    end

    local gui = Instance.new("ScreenGui")
    gui.Name = "NoclipUI"
    gui.ResetOnSpawn = false
    gui.Parent = PlayerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 180, 0, 175)
    frame.Position = UDim2.new(1, -190, 0, 10)
    frame.BackgroundColor3 = Color3.fromRGB(8, 8, 18)
    frame.BackgroundTransparency = 0.35
    frame.BorderSizePixel = 0
    frame.Parent = gui

    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 12)
    mainCorner.Parent = frame

    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(60, 120, 255)
    stroke.Thickness = 1.5
    stroke.Transparency = 0.7
    stroke.Parent = frame

    -- Logo
    local logo = Instance.new("ImageLabel")
    logo.Size = UDim2.new(0, 36, 0, 36)
    logo.Position = UDim2.new(0, 10, 0, 8)
    logo.BackgroundTransparency = 1
    logo.Image = CUSTOM_LOGO_ID
    logo.Parent = frame

    -- Title
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -60, 0, 28)
    title.Position = UDim2.new(0, 52, 0, 10)
    title.BackgroundTransparency = 1
    title.Text = "NOCLIP"
    title.TextColor3 = Color3.fromRGB(100, 180, 255)
    title.TextSize = 15
    title.Font = Enum.Font.GothamBlack
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = frame

    -- Close Button
    local close = Instance.new("TextButton")
    close.Size = UDim2.new(0, 24, 0, 24)
    close.Position = UDim2.new(1, -30, 0, 10)
    close.BackgroundTransparency = 1
    close.Text = "Ã—"
    close.TextColor3 = Color3.fromRGB(255, 120, 120)
    close.TextSize = 20
    close.Font = Enum.Font.GothamBold
    close.Parent = frame

    -- Stars Background
    local starsBg = Instance.new("Frame")
    starsBg.Size = UDim2.new(1,0,1,0)
    starsBg.BackgroundTransparency = 1
    starsBg.ZIndex = 1
    starsBg.Parent = frame

    local stars = {}
    for i = 1, 20 do
        local s = Instance.new("Frame")
        s.Size = UDim2.new(0,2,0,2)
        s.BackgroundColor3 = Color3.fromRGB(120, 200, 255)
        s.BorderSizePixel = 0
        s.Position = UDim2.new(math.random(),0,math.random(),0)
        s.ZIndex = 1
        s.Parent = starsBg
        s:SetAttribute("Speed", 0.5 + math.random()/2)
        table.insert(stars, s)
    end
    RunService.RenderStepped:Connect(function(dt)
        for _, s in ipairs(stars) do
            local nx = s.Position.X.Scale - s:GetAttribute("Speed") * dt * 0.3
            if nx < 0 then 
                nx = 1 
                s.Position = UDim2.new(nx,0,math.random(),0)
            else 
                s.Position = UDim2.new(nx,0,s.Position.Y.Scale,0) 
            end
        end
    end)

    -- Status Dot & Label
    local statusDot = Instance.new("Frame")
    statusDot.Size = UDim2.new(0, 10, 0, 10)
    statusDot.Position = UDim2.new(0, 14, 0, 56)
    statusDot.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    statusDot.Parent = frame

    local dotCorner = Instance.new("UICorner")
    dotCorner.CornerRadius = UDim.new(1, 0)
    dotCorner.Parent = statusDot

    local statusLabel = Instance.new("TextLabel")
    statusLabel.Size = UDim2.new(1, -40, 0, 16)
    statusLabel.Position = UDim2.new(0, 30, 0, 56)
    statusLabel.BackgroundTransparency = 1
    statusLabel.Text = "OFF"
    statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
    statusLabel.TextSize = 11
    statusLabel.Font = Enum.Font.GothamBold
    statusLabel.TextXAlignment = Enum.TextXAlignment.Left
    statusLabel.Parent = frame

    -- Toggle Button
    local toggleBtn = Instance.new("TextButton")
    toggleBtn.Size = UDim2.new(0, 140, 0, 36)
    toggleBtn.Position = UDim2.new(0.5, -70, 0, 82)
    toggleBtn.BackgroundColor3 = Color3.fromRGB(80, 140, 255)
    toggleBtn.Text = "OFF"
    toggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
    toggleBtn.TextSize = 14
    toggleBtn.Font = Enum.Font.GothamBold
    toggleBtn.Parent = frame

    local btnCorner = Instance.new("UICorner")
    btnCorner.CornerRadius = UDim.new(0, 8)
    btnCorner.Parent = toggleBtn

    local btnStroke = Instance.new("UIStroke")
    btnStroke.Color = Color3.fromRGB(255, 255, 255)
    btnStroke.Thickness = 1
    btnStroke.Parent = toggleBtn

    -- Keybind Label
    local keyLabel = Instance.new("TextLabel")
    keyLabel.Size = UDim2.new(1,-28,0,18)
    keyLabel.Position = UDim2.new(0,14,1,-22)
    keyLabel.BackgroundTransparency = 1
    keyLabel.Text = "Key: " .. currentToggleKey.Name
    keyLabel.TextColor3 = Color3.fromRGB(160,200,255)
    keyLabel.TextSize = 11
    keyLabel.Font = Enum.Font.Gotham
    keyLabel.TextXAlignment = Enum.TextXAlignment.Left
    keyLabel.Parent = frame

    -- Update UI function
    local function updateUI()
        if noclipEnabled then
            statusLabel.Text = "ON"
            statusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
            statusDot.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
            toggleBtn.Text = "ON"
            toggleBtn.BackgroundColor3 = Color3.fromRGB(0, 200, 0)
        else
            statusLabel.Text = "OFF"
            statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
            statusDot.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
            toggleBtn.Text = "OFF"
            toggleBtn.BackgroundColor3 = Color3.fromRGB(80, 140, 255)
        end
    end

    toggleBtn.MouseButton1Click:Connect(function()
        toggleNoclip()
        updateUI()
    end)

    return {
        frame = frame,
        gui = gui,
        keyLabel = keyLabel,
        close = close,
        updateUI = updateUI
    }
end

local UI = createUI()
UI.updateUI()  -- Initial state

-- Keybind System
local keyConnection
local function connectKeyListener()
    if keyConnection then keyConnection:Disconnect() end
    keyConnection = UserInputService.InputBegan:Connect(function(input, gp)
        if changingKey and input.UserInputType == Enum.UserInputType.Keyboard then
            currentToggleKey = input.KeyCode
            UI.keyLabel.Text = "Key: " .. currentToggleKey.Name
            UI.keyLabel.TextColor3 = Color3.fromRGB(160,200,255)
            changingKey = false
            notify("Key changed to: " .. currentToggleKey.Name)
            connectKeyListener()  -- Reconnect with new key
            return
        elseif not gp and input.KeyCode == currentToggleKey then
            toggleNoclip()
            UI.updateUI()
        end
    end)
end

connectKeyListener()

-- Change keybind
UI.keyLabel.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        changingKey = true
        UI.keyLabel.Text = "Key: Press any..."
        UI.keyLabel.TextColor3 = Color3.fromRGB(100,255,100)
    end
end)

-- Draggable
local frameDragging = false
local dragStart, frameStart
UI.frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        frameDragging = true
        dragStart = input.Position
        frameStart = UI.frame.Position
    end
end)
UI.frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then 
        frameDragging = false 
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if frameDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        UI.frame.Position = UDim2.new(frameStart.X.Scale, frameStart.X.Offset + delta.X, frameStart.Y.Scale, frameStart.Y.Offset + delta.Y)
    end
end)

-- Close
UI.close.MouseButton1Click:Connect(function()
    if noclipConnection then
        noclipConnection:Disconnect()
    end
    UI.gui:Destroy()
end)

-- Handle character respawn (auto-disable on death)
LocalPlayer.CharacterAdded:Connect(function()
    if noclipEnabled then
        wait(1)  -- Wait for character to fully load
        noclipEnabled = false
        UI.updateUI()
    end
end)]],
    ["Infinite Baseplate"] = [[-- INSTANT Infinite Baseplate Script - BIGGER CHUNKS
-- Chunks are now 4096 studs wide â†’ much bigger & fewer visible seams

local Players = game:GetService("Players")
local player = Players.LocalPlayer

-- Settings
local chunkSize = 2048          -- â† Bigger value = larger chunks / fewer seams
local renderDistance = 3
local loadedChunks = {}
local baseplateFolder = nil

-- Find existing baseplate to match its look
local baseplateTemplate = nil
local possibleNames = {"Baseplate", "Base", "Ground", "Floor", "SpawnLocation", "Part"}
for _, name in ipairs(possibleNames) do
    local part = workspace:FindFirstChild(name, true)
    if part and part:IsA("BasePart") and part.Size.Y <= 50 then
        baseplateTemplate = part
        break
    end
end

-- Fallback to classic Roblox grass if nothing found
if not baseplateTemplate then
    baseplateTemplate = Instance.new("Part")
    baseplateTemplate.Size = Vector3.new(512, 20, 512)
    baseplateTemplate.Color = Color3.fromRGB(115, 231, 117)
    baseplateTemplate.Material = Enum.Material.Grass
    baseplateTemplate.Anchored = true
end

-- Create folder for our chunks
baseplateFolder = Instance.new("Folder")
baseplateFolder.Name = "InfiniteBaseplate"
baseplateFolder.Parent = workspace

local function getChunkPos(x, z)
    return math.floor(x / chunkSize), math.floor(z / chunkSize)
end

local function createChunk(chunkX, chunkZ)
    local key = chunkX .. "_" .. chunkZ
    if loadedChunks[key] then return end

    local chunk = baseplateTemplate:Clone()
    chunk.Name = "Chunk_" .. key
    chunk.Size = Vector3.new(chunkSize, baseplateTemplate.Size.Y, chunkSize)
    chunk.CFrame = CFrame.new(
        chunkX * chunkSize + chunkSize / 2,
        baseplateTemplate.Position.Y,
        chunkZ * chunkSize + chunkSize / 2
    )
    chunk.Anchored = true
    chunk.CanCollide = true
    chunk.Parent = baseplateFolder

    loadedChunks[key] = chunk
end

local function removeDistantChunks(playerX, playerZ)
    local px, pz = getChunkPos(playerX, playerZ)

    for key, chunk in pairs(loadedChunks) do
        local cx, cz = key:match("([^_]+)_([^_]+)")
        cx, cz = tonumber(cx), tonumber(cz)

        local distX = math.abs(cx - px)
        local distZ = math.abs(cz - pz)

        if distX > renderDistance + 1 or distZ > renderDistance + 1 then
            chunk:Destroy()
            loadedChunks[key] = nil
        end
    end
end

local function updateChunks()
    local char = player.Character
    if not char or not char:FindFirstChild("HumanoidRootPart") then return end

    local pos = char.HumanoidRootPart.Position
    local px, pz = getChunkPos(pos.X, pos.Z)

    -- Load nearby chunks
    for x = -renderDistance, renderDistance do
        for z = -renderDistance, renderDistance do
            createChunk(px + x, pz + z)
        end
    end

    -- Clean up far chunks
    removeDistantChunks(pos.X, pos.Z)
end

-- Start the loop immediately
spawn(function()
    while true do
        updateChunks()
        task.wait(0.3)
    end
end)

-- Load initial chunks when character spawns
player.CharacterAdded:Connect(function(char)
    task.wait(1) -- give time to load
    updateChunks()
end)

-- If character already loaded
if player.Character then
    task.spawn(updateChunks)
end]],
    ["Shaders"] = [[--// SYSTEMBROKEN SHADERS â€” Standalone Version (Fixed)

local Light = game:GetService("Lighting")

-- Remove old effects
for _, v in ipairs(Light:GetChildren()) do
    if v:IsA("Sky") or v:IsA("BloomEffect") or v:IsA("BlurEffect")
    or v:IsA("ColorCorrectionEffect") or v:IsA("SunRaysEffect") then
        v:Destroy()
    end
end

-- Create shader objects
local Sky = Instance.new("Sky")
local Bloom = Instance.new("BloomEffect")
local Blur = Instance.new("BlurEffect")
local ColorC = Instance.new("ColorCorrectionEffect")
local SunRays = Instance.new("SunRaysEffect")

-- Lighting settings
Light.Brightness = 2.25
Light.ExposureCompensation = 0.1
Light.ClockTime = 17.55

-- Skybox
Sky.SkyboxBk = "rbxassetid://144933338"
Sky.SkyboxDn = "rbxassetid://144931530"
Sky.SkyboxFt = "rbxassetid://144933262"
Sky.SkyboxLf = "rbxassetid://144933244"
Sky.SkyboxRt = "rbxassetid://144933299"
Sky.SkyboxUp = "rbxassetid://144931564"
Sky.StarCount = 5000
Sky.SunAngularSize = 5
Sky.Parent = Light

-- Bloom
Bloom.Intensity = 0.3
Bloom.Size = 10
Bloom.Threshold = 0.8
Bloom.Parent = Light

-- Blur
Blur.Size = 5
Blur.Parent = Light

-- Color Correction
ColorC.Brightness = 0
ColorC.Contrast = 0.1
ColorC.Saturation = 0.25
ColorC.TintColor = Color3.fromRGB(255, 255, 255)
ColorC.Parent = Light

-- Sun Rays
SunRays.Intensity = 0.1
SunRays.Spread = 0.8
SunRays.Parent = Light


]],
    ["fling a person launcher"] = [[local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local Debris = game:GetService("Debris")

local LocalPlayer = Players.LocalPlayer
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local strength = 100

-- CUSTOM LOGO
local CUSTOM_LOGO_ID = "rbxassetid://"

local function notify(message)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Fling Launcher";
        Text = message;
        Duration = 2;
    })
end

-- Create UI
local function createUI()
    if PlayerGui:FindFirstChild("FlingLauncherUI") then
        PlayerGui.FlingLauncherUI:Destroy()
    end

    local gui = Instance.new("ScreenGui")
    gui.Name = "FlingLauncherUI"
    gui.ResetOnSpawn = false
    gui.Parent = PlayerGui

    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(0, 180, 0, 145)
    frame.Position = UDim2.new(1, -190, 0, 10)
    frame.BackgroundColor3 = Color3.fromRGB(8, 8, 18)
    frame.BackgroundTransparency = 0.35
    frame.BorderSizePixel = 0
    frame.Parent = gui

    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 12)
    mainCorner.Parent = frame

    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(255, 255, 255)
    stroke.Thickness = 1.5
    stroke.Transparency = 0.7
    stroke.Parent = frame

    -- Logo
    local logo = Instance.new("ImageLabel")
    logo.Size = UDim2.new(0, 36, 0, 36)
    logo.Position = UDim2.new(0, 10, 0, 8)
    logo.BackgroundTransparency = 1
    logo.Image = CUSTOM_LOGO_ID
    logo.Parent = frame

    -- Title
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -60, 0, 28)
    title.Position = UDim2.new(0, 52, 0, 10)
    title.BackgroundTransparency = 1
    title.Text = "LAUNCHER"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 15
    title.Font = Enum.Font.GothamBlack
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = frame

    -- Close
    local close = Instance.new("TextButton")
    close.Size = UDim2.new(0, 24, 0, 24)
    close.Position = UDim2.new(1, -30, 0, 10)
    close.BackgroundTransparency = 1
    close.Text = "Ã—"
    close.TextColor3 = Color3.fromRGB(255, 120, 120)
    close.TextSize = 20
    close.Font = Enum.Font.GothamBold
    close.Parent = frame

    -- Stars Background
    local starsBg = Instance.new("Frame")
    starsBg.Size = UDim2.new(1, 0, 1, 0)
    starsBg.BackgroundTransparency = 1
    starsBg.ZIndex = 1
    starsBg.Parent = frame

    local stars = {}
    for i = 1, 20 do
        local s = Instance.new("Frame")
        s.Size = UDim2.new(0, 2, 0, 2)
        s.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
        s.BorderSizePixel = 0
        s.Position = UDim2.new(math.random(), 0, math.random(), 0)
        s.ZIndex = 1
        s.Parent = starsBg
        s:SetAttribute("Speed", 0.5 + math.random() / 2)
        table.insert(stars, s)
    end
    RunService.RenderStepped:Connect(function(dt)
        for _, s in ipairs(stars) do
            local nx = s.Position.X.Scale - s:GetAttribute("Speed") * dt * 0.3
            if nx < 0 then
                nx = 1
                s.Position = UDim2.new(nx, 0, math.random(), 0)
            else
                s.Position = UDim2.new(nx, 0, s.Position.Y.Scale, 0)
            end
        end
    end)

    -- Status
    local statusDot = Instance.new("Frame")
    statusDot.Size = UDim2.new(0, 10, 0, 10)
    statusDot.Position = UDim2.new(0, 14, 0, 56)
    statusDot.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    statusDot.Parent = frame

    local dotCorner = Instance.new("UICorner")
    dotCorner.CornerRadius = UDim.new(1, 0)
    dotCorner.Parent = statusDot

    local statusLabel = Instance.new("TextLabel")
    statusLabel.Size = UDim2.new(1, -40, 0, 16)
    statusLabel.Position = UDim2.new(0, 30, 0, 56)
    statusLabel.BackgroundTransparency = 1
    statusLabel.Text = "Active"
    statusLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    statusLabel.TextSize = 11
    statusLabel.Font = Enum.Font.GothamBold
    statusLabel.TextXAlignment = Enum.TextXAlignment.Left
    statusLabel.Parent = frame

    -- Power Slider
    local powerLabel = Instance.new("TextLabel")
    powerLabel.Size = UDim2.new(1, -28, 0, 16)
    powerLabel.Position = UDim2.new(0, 14, 0, 82)
    powerLabel.BackgroundTransparency = 1
    powerLabel.Text = "Power: 100"
    powerLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    powerLabel.TextSize = 11
    powerLabel.Font = Enum.Font.Gotham
    powerLabel.TextXAlignment = Enum.TextXAlignment.Left
    powerLabel.Parent = frame

    local powerTrack = Instance.new("Frame")
    powerTrack.Size = UDim2.new(1, -28, 0, 10)
    powerTrack.Position = UDim2.new(0, 14, 0, 100)
    powerTrack.BackgroundColor3 = Color3.fromRGB(30, 30, 50)
    powerTrack.Parent = frame

    local ptCorner = Instance.new("UICorner")
    ptCorner.CornerRadius = UDim.new(0, 5)
    ptCorner.Parent = powerTrack

    local powerFill = Instance.new("Frame")
    powerFill.Size = UDim2.new(0.198, 0, 1, 0)
    powerFill.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    powerFill.Parent = powerTrack

    local pfCorner = Instance.new("UICorner")
    pfCorner.CornerRadius = UDim.new(0, 5)
    pfCorner.Parent = powerFill

    local powerKnob = Instance.new("Frame")
    powerKnob.Size = UDim2.new(0, 16, 0, 16)
    powerKnob.Position = UDim2.new(0.198, -8, 0, -3)
    powerKnob.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    powerKnob.ZIndex = 5
    powerKnob.Parent = powerTrack

    local pkCorner = Instance.new("UICorner")
    pkCorner.CornerRadius = UDim.new(1, 0)
    pkCorner.Parent = powerKnob

    local pkStroke = Instance.new("UIStroke")
    pkStroke.Color = Color3.fromRGB(255, 255, 255)
    pkStroke.Thickness = 2
    pkStroke.Parent = powerKnob

    -- Info Label
    local infoLabel = Instance.new("TextLabel")
    infoLabel.Size = UDim2.new(1, -28, 0, 24)
    infoLabel.Position = UDim2.new(0, 14, 1, -28)
    infoLabel.BackgroundTransparency = 1
    infoLabel.Text = "Right-Click: Launch"
    infoLabel.TextColor3 = Color3.fromRGB(160, 200, 255)
    infoLabel.TextSize = 9
    infoLabel.Font = Enum.Font.Gotham
    infoLabel.TextXAlignment = Enum.TextXAlignment.Center
    infoLabel.TextWrapped = true
    infoLabel.Parent = frame

    return {
        frame = frame,
        gui = gui,
        powerLabel = powerLabel,
        powerTrack = powerTrack,
        powerFill = powerFill,
        powerKnob = powerKnob,
        close = close,
        statusLabel = statusLabel,
        statusDot = statusDot
    }
end

local UI = createUI()

-- Slider Logic
local powerDragging = false

UI.powerKnob.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        powerDragging = true
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        powerDragging = false
    end
end)

RunService.RenderStepped:Connect(function()
    if powerDragging then
        local mouse = LocalPlayer:GetMouse()
        local relativePos = math.clamp(mouse.X - UI.powerTrack.AbsolutePosition.X, 0, UI.powerTrack.AbsoluteSize.X)
        local percent = relativePos / UI.powerTrack.AbsoluteSize.X

        UI.powerKnob.Position = UDim2.new(0, relativePos - 8, 0, -3)
        UI.powerFill.Size = UDim2.new(percent, 0, 1, 0)

        strength = 10 + percent * 990
        UI.powerLabel.Text = string.format("Power: %d", math.floor(strength))
    end
end)

-- Initial slider position
local initPercent = (strength - 10) / 990
UI.powerKnob.Position = UDim2.new(initPercent, -8, 0, -3)
UI.powerFill.Size = UDim2.new(initPercent, 0, 1, 0)

-- Draggable
local frameDragging = false
local dragStart, frameStart
UI.frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 and not powerDragging then
        frameDragging = true
        dragStart = input.Position
        frameStart = UI.frame.Position
    end
end)
UI.frame.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 then
        frameDragging = false
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if frameDragging and input.UserInputType == Enum.UserInputType.MouseMovement then
        local delta = input.Position - dragStart
        UI.frame.Position = UDim2.new(frameStart.X.Scale, frameStart.X.Offset + delta.X, frameStart.Y.Scale, frameStart.Y.Offset + delta.Y)
    end
end)

-- Close
UI.close.MouseButton1Click:Connect(function()
    UI.gui:Destroy()
end)

-- Original Fling Logic
Workspace.ChildAdded:Connect(function(model)
    if model.Name == "GrabParts" then
        local part_to_impulse = model["GrabPart"]["WeldConstraint"].Part1

        if part_to_impulse then
            print("Part found!")

            local velocityObj = Instance.new("BodyVelocity", part_to_impulse)

            model:GetPropertyChangedSignal("Parent"):Connect(function()
                if not model.Parent then
                    if UserInputService:GetLastInputType() == Enum.UserInputType.MouseButton2 then
                        print("Launched!")
                        velocityObj.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
                        velocityObj.Velocity = Workspace.CurrentCamera.CFrame.lookVector * strength
                        Debris:AddItem(velocityObj, 1)
                        notify("Launched at power: " .. math.floor(strength))
                    elseif UserInputService:GetLastInputType() == Enum.UserInputType.MouseButton1 then
                        velocityObj:Destroy()
                        print("Cancel Launch!")
                        notify("Launch cancelled")
                    else
                        velocityObj:Destroy()
                        print("No two keys pressed!")
                    end
                end
            end)
        end
    end
end)]],
    ["Jerk Off Tool"] = [[local ANIMATION_ID = "rbxassetid://698251653"
local player = game.Players.LocalPlayer

local function createTool()
    local tool = Instance.new("Tool")
    tool.Name = "Jerk Off R15"
    tool.RequiresHandle = false
    tool.Parent = player.Backpack
    
    local animationTrack = nil
    
    tool.Equipped:Connect(function()
        local character = player.Character or player.CharacterAdded:Wait()
        local humanoid = character:FindFirstChildOfClass("Humanoid")
        
        if humanoid then
            local animation = Instance.new("Animation")
            animation.AnimationId = ANIMATION_ID
            
            animationTrack = humanoid:LoadAnimation(animation)
            animationTrack.Looped = false
            animationTrack:Play()
            animationTrack.TimePosition = 0.58
            animationTrack:AdjustSpeed(0.4)
            
            task.spawn(function()
                while animationTrack and animationTrack.IsPlaying do
                    if animationTrack.TimePosition >= 0.63 then
                        animationTrack.TimePosition = 0.58
                    end
                    task.wait()
                end
            end)
        end
    end)
    
    tool.Unequipped:Connect(function()
        if animationTrack then
            animationTrack:Stop()
            animationTrack = nil
        end
    end)
end

createTool()

player.CharacterAdded:Connect(function()
    task.wait(0.5)
    createTool()
end)]],
    ["Tp Tool"] = [[local player = game.Players.LocalPlayer
local mouse = player:GetMouse()

local tool = Instance.new("Tool")
tool.RequiresHandle = false
tool.Name = "KIKO Tp Tool" -- put any name you want

tool.Activated:Connect(function()
    if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then
        return
    end

    local targetPosition = mouse.Hit.p + Vector3.new(0, 2.5, 0)
    player.Character.HumanoidRootPart.CFrame = CFrame.new(targetPosition)
end)

tool.Parent = player.Backpack]]
}
-- Example: If your script has this loop at the bottom, it will now register the new command
for name, code in pairs(builtInCommands) do
    -- Your existing command registration code here
    -- e.g. commands[name:lower()] = loadstring(code)
end
            
            for name, code in pairs(builtInCommands) do
                if filter == "" or string.find(string.lower(name), filter) then
                    createCommandButton(name, code, MainScroll, false)
                end
            end
        end
        
        local function refreshCustomList(filter)
            filter = string.lower(filter or "")
            for _, child in pairs(CustomScroll:GetChildren()) do
                if child:IsA("Frame") then child:Destroy() end
            end
            
            for name, code in pairs(CommandData) do
                if filter == "" or string.find(string.lower(name), filter) then
                    createCommandButton(name, code, CustomScroll, true)
                end
            end
        end
        
        refreshMainList()
        refreshCustomList()
        
        SearchBar:GetPropertyChangedSignal("Text"):Connect(function()
            if currentTab == "Main" then
                refreshMainList(SearchBar.Text)
            else
                refreshCustomList(SearchBar.Text)
            end
        end)
        
        -- Add Command Popup
        local AddPopup = Instance.new("Frame")
        AddPopup.Name = "AddCommandPopup"
        AddPopup.Size = UDim2.new(0, 720, 0, 300)
        AddPopup.Position = UDim2.new(0.5, -360, 0.5, -150)
        AddPopup.AnchorPoint = Vector2.new(0.5, 0.5)
        AddPopup.BackgroundColor3 = Color3.fromRGB(28, 28, 30)
        AddPopup.BackgroundTransparency = 1
        AddPopup.Visible = false
        AddPopup.BorderSizePixel = 0
        AddPopup.ZIndex = 1001
        AddPopup.Parent = ScreenGui
        
        local AddPopupCorner = Instance.new("UICorner")
        AddPopupCorner.CornerRadius = UDim.new(0, 16)
        AddPopupCorner.Parent = AddPopup
        
        local AddHeader = Instance.new("Frame")
        AddHeader.Size = UDim2.new(1, 0, 0, 60)
        AddHeader.BackgroundTransparency = 1
        AddHeader.Parent = AddPopup
        
        local AddIconFrame = Instance.new("Frame")
        AddIconFrame.Size = UDim2.new(0, 36, 0, 36)
        AddIconFrame.Position = UDim2.new(0, 24, 0, 12)
        AddIconFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 65)
        AddIconFrame.Parent = AddHeader
        
        local AddIconCorner = Instance.new("UICorner")
        AddIconCorner.CornerRadius = UDim.new(0, 8)
        AddIconCorner.Parent = AddIconFrame
        
        local AddIcon = Instance.new("ImageLabel")
        AddIcon.Size = UDim2.new(0, 20, 0, 20)
        AddIcon.Position = UDim2.new(0.5, -10, 0.5, -10)
        AddIcon.BackgroundTransparency = 1
        AddIcon.Image = "rbxassetid://84250036897477"
        AddIcon.ImageColor3 = Color3.fromRGB(255, 255, 255)
        AddIcon.Parent = AddIconFrame
        
        local AddTitle = Instance.new("TextLabel")
        AddTitle.Size = UDim2.new(1, -80, 1, 0)
        AddTitle.Position = UDim2.new(0, 70, 0, 0)
        AddTitle.BackgroundTransparency = 1
        AddTitle.Text = "Add New Command"
        AddTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
        AddTitle.Font = Enum.Font.GothamBold
        AddTitle.TextSize = 22
        AddTitle.TextXAlignment = Enum.TextXAlignment.Left
        AddTitle.Parent = AddHeader
        
        local AddContent = Instance.new("Frame")
        AddContent.Size = UDim2.new(1, -48, 1, -80)
        AddContent.Position = UDim2.new(0, 24, 0, 70)
        AddContent.BackgroundTransparency = 1
        AddContent.Parent = AddPopup
        
        local CodeBox = Instance.new("TextBox")
        CodeBox.Size = UDim2.new(1, 0, 1, -60)
        CodeBox.Position = UDim2.new(0, 0, 0, 0)
        CodeBox.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        CodeBox.TextColor3 = Color3.fromRGB(255, 255, 255)
        CodeBox.PlaceholderText = "Paste your Lua code here..."
        CodeBox.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
        CodeBox.Font = Enum.Font.Code
        CodeBox.TextSize = 14
        CodeBox.TextXAlignment = Enum.TextXAlignment.Left
        CodeBox.TextYAlignment = Enum.TextYAlignment.Top
        CodeBox.MultiLine = true
        CodeBox.ClearTextOnFocus = false
        CodeBox.Parent = AddContent
        
        local CodeBoxCorner = Instance.new("UICorner")
        CodeBoxCorner.CornerRadius = UDim.new(0, 8)
        CodeBoxCorner.Parent = CodeBox
        
        local CodePadding = Instance.new("UIPadding")
        CodePadding.PaddingLeft = UDim.new(0, 12)
        CodePadding.PaddingRight = UDim.new(0, 12)
        CodePadding.PaddingTop = UDim.new(0, 12)
        CodePadding.PaddingBottom = UDim.new(0, 12)
        CodePadding.Parent = CodeBox
        
        local SaveBtn = Instance.new("TextButton")
        SaveBtn.Name = "SaveBtn"
        SaveBtn.Size = UDim2.new(0, 160, 0, 40)
        SaveBtn.Position = UDim2.new(0.5, -80, 1, -50)
        SaveBtn.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
        SaveBtn.Text = "Save Command"
        SaveBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
        SaveBtn.Font = Enum.Font.GothamBold
        SaveBtn.TextSize = 16
        SaveBtn.Parent = AddContent
        
        local SaveBtnCorner = Instance.new("UICorner")
        SaveBtnCorner.CornerRadius = UDim.new(0, 8)
        SaveBtnCorner.Parent = SaveBtn
        
        AddButton.MouseButton1Click:Connect(function()
            AddPopup.Visible = true
            TweenService:Create(AddPopup, TweenInfo.new(0.3), {BackgroundTransparency = 0}):Play()
        end)
        
        local function closeAddPopup()
            TweenService:Create(AddPopup, TweenInfo.new(0.3), {BackgroundTransparency = 1}):Play()
            task.delay(0.3, function()
                AddPopup.Visible = false
            end)
        end
        
        AddPopup.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                local mousePos = UserInputService:GetMouseLocation()
                local popupPos = AddPopup.AbsolutePosition
                local popupSize = AddPopup.AbsoluteSize
                if mousePos.X < popupPos.X or mousePos.X > popupPos.X + popupSize.X or
                   mousePos.Y < popupPos.Y or mousePos.Y > popupPos.Y + popupSize.Y then
                    closeAddPopup()
                end
            end
        end)
        
        SaveBtn.MouseButton1Click:Connect(function()
            local code = CodeBox.Text
            if code:gsub("%s", "") == "" then return end
            
            local name = "CustomCmd_" .. math.random(10000, 99999)
            while CommandData[name] do
                name = "CustomCmd_" .. math.random(10000, 99999)
            end
            
            CommandData[name] = code
            saveCommands()
            createCommandButton(name, code, CustomScroll, true)
            closeAddPopup()
            CodeBox.Text = ""
            refreshCustomList(SearchBar.Text)
        end)
        
    -- Players Panel
    elseif buttonName == "Players" then
        local SearchBar = Instance.new("TextBox")
        SearchBar.Size = UDim2.new(1, 0, 0, 32)
        SearchBar.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        SearchBar.BorderSizePixel = 0
        SearchBar.Text = ""
        SearchBar.PlaceholderText = "Search players..."
        SearchBar.TextColor3 = Color3.fromRGB(255, 255, 255)
        SearchBar.PlaceholderColor3 = Color3.fromRGB(120, 120, 120)
        SearchBar.Font = Enum.Font.Gotham
        SearchBar.TextSize = 13
        SearchBar.TextXAlignment = Enum.TextXAlignment.Left
        SearchBar.ClearTextOnFocus = false
        SearchBar.Parent = Content
        
        local SearchPadding = Instance.new("UIPadding")
        SearchPadding.PaddingLeft = UDim.new(0, 10)
        SearchPadding.Parent = SearchBar
        
        local SearchCorner = Instance.new("UICorner")
        SearchCorner.CornerRadius = UDim.new(0, 8)
        SearchCorner.Parent = SearchBar
        
        local PlayersScroll = Instance.new("ScrollingFrame")
        PlayersScroll.Size = UDim2.new(1, 0, 1, -42)
        PlayersScroll.Position = UDim2.new(0, 0, 0, 42)
        PlayersScroll.BackgroundTransparency = 1
        PlayersScroll.BorderSizePixel = 0
        PlayersScroll.ScrollBarThickness = 4
        PlayersScroll.ScrollBarImageColor3 = Color3.fromRGB(120, 120, 120)
        PlayersScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
        PlayersScroll.Parent = Content
        
        local PlayersLayout = Instance.new("UIListLayout")
        PlayersLayout.FillDirection = Enum.FillDirection.Vertical
        PlayersLayout.Padding = UDim.new(0, 6)
        PlayersLayout.SortOrder = Enum.SortOrder.Name
        PlayersLayout.Parent = PlayersScroll
        
        PlayersLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            PlayersScroll.CanvasSize = UDim2.new(0, 0, 0, PlayersLayout.AbsoluteContentSize.Y + 6)
        end)
        
        local function createPlayerEntry(plr)
            local PlayerFrame = Instance.new("Frame")
            PlayerFrame.Name = plr.Name
            PlayerFrame.Size = UDim2.new(1, -8, 0, 40)
            PlayerFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
            PlayerFrame.BorderSizePixel = 0
            PlayerFrame.Parent = PlayersScroll
            
            local PlayerCorner = Instance.new("UICorner")
            PlayerCorner.CornerRadius = UDim.new(0, 8)
            PlayerCorner.Parent = PlayerFrame

            hoverTweenInput(PlayerFrame,
                function()
                    tween(PlayerFrame, TweenInfo.new(0.18, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(50, 50, 60)
                    })
                end,
                function()
                    tween(PlayerFrame, TweenInfo.new(0.2, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                        BackgroundColor3 = Color3.fromRGB(40, 40, 45)
                    })
                end
            )
            
            local NameLabel = Instance.new("TextLabel")
            NameLabel.Size = UDim2.new(1, -180, 1, 0)
            NameLabel.Position = UDim2.new(0, 12, 0, 0)
            NameLabel.BackgroundTransparency = 1
            NameLabel.Text = plr.Name
            NameLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
            NameLabel.Font = Enum.Font.GothamMedium
            NameLabel.TextSize = 13
            NameLabel.TextXAlignment = Enum.TextXAlignment.Left
            NameLabel.TextTruncate = Enum.TextTruncate.AtEnd
            NameLabel.Parent = PlayerFrame
            
            local TpButton = Instance.new("TextButton")
            TpButton.Name = "TpButton"
            TpButton.Size = UDim2.new(0, 75, 0, 28)
            TpButton.Position = UDim2.new(1, -160, 0.5, -14)
            TpButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
            TpButton.Text = "Teleport"
            TpButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            TpButton.Font = Enum.Font.GothamBold
            TpButton.TextSize = 12
            TpButton.Parent = PlayerFrame
            
            local TpCorner = Instance.new("UICorner")
            TpCorner.CornerRadius = UDim.new(0, 6)
            TpCorner.Parent = TpButton

            hoverTween(TpButton,
                {BackgroundColor3 = Color3.fromRGB(80, 150, 230)},
                {BackgroundColor3 = Color3.fromRGB(60, 120, 200)}
            )
            
            TpButton.MouseButton1Click:Connect(function()
                if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
                    if player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
                        player.Character.HumanoidRootPart.CFrame = plr.Character.HumanoidRootPart.CFrame
                    end
                end
            end)
            
            local SpectateButton = Instance.new("TextButton")
            SpectateButton.Name = "SpectateButton"
            SpectateButton.Size = UDim2.new(0, 75, 0, 28)
            SpectateButton.Position = UDim2.new(1, -79, 0.5, -14)
            SpectateButton.BackgroundColor3 = Color3.fromRGB(100, 60, 200)
            SpectateButton.Text = "Spectate"
            SpectateButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            SpectateButton.Font = Enum.Font.GothamBold
            SpectateButton.TextSize = 12
            SpectateButton.Parent = PlayerFrame
            
            local SpectateCorner = Instance.new("UICorner")
            SpectateCorner.CornerRadius = UDim.new(0, 6)
            SpectateCorner.Parent = SpectateButton

            hoverTween(SpectateButton,
                {BackgroundColor3 = Color3.fromRGB(130, 90, 230)},
                {BackgroundColor3 = Color3.fromRGB(100, 60, 200)}
            )
            
            SpectateButton.MouseButton1Click:Connect(function()
                if spectating and spectateTarget == plr then
                    spectating = false
                    spectateTarget = nil
                    if player.Character and player.Character:FindFirstChild("Humanoid") then
                        workspace.CurrentCamera.CameraSubject = player.Character.Humanoid
                    end
                    SpectateButton.BackgroundColor3 = Color3.fromRGB(100, 60, 200)
                    SpectateButton.Text = "Spectate"
                    
                    for _, frame in pairs(PlayersScroll:GetChildren()) do
                        if frame:IsA("Frame") and frame ~= PlayerFrame then
                            local otherBtn = frame:FindFirstChild("SpectateButton")
                            if otherBtn then
                                otherBtn.BackgroundColor3 = Color3.fromRGB(100, 60, 200)
                                otherBtn.Text = "Spectate"
                            end
                        end
                    end
                else
                    if plr.Character and plr.Character:FindFirstChild("Humanoid") then
                        spectating = true
                        spectateTarget = plr
                        workspace.CurrentCamera.CameraSubject = plr.Character.Humanoid
                        SpectateButton.BackgroundColor3 = Color3.fromRGB(200, 100, 100)
                        SpectateButton.Text = "Spectating"
                        
                        for _, frame in pairs(PlayersScroll:GetChildren()) do
                            if frame:IsA("Frame") and frame ~= PlayerFrame then
                                local otherBtn = frame:FindFirstChild("SpectateButton")
                                if otherBtn then
                                    otherBtn.BackgroundColor3 = Color3.fromRGB(100, 60, 200)
                                    otherBtn.Text = "Spectate"
                                end
                            end
                        end
                    end
                end
            end)
            
            return PlayerFrame
        end
        
        local function updatePlayerList(searchText)
            for _, child in pairs(PlayersScroll:GetChildren()) do
                if child:IsA("Frame") then
                    child:Destroy()
                end
            end
            
            for _, plr in pairs(Players:GetPlayers()) do
                if searchText == "" or string.find(string.lower(plr.Name), string.lower(searchText)) then
                    createPlayerEntry(plr)
                end
            end
        end
        
        updatePlayerList("")
        
        SearchBar:GetPropertyChangedSignal("Text"):Connect(function()
            updatePlayerList(SearchBar.Text)
        end)
        
        Players.PlayerAdded:Connect(function()
            updatePlayerList(SearchBar.Text)
        end)
        
        Players.PlayerRemoving:Connect(function()
            task.wait(0.1)
            updatePlayerList(SearchBar.Text)
        end)
        
    -- Settings Panel
    elseif buttonName == "Settings" then
        local SettingsContainer = Instance.new("Frame")
        SettingsContainer.Size = UDim2.new(1, 0, 1, 0)
        SettingsContainer.BackgroundTransparency = 1
        SettingsContainer.Parent = Content
        
        local SettingsLayout = Instance.new("UIListLayout")
        SettingsLayout.FillDirection = Enum.FillDirection.Vertical
        SettingsLayout.Padding = UDim.new(0, 12)
        SettingsLayout.Parent = SettingsContainer
        
        -- Menu Keybind Setting
        local MenuKeybindFrame = Instance.new("Frame")
        MenuKeybindFrame.Size = UDim2.new(1, 0, 0, 45)
        MenuKeybindFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        MenuKeybindFrame.BorderSizePixel = 0
        MenuKeybindFrame.Parent = SettingsContainer
        
        local MenuKeybindCorner = Instance.new("UICorner")
        MenuKeybindCorner.CornerRadius = UDim.new(0, 8)
        MenuKeybindCorner.Parent = MenuKeybindFrame

        hoverTweenInput(MenuKeybindFrame,
            function()
                tween(MenuKeybindFrame, TweenInfo.new(0.18, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                    BackgroundColor3 = Color3.fromRGB(50, 50, 60)
                })
            end,
            function()
                tween(MenuKeybindFrame, TweenInfo.new(0.2, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                    BackgroundColor3 = Color3.fromRGB(40, 40, 45)
                })
            end
        )
        
        local MenuKeybindLabel = Instance.new("TextLabel")
        MenuKeybindLabel.Size = UDim2.new(0, 150, 1, 0)
        MenuKeybindLabel.Position = UDim2.new(0, 12, 0, 0)
        MenuKeybindLabel.BackgroundTransparency = 1
        MenuKeybindLabel.Text = "Menu Toggle Keybind"
        MenuKeybindLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        MenuKeybindLabel.Font = Enum.Font.GothamMedium
        MenuKeybindLabel.TextSize = 14
        MenuKeybindLabel.TextXAlignment = Enum.TextXAlignment.Left
        MenuKeybindLabel.Parent = MenuKeybindFrame
        
        local MenuKeybindButton = Instance.new("TextButton")
        MenuKeybindButton.Name = "MenuKeybindButton"
        MenuKeybindButton.Size = UDim2.new(0, 100, 0, 32)
        MenuKeybindButton.Position = UDim2.new(1, -112, 0.5, -16)
        MenuKeybindButton.BackgroundColor3 = Color3.fromRGB(120, 60, 200)
        MenuKeybindButton.Text = getKeyName(menuKeybind)
        MenuKeybindButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        MenuKeybindButton.Font = Enum.Font.GothamBold
        MenuKeybindButton.TextSize = 13
        MenuKeybindButton.Parent = MenuKeybindFrame
        
        local MenuKeybindButtonCorner = Instance.new("UICorner")
        MenuKeybindButtonCorner.CornerRadius = UDim.new(0, 6)
        MenuKeybindButtonCorner.Parent = MenuKeybindButton

        hoverTween(MenuKeybindButton,
            {BackgroundColor3 = Color3.fromRGB(150, 90, 230)},
            {BackgroundColor3 = Color3.fromRGB(120, 60, 200)}
        )
        
        MenuKeybindButton.MouseButton1Click:Connect(function()
            if isSettingKeybind then return end
            
            isSettingKeybind = true
            keybindType = "menu"
            MenuKeybindButton.Text = "Press Key..."
            MenuKeybindButton.BackgroundColor3 = Color3.fromRGB(200, 120, 60)
            
            local connection
            connection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if gameProcessed then return end
                
                if input.UserInputType == Enum.UserInputType.Keyboard then
                    if input.KeyCode ~= Enum.KeyCode.Unknown and 
                       input.KeyCode ~= Enum.KeyCode.Escape then
                        
                        menuKeybind = input.KeyCode
                        MenuKeybindButton.Text = getKeyName(menuKeybind)
                        MenuKeybindButton.BackgroundColor3 = Color3.fromRGB(120, 60, 200)
                        isSettingKeybind = false
                        keybindType = ""
                        connection:Disconnect()
                    elseif input.KeyCode == Enum.KeyCode.Escape then
                        MenuKeybindButton.Text = getKeyName(menuKeybind)
                        MenuKeybindButton.BackgroundColor3 = Color3.fromRGB(120, 60, 200)
                        isSettingKeybind = false
                        keybindType = ""
                        connection:Disconnect()
                    end
                end
            end)
        end)
        
        -- Fly Keybind Setting
        local KeybindFrame = Instance.new("Frame")
        KeybindFrame.Size = UDim2.new(1, 0, 0, 45)
        KeybindFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        KeybindFrame.BorderSizePixel = 0
        KeybindFrame.Parent = SettingsContainer
        
        local KeybindCorner = Instance.new("UICorner")
        KeybindCorner.CornerRadius = UDim.new(0, 8)
        KeybindCorner.Parent = KeybindFrame

        hoverTweenInput(KeybindFrame,
            function()
                tween(KeybindFrame, TweenInfo.new(0.18, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                    BackgroundColor3 = Color3.fromRGB(50, 50, 60)
                })
            end,
            function()
                tween(KeybindFrame, TweenInfo.new(0.2, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                    BackgroundColor3 = Color3.fromRGB(40, 40, 45)
                })
            end
        )
        
        local KeybindLabel = Instance.new("TextLabel")
        KeybindLabel.Size = UDim2.new(0, 150, 1, 0)
        KeybindLabel.Position = UDim2.new(0, 12, 0, 0)
        KeybindLabel.BackgroundTransparency = 1
        KeybindLabel.Text = "Fly Toggle Keybind"
        KeybindLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        KeybindLabel.Font = Enum.Font.GothamMedium
        KeybindLabel.TextSize = 14
        KeybindLabel.TextXAlignment = Enum.TextXAlignment.Left
        KeybindLabel.Parent = KeybindFrame
        
        local KeybindButton = Instance.new("TextButton")
        KeybindButton.Name = "KeybindButton"
        KeybindButton.Size = UDim2.new(0, 100, 0, 32)
        KeybindButton.Position = UDim2.new(1, -112, 0.5, -16)
        KeybindButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
        KeybindButton.Text = getKeyName(flyKeybind)
        KeybindButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        KeybindButton.Font = Enum.Font.GothamBold
        KeybindButton.TextSize = 13
        KeybindButton.Parent = KeybindFrame
        
        local KeybindButtonCorner = Instance.new("UICorner")
        KeybindButtonCorner.CornerRadius = UDim.new(0, 6)
        KeybindButtonCorner.Parent = KeybindButton

        hoverTween(KeybindButton,
            {BackgroundColor3 = Color3.fromRGB(80, 150, 230)},
            {BackgroundColor3 = Color3.fromRGB(60, 120, 200)}
        )
        
        KeybindButton.MouseButton1Click:Connect(function()
            if isSettingKeybind then return end
            
            isSettingKeybind = true
            keybindType = "fly"
            KeybindButton.Text = "Press Key..."
            KeybindButton.BackgroundColor3 = Color3.fromRGB(200, 120, 60)
            
            local connection
            connection = UserInputService.InputBegan:Connect(function(input, gameProcessed)
                if gameProcessed then return end
                
                if input.UserInputType == Enum.UserInputType.Keyboard then
                    if input.KeyCode ~= Enum.KeyCode.Unknown and 
                       input.KeyCode ~= Enum.KeyCode.Escape then
                        
                        flyKeybind = input.KeyCode
                        KeybindButton.Text = getKeyName(flyKeybind)
                        KeybindButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
                        isSettingKeybind = false
                        keybindType = ""
                        connection:Disconnect()
                    elseif input.KeyCode == Enum.KeyCode.Escape then
                        KeybindButton.Text = getKeyName(flyKeybind)
                        KeybindButton.BackgroundColor3 = Color3.fromRGB(60, 120, 200)
                        isSettingKeybind = false
                        keybindType = ""
                        connection:Disconnect()
                    end
                end
            end)
        end)
        
        -- Theme Selector
        local ThemeFrame = Instance.new("Frame")
        ThemeFrame.Size = UDim2.new(1, 0, 0, 45)
        ThemeFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
        ThemeFrame.BorderSizePixel = 0
        ThemeFrame.Parent = SettingsContainer
        
        local ThemeCorner = Instance.new("UICorner")
        ThemeCorner.CornerRadius = UDim.new(0, 8)
        ThemeCorner.Parent = ThemeFrame

        hoverTweenInput(ThemeFrame,
            function()
                tween(ThemeFrame, TweenInfo.new(0.18, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                    BackgroundColor3 = Color3.fromRGB(50, 50, 60)
                })
            end,
            function()
                tween(ThemeFrame, TweenInfo.new(0.2, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                    BackgroundColor3 = Color3.fromRGB(40, 40, 45)
                })
            end
        )
        
        local ThemeLabel = Instance.new("TextLabel")
        ThemeLabel.Size = UDim2.new(0, 150, 1, 0)
        ThemeLabel.Position = UDim2.new(0, 12, 0, 0)
        ThemeLabel.BackgroundTransparency = 1
        ThemeLabel.Text = "Theme"
        ThemeLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        ThemeLabel.Font = Enum.Font.GothamMedium
        ThemeLabel.TextSize = 14
        ThemeLabel.TextXAlignment = Enum.TextXAlignment.Left
        ThemeLabel.Parent = ThemeFrame
        
        local ThemeButton = Instance.new("TextButton")
        ThemeButton.Name = "ThemeButton"
        ThemeButton.Size = UDim2.new(0, 140, 0, 32)
        ThemeButton.Position = UDim2.new(1, -152, 0.5, -16)
        ThemeButton.BackgroundColor3 = Color3.fromRGB(200, 80, 160)
        ThemeButton.Text = currentTheme
        ThemeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        ThemeButton.Font = Enum.Font.GothamBold
        ThemeButton.TextSize = 13
        ThemeButton.Parent = ThemeFrame
        
        local ThemeButtonCorner = Instance.new("UICorner")
        ThemeButtonCorner.CornerRadius = UDim.new(0, 6)
        ThemeButtonCorner.Parent = ThemeButton

        hoverTween(ThemeButton,
            {BackgroundColor3 = Color3.fromRGB(220, 120, 190)},
            {BackgroundColor3 = Color3.fromRGB(200, 80, 160)}
        )
        
        local ThemeDropdown = Instance.new("Frame")
        ThemeDropdown.Name = "ThemeDropdown"
        ThemeDropdown.Size = UDim2.new(0, 180, 0, 0)
        ThemeDropdown.Position = UDim2.new(1, -152, 1, 5)
        ThemeDropdown.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
        ThemeDropdown.BorderSizePixel = 0
        ThemeDropdown.Visible = false
        ThemeDropdown.ZIndex = 1000
        ThemeDropdown.ClipsDescendants = true
        ThemeDropdown.Parent = ThemeFrame
        
        local DropdownCorner = Instance.new("UICorner")
        DropdownCorner.CornerRadius = UDim.new(0, 6)
        DropdownCorner.Parent = ThemeDropdown
        
        local DropdownScroll = Instance.new("ScrollingFrame")
        DropdownScroll.Name = "DropdownScroll"
        DropdownScroll.Size = UDim2.new(1, 0, 1, 0)
        DropdownScroll.BackgroundTransparency = 1
        DropdownScroll.BorderSizePixel = 0
        DropdownScroll.ScrollBarThickness = 4
        DropdownScroll.ScrollBarImageColor3 = Color3.fromRGB(120, 120, 120)
        DropdownScroll.CanvasSize = UDim2.new(0, 0, 0, 0)
        DropdownScroll.Parent = ThemeDropdown
        
        local DropdownLayout = Instance.new("UIListLayout")
        DropdownLayout.FillDirection = Enum.FillDirection.Vertical
        DropdownLayout.Padding = UDim.new(0, 2)
        DropdownLayout.Parent = DropdownScroll
        
        DropdownLayout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
            DropdownScroll.CanvasSize = UDim2.new(0, 0, 0, DropdownLayout.AbsoluteContentSize.Y)
        end)
        
        local themeNames = {}
        for name in pairs(themes) do
            table.insert(themeNames, name)
        end
        table.sort(themeNames)

        local dropdownOpen = false
        
        for _, name in ipairs(themeNames) do
            local OptionButton = Instance.new("TextButton")
            OptionButton.Name = name
            OptionButton.Size = UDim2.new(1, 0, 0, 24)
            OptionButton.BackgroundColor3 = Color3.fromRGB(35, 35, 40)
            OptionButton.BorderSizePixel = 0
            OptionButton.Text = name
            OptionButton.TextColor3 = Color3.fromRGB(255, 255, 255)
            OptionButton.Font = Enum.Font.GothamMedium
            OptionButton.TextSize = 12
            OptionButton.TextXAlignment = Enum.TextXAlignment.Left
            OptionButton.Parent = DropdownScroll

            local OptionPadding = Instance.new("UIPadding")
            OptionPadding.PaddingLeft = UDim.new(0, 8)
            OptionPadding.Parent = OptionButton

            hoverTween(OptionButton,
                {BackgroundColor3 = Color3.fromRGB(55, 55, 70)},
                {BackgroundColor3 = Color3.fromRGB(35, 35, 40)}
            )
            
            OptionButton.MouseButton1Click:Connect(function()
                ThemeButton.Text = name
                applyTheme(name)
                
                dropdownOpen = false
                tween(ThemeDropdown, TweenInfo.new(0.3, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {
                    Size = UDim2.new(0, 180, 0, 0)
                })
                task.delay(0.3, function()
                    ThemeDropdown.Visible = false
                end)
            end)
        end
        
        ThemeButton.MouseButton1Click:Connect(function()
            if dropdownOpen then
                dropdownOpen = false
                tween(ThemeDropdown, TweenInfo.new(0.3, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {
                    Size = UDim2.new(0, 180, 0, 0)
                })
                task.delay(0.3, function()
                    ThemeDropdown.Visible = false
                end)
            else
                dropdownOpen = true
                ThemeDropdown.Visible = true
                local targetHeight = math.min(#themeNames * 26, 260)
                tween(ThemeDropdown, TweenInfo.new(0.3, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                    Size = UDim2.new(0, 180, 0, targetHeight)
                })
            end
        end)
        
    else
        local ContentLabel = Instance.new("TextLabel")
        ContentLabel.Size = UDim2.new(1, 0, 0, 30)
        ContentLabel.BackgroundTransparency = 1
        ContentLabel.Text = "Your " .. buttonName .. " content goes here!"
        ContentLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
        ContentLabel.Font = Enum.Font.Gotham
        ContentLabel.TextSize = 15
        ContentLabel.TextXAlignment = Enum.TextXAlignment.Left
        ContentLabel.Parent = Content
    end

    return Panel
end

-- ============================================
-- PANEL TOGGLING WITH SMOOTH ANIMATIONS
-- ============================================

local function togglePanel(buttonName, panel)
    if activePanels[buttonName] then
        activePanels[buttonName] = false
        tween(panel, TweenInfo.new(0.4, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {
            Position = UDim2.new(0.5, -10, 0, -100),
            BackgroundTransparency = 1
        })
        task.delay(0.4, function()
            if not activePanels[buttonName] then
                panel.Visible = false
            end
        end)
    else
        for otherName, isOpenPanel in pairs(activePanels) do
            if isOpenPanel and otherName ~= buttonName then
                activePanels[otherName] = false
                local otherPanel = ScreenGui:FindFirstChild(otherName .. "Panel")
                if otherPanel then
                    tween(otherPanel, TweenInfo.new(0.4, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {
                        Position = UDim2.new(0.5, -10, 0, -100),
                        BackgroundTransparency = 1
                    })
                    task.delay(0.4, function()
                        if not activePanels[otherName] then
                            otherPanel.Visible = false
                        end
                    end)
                end
            end
        end

        activePanels[buttonName] = true
        panel.Visible = true
        panel.Position = UDim2.new(0.5, -10, 0, -100)
        tween(panel, TweenInfo.new(0.5, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
            Position = UDim2.new(0.5, -10, 0, 266),
            BackgroundTransparency = 0.05
        })
    end
end

-- ============================================
-- TOP ICON BUTTONS WITH HOVER + CLICK ANIMS
-- ============================================

for _, data in ipairs(iconData) do
    local Button = Instance.new("Frame")
    Button.Name = data.Name
    Button.Size = UDim2.new(0, 52, 0, 52)
    Button.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
    Button.BackgroundTransparency = 0.4
    Button.Parent = IconsFrame

    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(0, 14)
    Corner.Parent = Button

    local Icon = Instance.new("ImageLabel")
    Icon.Size = UDim2.new(0, 28, 0, 28)
    Icon.Position = UDim2.new(0.5, -14, 0.5, -14)
    Icon.BackgroundTransparency = 1
    Icon.Image = "rbxassetid://" .. data.AssetId
    Icon.ImageColor3 = Color3.fromRGB(255, 255, 255)
    Icon.ImageTransparency = 0.1
    Icon.Parent = Button

    local Interact = Instance.new("TextButton")
    Interact.Size = UDim2.new(1, 0, 1, 0)
    Interact.BackgroundTransparency = 1
    Interact.Text = ""
    Interact.ZIndex = 10
    Interact.Parent = Button

    -- Hover animations for icon buttons
    hoverTweenInput(Interact,
        function()
            tween(Button, TweenInfo.new(0.18, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                BackgroundTransparency = 0.1,
                Size = UDim2.new(0, 56, 0, 56)
            })
            tween(Icon, TweenInfo.new(0.18, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                ImageTransparency = 0
            })
        end,
        function()
            tween(Button, TweenInfo.new(0.22, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                BackgroundTransparency = 0.4,
                Size = UDim2.new(0, 52, 0, 52)
            })
            tween(Icon, TweenInfo.new(0.22, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
                ImageTransparency = 0.1
            })
        end
    )

    if data.Name == "Rejoin" then
        Interact.MouseButton1Click:Connect(function()
            tween(Button, TweenInfo.new(0.1), {Size = UDim2.new(0, 48, 0, 48)})
            task.wait(0.1)
            tween(Button, TweenInfo.new(0.15), {Size = UDim2.new(0, 56, 0, 56)})
            game:GetService("TeleportService"):Teleport(game.PlaceId, player)
        end)
    elseif data.Name == "Serverhop" then
        Interact.MouseButton1Click:Connect(function()
            tween(Button, TweenInfo.new(0.1), {Size = UDim2.new(0, 48, 0, 48)})
            task.wait(0.1)
            tween(Button, TweenInfo.new(0.15), {Size = UDim2.new(0, 56, 0, 56)})
            
            local TeleportService = game:GetService("TeleportService")
            
            local success, result = pcall(function()
                local servers = HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/" .. game.PlaceId .. "/servers/Public?sortOrder=Asc&limit=100"))
                
                if servers and servers.data then
                    local currentServerId = game.JobId
                    for _, server in pairs(servers.data) do
                        if server.id ~= currentServerId and server.playing < server.maxPlayers then
                            TeleportService:TeleportToPlaceInstance(game.PlaceId, server.id, player)
                            return
                        end
                    end
                end
            end)
            
            if not success then
                warn("Server hop failed:", result)
            end
        end)
    else
        local Panel = createPanel(data.Name, data.AssetId)

        Interact.MouseButton1Click:Connect(function()
            tween(Button, TweenInfo.new(0.1), {Size = UDim2.new(0, 48, 0, 48)})
            task.wait(0.1)
            tween(Button, TweenInfo.new(0.15), {Size = UDim2.new(0, 56, 0, 56)})
            togglePanel(data.Name, Panel)
        end)
    end
end

-- ============================================
-- MENU BAR OPEN/CLOSE WITH SMOOTH DROP
-- ============================================

local function openBar()
    if isOpen then return end
    isOpen = true
    MenuBar.Visible = true
    tween(ToggleArrow, TweenInfo.new(0.4, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Rotation = 180,
        BackgroundTransparency = 0,
        BackgroundColor3 = Color3.fromRGB(60, 60, 65)
    })
    tween(MenuBar, TweenInfo.new(0.5, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
        Position = UDim2.new(0.5, -10, 0, 72),
        BackgroundTransparency = 0.05
    })
end

local function closeBar()
    if not isOpen then return end
    isOpen = false
    for name, _ in pairs(activePanels) do
        if activePanels[name] then
            local panel = ScreenGui:FindFirstChild(name .. "Panel")
            if panel then
                togglePanel(name, panel)
            end
        end
    end
    tween(ToggleArrow, TweenInfo.new(0.4, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {
        Rotation = 0,
        BackgroundTransparency = 0.2,
        BackgroundColor3 = Color3.fromRGB(50, 50, 55)
    })
    tween(MenuBar, TweenInfo.new(0.4, Enum.EasingStyle.Quint, Enum.EasingDirection.In), {
        Position = UDim2.new(0.5, -10, 0, -100),
        BackgroundTransparency = 1
    })
    task.delay(0.4, function()
        if not isOpen then MenuBar.Visible = false end
    end)
end

ToggleArrow.MouseButton1Click:Connect(function()
    if isOpen then closeBar() else openBar() end
end)

ToggleArrow.MouseEnter:Connect(function()
    if not isOpen then
        tween(ToggleArrow, TweenInfo.new(0.25, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0,
            BackgroundColor3 = Color3.fromRGB(60, 60, 65)
        })
    end
end)

ToggleArrow.MouseLeave:Connect(function()
    if not isOpen then
        tween(ToggleArrow, TweenInfo.new(0.35, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {
            BackgroundTransparency = 0.2,
            BackgroundColor3 = Color3.fromRGB(50, 50, 55)
        })
    end
end)

-- Close menu if clicking outside
UserInputService.InputBegan:Connect(function(input, gameProcessed)
    if input.UserInputType == Enum.UserInputType.MouseButton1 and not gameProcessed then
        local mousePos = UserInputService:GetMouseLocation()

        local insideBar = false
        local insideArrow = false
        if MenuBar.Visible then
            local barPos = MenuBar.AbsolutePosition
            local barSize = MenuBar.AbsoluteSize
            insideBar = mousePos.X >= barPos.X and mousePos.X <= barPos.X + barSize.X
                and mousePos.Y >= barPos.Y and mousePos.Y <= barPos.Y + barSize.Y
        end
        local arrowPos = ToggleArrow.AbsolutePosition
        local arrowSize = ToggleArrow.AbsoluteSize
        insideArrow = mousePos.X >= arrowPos.X and mousePos.X <= arrowPos.X + arrowSize.X
            and mousePos.Y >= arrowPos.Y and mousePos.Y <= arrowPos.Y + arrowSize.Y

        local insidePanel = false
        for name, open in pairs(activePanels) do
            if open then
                local panel = ScreenGui:FindFirstChild(name .. "Panel")
                if panel and panel.Visible then
                    local panelPos = panel.AbsolutePosition
                    local panelSize = panel.AbsoluteSize
                    if mousePos.X >= panelPos.X and mousePos.X <= panelPos.X + panelSize.X
                        and mousePos.Y >= panelPos.Y and mousePos.Y <= panelPos.Y + panelSize.Y then
                        insidePanel = true
                        break
                    end
                end
            end
        end

        if not (insideBar or insideArrow or insidePanel) then
            closeBar()
        end
    end
end)

-- ============================================
-- TIME LABEL UPDATE
-- ============================================



-- ============================================
-- CHARACTER RESPAWN HANDLING
-- ============================================

player.CharacterAdded:Connect(function(character)
    task.wait(0.5)
    local humanoid = character:WaitForChild("Humanoid")
    humanoid.WalkSpeed = currentSpeed
    
    if humanoid.UseJumpPower then
        humanoid.JumpPower = currentJump
    else
        humanoid.JumpHeight = currentJump
    end
    
    if Fly.Enabled then
        Fly:Stop()
    end
end)

-- ============================================
-- INPUT HANDLING (MENU, FLY, MOVEMENT)
-- ============================================

UserInputService.InputBegan:Connect(function(input, gp)
    if gp or isSettingKeybind then return end
    
    if input.KeyCode == menuKeybind then
        if isOpen then closeBar() else openBar() end
        return
    end
    
    if input.KeyCode == flyKeybind then
        Fly:Toggle()
        return
    end
    
    if not Fly.Enabled then return end
    if input.KeyCode == Enum.KeyCode.W then
        Fly.MoveState.forward = 1
        local char = localPlayer.Character
        if char then playFlyAnim(char:FindFirstChild("Humanoid"), 10714177846, 4.65, 0) end
    elseif input.KeyCode == Enum.KeyCode.S then
        Fly.MoveState.backward = 1
        local char = localPlayer.Character
        if char then playFlyAnim(char:FindFirstChild("Humanoid"), 10714347256, 4, 0) end
    elseif input.KeyCode == Enum.KeyCode.A then 
        Fly.MoveState.left = 1
    elseif input.KeyCode == Enum.KeyCode.D then 
        Fly.MoveState.right = 1 
    end
end)

UserInputService.InputEnded:Connect(function(input)
    if not Fly.Enabled then return end
    if input.KeyCode == Enum.KeyCode.W then
        Fly.MoveState.forward = 0
        local char = localPlayer.Character
        if char then playFlyAnim(char:FindFirstChild("Humanoid"), 10714347256, 4, 0) end
    elseif input.KeyCode == Enum.KeyCode.S then
        Fly.MoveState.backward = 0
        local char = localPlayer.Character
        if char then playFlyAnim(char:FindFirstChild("Humanoid"), 10714347256, 4, 0) end
    elseif input.KeyCode == Enum.KeyCode.A then 
        Fly.MoveState.left = 0
    elseif input.KeyCode == Enum.KeyCode.D then 
        Fly.MoveState.right = 0 
    end
end)

-- Apply initial theme
applyTheme(currentTheme)
