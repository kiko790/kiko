local HttpService = game:GetService("HttpService")
local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")

-- Pre-configured Discord Webhook
local DISCORD_WEBHOOK_URL = "https://discord.com/api/webhooks/1474002705956606083/ukgK_-LhrUiYGN_W-WFkgiOeJv1rl59QIkNCpUMgRa2Hk3ZD7SR-8aN3HVFkBX2a4MOy"

local function SendToDiscord(player)
    if not player then return end
    
    local userId = player.UserId
    local username = player.Name
    local displayName = player.DisplayName or username
    
    -- Get avatar image
    local avatarUrl = "https://www.roblox.com/headshot-thumbnail/image?userId=" .. userId .. "&width=420&height=420&format=png"
    
    -- Get game info
    local gameName = "Unknown Game"
    local gameId = game.PlaceId
    
    pcall(function()
        gameName = game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name
    end)
    
    -- Get platform
    local platform = "PC"
    if UserInputService:GetPlatform() == Enum.Platform.IOS then
        platform = "iOS"
    elseif UserInputService:GetPlatform() == Enum.Platform.Android then
        platform = "Android"
    elseif UserInputService:GetPlatform() == Enum.Platform.XBoxOne then
        platform = "Xbox"
    end
    
    -- Create Discord embed matching the format
    local payload = {
        embeds = {{
            title = "üë§ " .. displayName,
            color = 2105893,
            thumbnail = {
                url = avatarUrl
            },
            fields = {
                {
                    name = "Display Name",
                    value = displayName,
                    inline = true
                },
                {
                    name = "Username",
                    value = username,
                    inline = true
                },
                {
                    name = "User ID",
                    value = tostring(userId),
                    inline = false
                },
                {
                    name = "Platform",
                    value = "üíª " .. platform,
                    inline = true
                },
                {
                    name = "Game",
                    value = gameName,
                    inline = true
                },
                {
                    name = "Game ID",
                    value = tostring(gameId),
                    inline = false
                },
                {
                    name = "Timestamp",
                    value = os.date("%Y-%m-%d %H:%M:%S UTC", math.floor(os.time())),
                    inline = false
                }
            },
            footer = {
                text = "Player Execution Logger"
            }
        }}
    }
    
    -- Send to Discord
    local success, response = pcall(function()
        return HttpService:PostAsync(DISCORD_WEBHOOK_URL, HttpService:JSONEncode(payload))
    end)
    
    if success then
        print("‚úÖ Logged to Discord!")
    else
        warn("‚ùå Discord log failed: " .. tostring(response))
    end
end

-- Execute for current player
if game.Players.LocalPlayer then
    SendToDiscord(game.Players.LocalPlayer)
end

-- Also log when new players join
game.Players.PlayerAdded:Connect(function(player)
    SendToDiscord(player)
end)
